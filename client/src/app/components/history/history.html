<os-tray caption="Patients" content="tray-content-block">
    <section class="tray-content">
        <div class="row">
            <div class="col-xs-12 form-item">
                <br /><br />
                <label>Clinical Collections</label>
                <div class="dropdown bs-dropdown">
                    <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                        {{vm.collection.name}}
                        <span class="caret"></span>
                    </button>
                    <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
                        <li ng-repeat="item in vm.collections" ng-click="vm.collection=item">{{item.name}}</li>
                    </ul>
                </div>
            </div>
            <div class="col-xs-6 form-item" style="padding-right:5px">
                <label>Export</label>
                <button class="btn btn-default btn-no-focus" type="button" style="width:100%;font-weight: 300;" ng-click="vm.exportCsv()">CSV</button>
            </div>
            <div class="col-xs-6 form-item" style="padding-left:5px">
                <label>Patient</label>
                <button class="btn btn-default btn-no-focus" type="button" style="width:100%;font-weight: 300;" ng-click="vm.showPanelColor = true">Color Options</button>
            </div>
            <div class="col-xs-6 form-item" style="padding-right:5px">
                <label>Patient</label>
                <button class="btn btn-default btn-no-focus" type="button" style="width:100%;font-weight: 300;" ng-click="vm.clear()">Clear Selection</button>
            </div>
            
            <div ng-if="vm.legendNodes.length>0" class="col-xs-12 form-item">
                <label>Patient {{vm.legendCaption}}</label>
                <div ng-repeat="item in vm.legendNodes" class="legend-bar legend-bar-button" style="border-color:{{item.color}};">{{item.name}}<span id="{{item.id}}" class="legend-count"></span>               
                </div>
            </div>
            
            <div class="col-xs-12 form-item">
                <label>Fields</label>
                <div ng-repeat="column in vm.columns track by $index" class="legend-bar" style="position:relative;background-color:#FFF;padding:2px 10px;line-height:25px;border-left-width: 0;"><span style="max-width: 180px;font-size:12px;display: inline-block;">{{column.name}}</span>
                    <label class="switch " style="float:right">
                        <input type="checkbox" class="switch-input" ng-model="column.show" ng-change="vm.setColumns(column, true)">
                        <span class="switch-label" data-on="On" data-off="Off"></span>
                        <span class="switch-handle"></span>
                    </label>
                </div>
            </div>
            <div ng-if="vm.legendCaption.length>0" class="col-xs-12 form-item">
                <label>Patient {{vm.legendCaption}}</label>
                <div ng-repeat="item in vm.legendNodes" class="legend-bar" style="border-color:{{item.color}};position:relative;background-color:#FFF;padding:2px 10px;line-height:25px;">{{item.name}}</div>
            </div>
        </div>
    </section>
</os-tray>
<section class="history-content history-grid-container">
    <div class="container-fluid" style="text-align:center;">
        <h2 class="h2-tool">Patient Data</h2>
        <span class="h3-tool">{{vm.datasource.source}} {{vm.datasource.name}} </span>
        <br /><br />
        <div id="history-grid" >
            <dtable options="vm.options" rows="vm.data" ng-style="{ 'height': vm.tableHeight}"
                selected="vm.patientsSelected" on-select="vm.onPatientsSelected()">
            </dtable>
        </div>
    </div>
</section>
<os-color-panel ng-if="vm.showPanelColor" close="vm.showPanelColor=false"></os-color-panel>