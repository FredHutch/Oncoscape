!function(){"use strict";angular.module("oncoscape",["ngAnimate","ngCookies","ngTouch","ngSanitize","ngMessages","ngAria","ngResource","ui.router","ui.bootstrap","ui-rangeSlider","ui.bootstrap.contextMenu","nvd3","toastr"])}(),function(){"use strict";function e(){function e(e,t){var a=this;a.trayClass=Math.random().toString(36).substring(3),a.iconClass=Math.random().toString(36).substring(3);var n=!0;a.toggle=function(){var i=angular.element("."+a.trayClass),r=angular.element("."+a.iconClass);n=!n,r.addClass(n?"fa-lock":"fa-unlock-alt").removeClass(n?"fa-unlock-alt":"fa-lock"),i.attr("locked",n?"true":"false"),n?(i.unbind("mouseover",o).unbind("mouseout",s).removeClass("tray-collapsed"),t(function(){a.change()})):(i.addClass("tray-collapsed").bind("mouseover",o).bind("mouseout",s),t(function(){a.change()})),e.onResize.dispatch()};var o=function(){angular.element("."+a.trayClass).removeClass("tray-collapsed")},s=function(){angular.element("."+a.trayClass).addClass("tray-collapsed")}}e.$inject=["osApi","$timeout"];var t={restrict:"E",templateUrl:"app/components/tray/tray.html",scope:{caption:"@",content:"@",change:"&"},controller:e,controllerAs:"vm",bindToController:!0,replace:!0,transclude:!0};return t}angular.module("oncoscape").directive("osTray",e)}(),function(){"use strict";function e(){function e(e,t){var a=this;e.query("lookup_oncoscape_tools",{beta:!1}).then(function(e){a.tools=e.data}),a.explore=function(a){t.go(a,{datasource:e.getDataSource().disease})}}e.$inject=["osApi","$state"];var t={restrict:"E",templateUrl:"app/components/tools/tools.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osTools",e)}(),function(){"use strict";function e(){function e(e,t,a,n,o,s,i,r,l){function c(){S=C.selectAll(".timeline-selected")[0].map(function(e){return e.__data__.id}),0==S.length&&(S=C.selectAll()[0].map(function(e){return e.__data__.id})),t.addPatientSelection("Timelines","Manual Selection",S),"Filter"==v.optCohortMode.name&&$()}if(angular.isUndefined(o.datasource))return void a.go("datasource");var d,u,p,m,h,g=0,v=this;v.selShow=!1,v.selPatient,v.selEvent,v.selFields=[],v.datasource=o.datasource,v.optCohortModes,v.optCohortMode,v.timescaleunit,v.timescales,v.timescale,v.features,v.feature,v.filters,v.filter,v.events,v.sorts,v.sort,v.align,v.optCohortModes=[{name:"Highlight"},{name:"Filter"}],v.optCohortMode=v.optCohortModes[0];var f,b,y=angular.element("#timelines-chart"),w=l.select("#timelines-chart").append("svg").attr("id","chart").style({width:"100%"}),x=w.append("g").attr({"class":"axis"}).style({"shape-rendering":"crispEdges","stroke-width":"1.0",stroke:"#000",fill:"none"}),A=w.append("svg").attr({"class":"bars-svg"}),k=A.append("rect").attr({width:y.width(),height:s.innerHeight-75-10-130-50}).style({fill:"#FFFFFF"}),C=A.append("g").attr({"class":"bars"}),S=null==t.getPatientSelection()?null:t.getPatientSelection().ids,M=function(){if(!l.event.shiftKey){var e=g*l.event.scale;g>e&&(e=g);var t=l.event.translate[1],a=s.innerHeight-75-10-130-50,n=20*d.patients.length*e,o=a-n;t>0&&(t=0),o>t&&(t=o),f.translate([l.event.translate[0],t]);var i=20*e,r=a/i,c=Math.abs(t/i);b.y(l.scale.linear().range([0,a]).domain([c,c+r])),C.attr("transform","translate(1,"+t+")scale(1,"+e+")")}},T=!1,E=function(){l.event.sourceEvent.shiftKey?T=!0:(l.event.target.clear(),l.select(this).call(l.event.target))},P=function(){if(T){var e=b.extent(),t=Math.floor(e[0][1]),a=Math.floor(e[1][1]);C.selectAll("g.timeline").each(function(e,n){l.select(this.firstChild).classed("timeline-selected",n>=t&&a>=n)})}},D=function(){T&&(T=!1,l.event.target.clear(),l.select(this).call(l.event.target),c())},$=function(){var e=20,t=s.innerHeight-75-10-130,a=s.innerWidth-300;a>760&&(a-=140),"false"==angular.element(".tray-right").attr("locked")&&(a+=300),d=F(u,v.align,v.sort),m=l.scale.linear().domain(d.bounds).range([10,a-10]).nice(),h=l.scale.linear().domain([0,d.patients.length]).range(0,t-50).nice(),g=(t-50)/(20*d.patients.length),w.attr({height:t+"px"}),A.attr({height:t-50+"px",width:a+"px"}),k.attr({height:t-50+"px",width:a+"px"}),C.attr("transform","scale(1,"+g+")");var o=C.selectAll("g.timeline").data(d.patients);o.exit().remove(),o.enter().append("g").attr({"class":"timeline"}).on("mousedown",function(){l.event.shiftKey||C.selectAll(".timeline-selected").classed("timeline-selected",!1)}).attr({width:a,height:e,transform:function(t,a){return"translate(0,"+a*e+")"}}).append("rect").attr({"class":"timeline-row",width:0,height:e}),"Highlight"==v.optCohortMode.name&&S.length>0?o.each(function(e){var t=S.indexOf(e.id)>=0,a=l.select(this.firstChild);a.classed("timeline-selected",t)}):o.each(function(){var e=l.select(this.firstChild);e.classed("timeline-selected",!1)});var i=o.selectAll("rect.event").data(function(e){return e.filteredEvents});i.exit().remove(),i.enter().append("rect").attr({"class":"event"}).on("mouseover",function(){var e=p[this.__data__.id];v.selPatient=e.PatientID,v.selEvent=e.Name;var t=[];for(var a in e.Fields)null!=e.Fields[a]&&("date"==a&&angular.isArray(e.Fields[a])?(t.push({name:"Start Date",value:e.Fields[a][0]}),t.push({name:"End Start",value:e.Fields[a][1]})):t.push({name:a,value:e.Fields[a]}));v.selShow=!0,v.selFields=t,n.$apply()}).on("mouseout",function(){v.selShow=!1,n.$apply()}),i.transition().style({fill:function(e){return e.color}}).attr({height:function(t){return"Radiation"==t.name||"Drug"==t.name?e/2:e},width:function(e){return null==e.endValue?3:m(e.endValue)-m(e.startValue)},x:function(e){return Math.round(m(e.startValue))},y:function(t){return"Radiation"==t.name?e/2:0}});var r=function(e){return 0==Math.abs(e)?e:Math.abs(e)<30?e+" Days":Math.abs(e)<360?Math.round(e/30.4*10)/10+" Months":Math.round(e/365*10)/10+" Years"},c=l.svg.axis().scale(m).orient("bottom").ticks(8);c="Log"==v.timescale.name?c.tickFormat(function(e){return r(Math.round((0>e?-1:1)*(Math.pow(2,Math.abs(e))-1)*100)/100)}):c.tickFormat(function(e){return r(e)}),b=l.svg.brush().x(m).y(l.scale.linear().range([0,t]).domain([0,d.patients.length])).on("brush",P).on("brushstart",E).on("brushend",D),k.call(b),k.on("mousedown",function(){l.event.shiftKey||C.selectAll(".timeline-selected").classed("timeline-selected",!1)}),f=l.behavior.zoom().x(m).y(h).translate([0,0]).scale(1,g).on("zoom",M),k.call(f),x.attr({"class":"timeline-axis",width:100,transform:function(){return"translate(0,"+(t-50)+")"}}),x.call(c)},F=function(e,t,a){var n={};return n.events=v.events.filter(function(e){return e.selected}),n.patients=e.filter(function(e){return"Only Alive"==v.filter.name&&e.dead?!1:("Only Dead"!=v.filter.name||e.dead)&&e.hasOwnProperty("__"+this.align)?this.filter&&this.ids&&-1==this.ids.indexOf(e.id)?!1:!0:!1},{align:t.name,filter:"Filter"==v.optCohortMode.name,ids:S}),"Survival"==a.name?n.patients=n.patients.sort(function(e,t){return e.dead==t.dead?e.calcEvents[a.index].value>t.calcEvents[a.index].value?1:-1:e.dead?1:-1},a):n.patients=n.patients.sort(function(e,t){return e.calcEvents[a.index].value>t.calcEvents[a.index].value?1:-1},a),n.patients.forEach(function(e){e.filteredEvents=e.dateEvents.filter(function(e){for(var t=0;t<this.length;t++)if(this[t].name==e.name)return!0;return!1},n.events),e.filteredEvents.forEach(function(e){e.startValue=v.timescale.timeFn(e.start+this),e.endValue=null!=e.end?v.timescale.timeFn(e.end+this):null},-e["__"+this.align.name].start)},{align:t,events:n.events}),n.bounds=n.patients.reduce(function(e,t){var a=t.filteredEvents.reduce(function(e,t){return[Math.min(t.startValue,e[0]),Math.max(null==t.endValue?t.startValue:t.endValue,e[1])]},[1/0,-(1/0)]);return[Math.min(a[0],e[0]),Math.max(a[1],e[1])]},[1/0,-(1/0)]),n};!function(){var a=function(e){var t=e.name,a="Birth"===t?"#17becf":"Diagnosis"===t?"#8c564b":"Pathology"===t?"#7f7f7f":"Progression"===t?"#1f77b4":"Absent"===t?"#000000":"Status"===t?"#bcbd22":"Radiation"===t?"#e7969c":"Procedure"===t?"#ff7f0e":"Encounter"===t?"#d62728":"Drug"===t?"#9467bd":"black";return a},o=function(e){return Object.keys(e).map(function(e){var t={name:e,selected:!0};return t.color=t.__color=a(t),t})},i=function(e){return e[0].calcEvents.map(function(e,t){return{name:e.name,index:t}})},l=function(e,t){e=Object.keys(e).map(function(t){var a=e[t];return a.id=t,a});for(var n=0;n<e.length;n++){var o=e[n],s=r,i="YYYY-MM-DD",l=o.dateEvents.filter(function(e){return"single"===e.eventOrder}).map(function(e){return{start:s(e.date,i).unix(),end:null,name:e.name,id:e.eventID}}),c=o.dateEvents.filter(function(e){return"end"===e.eventOrder}).map(function(e){return{end:s(e.date,i).unix(),id:e.eventID}}),d=o.dateEvents.filter(function(e){return"start"===e.eventOrder}).map(function(e){return{start:s(e.date,i).unix(),name:e.name,id:e.eventID}});d.forEach(function(e){e.end=c.filter(function(t){return t.id==e.id})[0].end}),o.dateEvents=d.length>0?d.concat(l):l,o.dateEvents.forEach(function(e){e.color=a(e),o["__"+e.name]=e,"Status"==e.name&&(o.dead=-1!=t.indexOf(e.id))})}return e};e.setBusy(!0)("Loading Dataset"),e.setDataset(v.datasource).then(function(){e.getTimelines().then(function(a){v.timescales=[{name:"Log",timeFn:function(e){return(0>e?-1:1)*Math.log(Math.abs(1e3*e/864e5)+1)/Math.log(2)}},{name:"Linear",timeFn:function(e){return r.duration(1e3*e).asDays()}}],v.timescale=v.timescales[0],u=l(a.payload.pts,a.payload.eventTypes.Status.status.Dead),p=a.payload.events,v.sorts=i(u),v.filters=[{name:"Alive + Dead"},{name:"Only Alive"},{name:"Only Dead"}],v.filter=v.filters[0];var c=i(u);c.unshift({index:-1,name:"None"}),v.features=c,v.feature=v.features[0],v.events=o(a.payload.eventTypes),v.sort=v.sorts[1],v.events.forEach(function(e){"Birth"==e.name&&(e.selected=!1,e.color="#FEFEFE"),"Diagnosis"==e.name&&(this.align=e)},v),n.$watchGroup(["vm.feature","vm.sort","vm.align","vm.timescale","vm.filter"],$),angular.element(s).bind("resize",$),n.$watch("vm.optCohortMode",$),t.onPatientSelectionChange.add(function(e){S=e.ids,$()}),e.setBusy(!1)})})}(),v.resize=function(){$()},v.updateEventColor=function(e){e.selected=!e.selected,e.color=e.selected?e.__color:"#FEFEFE",$()}}e.$inject=["osApi","osHistory","$state","$scope","$stateParams","$window","$document","moment","d3"];var t={restrict:"E",templateUrl:"app/components/timelines/timelines.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osTimelines",e)}(),function(){"use strict";function e(){function e(e,t,a,n,o,s,i,r){t.setBusy(!0);var l=this;l.datasource=t.getDataSource(),l.cohorts=a.getPatientCohorts(),l.all={show:!0,color:"#000"};for(var c=["#004358","#800080","#BEDB39","#FD7400","#1F8A70"],d=0;d<l.cohorts.length;d++)l.cohorts[d].show=!0,l.cohorts[d].color=c[d];l.toggle=function(){a.getSurvivalData(l.cohorts.filter(function(e){return e.show}),l.all.show)};var u=e.select("#survival-chart").append("svg"),p=u.append("g").attr("class","axis"),m=u.append("g").attr("class","axis"),h={},g={width:0,height:0,xScale:null,yScale:null,xAxis:e.svg.axis().orient("bottom").ticks(5),yAxis:e.svg.axis().orient("left").ticks(5)},v=function(a){var n=t.getLayout();g.width=r.innerWidth-n.left-n.right-60,g.height=r.innerHeight-160,angular.element("#survival-chart").css("margin-left",n.left+20),u.attr("width","100%").attr("height",g.height),g.xScale=e.scale.linear().domain(a).range([50,g.width]),g.yScale=e.scale.linear().domain([0,100]).range([g.height-50,0]),g.xAxis.scale(g.xScale),g.yAxis.scale(g.yScale),m.attr("transform","translate(50, 10)").call(g.yAxis),p.attr("transform","translate(0, "+(g.yScale(0)+10)+")").call(g.xAxis)},f=function(e){"getSurvivalData"==e.data.cmd&&(h=e.data.data,y())};a.onMessage.add(f);var b=function(t){var a=e.svg.line().x(function(e){return g.xScale(e[0])}).y(function(e){return g.yScale(e[2])+10});u.append("path").attr("class","line").attr("stroke-width",1.5).attr("stroke",t.color).attr("fill","none").attr("d",a(t.data.line)).on("mouseover",function(){e.select(this).attr("stroke-width",3)}).on("mouseout",function(){e.select(this).attr("stroke-width",1)});for(var n=0;n<t.data.tick.length;n++)u.append("line").attr("class","line").attr("stroke-width",.5).attr("stroke",t.color).attr("x1",g.xScale(t.data.tick[n][0])).attr("x2",g.xScale(t.data.tick[n][0])).attr("y1",g.yScale(t.data.tick[n][2])+5).attr("y2",g.yScale(t.data.tick[n][2])+10)},y=function(){u.selectAll(".line").remove(),v([h.min,h.max]);for(var e=0;e<h.cohorts.length;e++)b(h.cohorts[e]);t.setBusy(!1)};t.onResize.add(y),s.$on("$destroy",function(){a.onMessage.remove(f)}),l.toggle()}e.$inject=["d3","osApi","osCohortService","$state","$timeout","$scope","$stateParams","$window"];var t={restrict:"E",templateUrl:"app/components/survival/survival.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osSurvival",e)}(),function(){"use strict";function e(){function e(e,t,a,n,o,s,i,r,l,c,d){function u(){var e=w.selectAll(".plsr-node-selected")[0];0!=e.length&&t.addGeneSelection("PLSR","Manual Selection",w.selectAll(".plsr-node-selected")[0].map(function(e){return e.__data__.name.toUpperCase()}))}function p(){0==k.length?w.selectAll(".plsr-node-selected").classed("plsr-node-selected",!1):w.selectAll("circle").classed("plsr-node-selected",function(){return k.indexOf(this.__data__.name)>=0})}if(angular.isUndefined(n.datasource))return void a.go("datasource");var m,h,g,v,f,b,y,w=i.select("#plsr-chart").append("svg").attr("id","chart"),x=i.select("body").append("div").attr("class","tooltip plsr-tooltip"),A=this;A.datasource=n.datasource,A.deathMinFilter=A.deathMinValue=45,A.deathMaxFilter=A.deathMaxValue=66,A.survivalMinFilter=A.survivalMinValue=3,A.survivalMaxFilter=A.survivalMaxValue=7,A.geneSets=[],A.geneSet=null,A.frame,A.tip=null;var k=null==t.getGeneSelection()?[]:t.getGeneSelection().ids;e.setBusy(!0)("Loading Dataset"),e.setDataset(A.datasource).then(function(a){var n=a.payload.rownames.filter(function(e){return e.indexOf("mtx.mrna")>=0});n=n[n.length-1].replace(".RData",""),e.getPLSR(A.datasource,n).then(function(){e.getGeneSetNames().then(function(a){A.geneSets=a.payload,A.geneSet=A.geneSets[0],e.getSummarizedPLSRPatientAttributes().then(function(e){var a=e.payload;A.deathMinValue=Math.floor(a.AgeDx[0]/365.24),A.deathMaxValue=Math.floor(a.AgeDx[4]/365.24),A.survivalMinValue=Math.floor(a.Survival[0]/365.24),A.survivalMaxValue=Math.floor(a.Survival[4]/365.24),s.$watch("vm.geneSet",function(){A.update()}),t.onGeneSelectionChange.add(function(e){k=e.ids,p()})})})})}),A.update=function(){function t(){m=c.innerWidth-400,"false"==angular.element(".tray-right").attr("locked")&&(m+=300),h=c.innerHeight-190,"true"==angular.element(".tray").attr("locked")&&(m-=300),w.attr("width","100%").attr("height",h),g=i.scale.linear().domain([-f,f]).range([0,m]).nice(),v=i.scale.linear().domain([-b,b]).range([h,0]).nice()}function a(e,a,n){f=.9*e,b=.9*e,t(),y=i.svg.brush().x(g).y(v).on("brushend",function(){var e=y.extent();w.selectAll("circle").classed("plsr-node-selected",function(t){return t[0]>e[0][0]&&t[0]<e[1][0]&&t[1]>e[0][1]&&t[1]<e[1][1]}),i.select(this).transition().duration(300).call(y.extent([[0,0],[0,0]])),u()}),w.call(y);var o=w.selectAll("circle").data(n,function(e){return e});o.enter().append("circle").attr({"class":"plsr-node",cx:.5*m,cy:.5*h,r:3}).style("fill-opacity","0").on("mouseover",function(e){x.transition().duration(200).style("opacity",1),x.html(e.name).style("left",i.event.pageX+15+"px").style("top",i.event.pageY-15+"px")}).on("mouseout",function(){x.transition().duration(500).style("opacity",0)}).on("click",function(e){angular.element("#plsr-webpage").modal();var t="https://www.genecards.org/cgi-bin/carddisp.pl?gene="+e.name;s.$apply(function(){A.frame=l.trustAsResourceUrl(t)})}),o.transition().duration(750).delay(function(e,t){return t/300*500}).attr("cx",function(e){return g(e[0])}).attr("cy",function(e){return v(e[1])}).style("fill-opacity",1),o.exit().transition().duration(600).delay(function(e,t){return t/300*500}).attr("cx",.5*m).attr("cy",.5*h).style("fill-opacity","0").remove();var r=w.selectAll("line").data(a);r.enter().append("line").attr({"class":"line","stroke-width":3,x1:g(0),y1:v(0),x2:g(0),y2:v(0)}).style("stroke",function(e){return e.name.indexOf("Age")?"#1396de":"#38347b"}),r.transition().duration(900).attr({x1:g(0),y1:v(0),x2:function(e){return g(e[0])},y2:function(e){return v(e[1])}}),r.exit().remove();var c=w.selectAll("text").data(a);c.enter().append("text").attr({"class":"text",x:.5*m,y:.5*h,"text-anchor":function(e){return e[0]>0?"start":"end"}}).text(function(e){return e.name}).style({fill:"black","text-anchor":"middle"}),c.transition().duration(900).attr({x:function(e){return g(e[0])},y:function(e){return v(e[1])}}),c.exit().remove(),p()}var n=[{name:"Survival",low:365.24*Number(A.survivalMinFilter),high:365.24*Number(A.survivalMaxFilter)},{name:"AgeDx",low:365.24*Number(A.deathMinFilter),high:365.24*Number(A.deathMaxFilter)}];e.getCalculatedPLSR(A.geneSet,n).then(function(t){var n=t.payload,o=n.loadings.map(function(e,t){return e.name=this[t],e},n.loadingNames),s=n.vectors.map(function(e,t){return e.name=this[t],e},n.vectorNames),i=1.2*n.maxValue;a(i,s,o),e.setBusy(!1)}),A.resize=function(){t(),w.selectAll("circle").attr({cx:function(e){return g(e[0])},cy:function(e){return v(e[1])}}),w.selectAll("text").attr({x:function(e){return g(e[0])},y:function(e){return v(e[1])}}),w.selectAll("line").attr({x1:g(0),y1:v(0),x2:function(e){return g(e[0])},y2:function(e){return v(e[1])}})},angular.element(c).bind("resize",d.debounce(A.resize,300))}}e.$inject=["osApi","osHistory","$state","$stateParams","$timeout","$scope","d3","moment","$sce","$window","_"];var t={restrict:"E",templateUrl:"app/components/plsr/plsr.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osPlsr",e)}(),function(){"use strict";function e(){function e(e,t,a,n,o,s,i,r,l,c,d){function u(){var e=w.selectAll(".pca-node-selected")[0],t=0==e.length?[]:e.map(function(e){return e.__data__[2].toUpperCase()});f=!1,a.setPatientCohort(t,"PCA")}function p(){0==v.length?w.selectAll(".pca-node-selected").classed("pca-node-selected",!1):w.selectAll("circle").classed("pca-node-selected",function(){return v.indexOf(this.__data__[2])>=0})}function m(){var e=t.getLayout();k.width=c.innerWidth-e.left-e.right-60,k.height=c.innerHeight-200,angular.element("#pca-chart").css("margin-left",e.left+30),w.attr("width","100%").attr("height",k.height),k.xScale=r.scale.linear().domain([-k.xMax,k.xMax]).range([0,k.width]).nice(),k.yScale=r.scale.linear().domain([-k.yMax,k.yMax]).range([k.height-20,20]).nice()}function h(){var e=Object.keys(y).map(function(e){return y[e]},{data:y});k.max=Math.abs(r.max(e,function(e){return+e[0]})),k.min=Math.abs(r.min(e,function(e){return+e[0]})),k.xMax=1.2*(k.max>k.min?k.max:k.min),k.max=Math.abs(r.max(e,function(e){return+e[1]})),k.min=Math.abs(r.min(e,function(e){return+e[1]})),k.yMax=1.2*(k.max>k.min?k.max:k.min),m(),k.xAxis=r.svg.axis().scale(k.xScale).orient("top").ticks(5),k.yAxis=r.svg.axis().scale(k.yScale).orient("left").ticks(5),b=r.svg.brush().x(k.xScale).y(k.yScale).on("brushend",function(){var e=b.extent();w.selectAll("circle").classed("pca-node-selected",function(t){return t[0]>e[0][0]&&t[0]<e[1][0]&&t[1]>e[0][1]&&t[1]<e[1][1]}),r.select(this).transition().duration(200).call(b.extent([[0,0],[0,0]])),u()}),w.call(b);var t=w.selectAll("circle").data(y,function(e){return e});t.enter().append("circle").attr({"class":"pca-node",cx:.5*k.width,cy:.5*k.height,r:3}).transition().duration(750).delay(function(e,t){return t/300*100}).attr("cx",function(e){return k.xScale(e[0])}).attr("cy",function(e){return k.yScale(e[1])}).style("fill-opacity",.3),t.exit().transition().duration(200).delay(function(e,t){return t/300*100}).attr("cx",.5*k.width).attr("cy",.5*k.height).style("fill-opacity","0").remove(),A.attr("class","axis").attr("transform","translate(0, "+k.yScale(0)+")").call(k.xAxis).append("text").text("PC1"),x.attr("class","axis").attr("transform","translate("+k.xScale(0)+", 0)").call(k.yAxis).append("text").attr("y",10).attr("dy",".71em").text("PC2"),p()}var g=a.getPatientCohort();null==g&&a.setPatientCohort([],"All Patients");var v=null==g?[]:g.ids,f=!0;a.onPatientsSelect.add(function(e){f?(v=e.ids,p()):f=!0});var b,y,w=r.select("#pca-chart").append("svg").attr("id","chart"),x=w.append("g"),A=w.append("g"),k={width:0,height:0,xScale:0,yScale:0,xMax:0,yMax:0,xAxis:0,yAxis:0},C=function(e,t){return e.datasource=t.getDataSource(),e.geneSets=[],e.geneSet=null,e.search="",t.query("render_pca",{disease:e.datasource.disease,$fields:["geneset"]}).then(function(t){e.geneSets=t.data,e.geneSet=e.geneSets[0]}),e}(this,t);i.$watch("vm.geneSet",function(e){null!=e&&t.query("render_pca",{disease:C.datasource.disease,geneset:e.geneset}).then(function(e){C.pc1=e.data[0].pc1,C.pc2=e.data[0].pc2;var t=Object.keys(e.data[0].data);y=t.map(function(e){return this.data[e].push(e),this.data[e]},{data:e.data[0].data}),h()})}),C.resize=function(){m(),k.xAxis.scale(k.xScale),k.yAxis.scale(k.yScale),b.x(k.xScale),b.y(k.yScale),A.attr("transform","translate(0, "+k.yScale(0)+")").call(k.xAxis),x.attr("transform","translate("+k.xScale(0)+", 0)").call(k.yAxis),w.selectAll("circle").attr("cx",function(e){return k.xScale(e[0])}).attr("cy",function(e){return k.yScale(e[1])})},t.onResize.add(C.resize),angular.element(c).bind("resize",d.debounce(C.resize,300))}e.$inject=["$q","osApi","osCohortService","$state","$stateParams","$timeout","$scope","d3","moment","$window","_"];var t={restrict:"E",templateUrl:"app/components/pca/pca.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osPca",e)}(),function(){"use strict";function e(){function e(e,t,a,n,o,s,i,r,l,c){function d(){var e="rgb(5, 108, 225)",t="red",a="rgb(56, 52,123)",n="green";return[{selector:"node",style:{content:"data(label)","text-valign":"center","text-halign":"center",shape:"ellipse",width:"60px",height:"50px",color:e,"background-color":"rgb(250, 250, 250)","border-width":"2px","border-color":e}},{selector:"edge",style:{width:"2px","line-color":e,"line-style":"solid"}},{selector:'node[nodeType="class"], node[nodeType="family"], node[nodeType="complex"]',style:{content:"","background-color":"white",shape:"roundrectangle"}},{selector:'edge[edgeType="activates"], edge[edgeType="indirectly activates"]',style:{"line-color":n,"target-arrow-shape":"triangle","target-arrow-color":n}},{selector:'edge[edgeType="inhibits"], edge[edgeType="ubiquitinylates"]',style:{"line-color":t,"target-arrow-shape":"tee","target-arrow-color":t}},{selector:'edge[edgeType="fusion"]',style:{"line-color":n}},{selector:'edge[edgeType="contains"]',style:{display:"none"}},{selector:'node[nodeType="process"]',style:{}},{selector:'node[nodeType="gene"]:selected',style:{"overlay-opacity":"0.5","overlay-color":"red"}},{selector:'node[nodeType="rtk"]',style:{content:"data(label)","background-color":"rgb(224, 209, 178)","border-color":"black","border-width":"0px","font-size":"48px",shape:"roundrectangle",width:"40px",height:"160px"}},{selector:'node[nodeType="kinase"]',style:{content:"data(label)","background-color":"rgb(255, 206, 194)",shape:"ellipse",width:"160px",height:"120px","font-size":"48px","border-color":"black","border-width":"1px"}},{selector:'node[nodeType="dimer"]',style:{content:"","background-color":"rgb(234, 219, 188)",shape:"ellipse",width:"160px",height:"120px","font-size":"48px","border-color":"black","border-width":"0px"}},{selector:'node[nodeType="loop"]',style:{content:"","background-color":"rgb(255, 255, 255)",shape:"ellipse",width:"160px",height:"120px","font-size":"48px","border-color":"black","border-width":"1px","border-style":"dotted"}},{selector:'node[nodeType="gtpase"]',style:{content:"data(label)","background-color":"rgb(194, 194, 255)",shape:"ellipse",width:"160px",height:"120px","font-size":"48px","border-color":"black","border-width":"1px"}},{selector:'node[nodeType="adaptor"]',style:{content:"data(label)","background-color":"rgb(77, 184, 255)",shape:"ellipse",width:"60px",height:"120px","font-size":"48px","border-color":"black","border-width":"1px"}},{selector:'node[nodeType="GEF"]',style:{content:"data(label)","background-color":"rgb(77, 184, 255)",shape:"ellipse",width:"60px",height:"60px","font-size":"48px","border-color":"black","border-width":"1px"}},{selector:'node[nodeType="process"]',style:{content:"data(label)","background-color":"rgb(255, 255, 255)",shape:"roundrectangle",width:"100px",height:"40px","font-size":"24px","border-color":"black","border-width":"0px"}},{selector:'node[nodeType="TF"]',style:{content:"data(label)","background-color":"rgb(255, 206, 94)",shape:"diamond",width:"160px",height:"60px","font-size":"48px","border-color":"black","border-width":"1px"}},{selector:'node[nodeType="gene fusion"]',style:{content:"data(label)",shape:"roundrectangle","font-size":"24px","border-color":"red","border-width":"3px"}},{selector:"edge:selected",style:{"overlay-color":"grey","overlay-opacity":"0.3"}},{selector:'edge[edgeType="recruits"]',style:{width:"2px"}},{selector:'edge[edgeType="fusion"]',style:{"line-color":a}},{selector:'edge[edgeType="recruits"]',style:{"line-color":"red",width:"1px","line-style":"dashed","target-arrow-shape":"triangle","target-arrow-color":"black"}},{selector:'edge[edgeType="cycles"]',style:{"line-color":"black",width:"1px","line-style":"dashed","target-arrow-shape":"triangle","source-arrow-shape":"triangle","target-arrow-color":"green","source-arrow-color":"red"}},{selector:'edge[edgeType="associates"]',style:{"line-color":"black",width:"1px","line-style":"solid"}},{selector:'edge[edgeType="activation"]',style:{"line-color":"green",width:"1px"}},{selector:'edge[edgeType="inhibition"]',style:{"line-color":"red",width:"1px"}}]}var u,p,m=this,h=angular.element("#pathways-chart");m.datasource=e.getDataSource(),m.search="",m.frame,m.tip=null,m.linkTitle="",m.links=[],m.resize=function(){h.width("100%"),h.height(i.innerHeight-90),p&&(p.resize(),p.center())},o.$watch("vm.search",function(){if(!angular.isUndefined(p)){var e=m.search.toUpperCase(),t=e.length;p.startBatch(),p.nodes().map(function(a){0==t?a.unselect():a.attr("name").substr(0,t)===e?a.select():a.unselect()}),p.endBatch()}}),e.setBusy(!0),e.query("render_pathways").then(function(t){u=t.data[0],p=l({container:h,elements:u.elements,style:d(),minZoom:.1,maxZoom:5,zoom:.2,layout:{name:"preset",fit:!0}}).on("click","node",function(e){"gene"==e.cyTarget.data().nodeType&&(angular.element("#gbm-webpage").modal(),o.$apply(function(){m.frame=s.trustAsResourceUrl("https://www.genecards.org/cgi-bin/carddisp.pl?gene="+e.cyTarget.data().id)}))}).on("click","edge",function(e){angular.element("#gbm-webpage").modal(),o.$apply(function(){m.frame=s.trustAsResourceUrl("https://www.ncbi.nlm.nih.gov/pubmed/?term="+e.cyTarget.data().pmid)})}).on("mouseover","edge",function(e){o.$apply(function(){m.tip=e.cyTarget.data().source+" Extract"}),e.cyTarget.style({width:"4px"})}).on("mouseout","edge",function(e){o.$apply(function(){m.tip=null}),e.cyTarget.style({width:"2px"})}).on("mouseover","node",function(e){o.$apply(function(){m.tip=e.cyTarget.data().name+" Gene Card"})}).on("mouseout","node",function(){o.$apply(function(){m.tip=null})}),m.resize(),e.setBusy(!1)}),e.onResize.add(m.resize),angular.element(i).bind("resize",c.debounce(m.resize,300))}e.$inject=["osApi","osCohortService","$state","$stateParams","$scope","$sce","$window","moment","cytoscape","_"];var t={restrict:"E",templateUrl:"app/components/pathways/pathways.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osPathways",e)}(),function(){"use strict";function e(){function e(){t.play()}var t=new Audio("data:audio/wav;base64,//uQRAAAAWMSLwUIYAAsYkXgoQwAEaYLWfkWgAI0wWs/ItAAAGDgYtAgAyN+QWaAAihwMWm4G8QQRDiMcCBcH3Cc+CDv/7xA4Tvh9Rz/y8QADBwMWgQAZG/ILNAARQ4GLTcDeIIIhxGOBAuD7hOfBB3/94gcJ3w+o5/5eIAIAAAVwWgQAVQ2ORaIQwEMAJiDg95G4nQL7mQVWI6GwRcfsZAcsKkJvxgxEjzFUgfHoSQ9Qq7KNwqHwuB13MA4a1q/DmBrHgPcmjiGoh//EwC5nGPEmS4RcfkVKOhJf+WOgoxJclFz3kgn//dBA+ya1GhurNn8zb//9NNutNuhz31f////9vt///z+IdAEAAAK4LQIAKobHItEIYCGAExBwe8jcToF9zIKrEdDYIuP2MgOWFSE34wYiR5iqQPj0JIeoVdlG4VD4XA67mAcNa1fhzA1jwHuTRxDUQ//iYBczjHiTJcIuPyKlHQkv/LHQUYkuSi57yQT//uggfZNajQ3Vmz+Zt//+mm3Wm3Q576v////+32///5/EOgAAADVghQAAAAA//uQZAUAB1WI0PZugAAAAAoQwAAAEk3nRd2qAAAAACiDgAAAAAAABCqEEQRLCgwpBGMlJkIz8jKhGvj4k6jzRnqasNKIeoh5gI7BJaC1A1AoNBjJgbyApVS4IDlZgDU5WUAxEKDNmmALHzZp0Fkz1FMTmGFl1FMEyodIavcCAUHDWrKAIA4aa2oCgILEBupZgHvAhEBcZ6joQBxS76AgccrFlczBvKLC0QI2cBoCFvfTDAo7eoOQInqDPBtvrDEZBNYN5xwNwxQRfw8ZQ5wQVLvO8OYU+mHvFLlDh05Mdg7BT6YrRPpCBznMB2r//xKJjyyOh+cImr2/4doscwD6neZjuZR4AgAABYAAAABy1xcdQtxYBYYZdifkUDgzzXaXn98Z0oi9ILU5mBjFANmRwlVJ3/6jYDAmxaiDG3/6xjQQCCKkRb/6kg/wW+kSJ5//rLobkLSiKmqP/0ikJuDaSaSf/6JiLYLEYnW/+kXg1WRVJL/9EmQ1YZIsv/6Qzwy5qk7/+tEU0nkls3/zIUMPKNX/6yZLf+kFgAfgGyLFAUwY//uQZAUABcd5UiNPVXAAAApAAAAAE0VZQKw9ISAAACgAAAAAVQIygIElVrFkBS+Jhi+EAuu+lKAkYUEIsmEAEoMeDmCETMvfSHTGkF5RWH7kz/ESHWPAq/kcCRhqBtMdokPdM7vil7RG98A2sc7zO6ZvTdM7pmOUAZTnJW+NXxqmd41dqJ6mLTXxrPpnV8avaIf5SvL7pndPvPpndJR9Kuu8fePvuiuhorgWjp7Mf/PRjxcFCPDkW31srioCExivv9lcwKEaHsf/7ow2Fl1T/9RkXgEhYElAoCLFtMArxwivDJJ+bR1HTKJdlEoTELCIqgEwVGSQ+hIm0NbK8WXcTEI0UPoa2NbG4y2K00JEWbZavJXkYaqo9CRHS55FcZTjKEk3NKoCYUnSQ0rWxrZbFKbKIhOKPZe1cJKzZSaQrIyULHDZmV5K4xySsDRKWOruanGtjLJXFEmwaIbDLX0hIPBUQPVFVkQkDoUNfSoDgQGKPekoxeGzA4DUvnn4bxzcZrtJyipKfPNy5w+9lnXwgqsiyHNeSVpemw4bWb9psYeq//uQZBoABQt4yMVxYAIAAAkQoAAAHvYpL5m6AAgAACXDAAAAD59jblTirQe9upFsmZbpMudy7Lz1X1DYsxOOSWpfPqNX2WqktK0DMvuGwlbNj44TleLPQ+Gsfb+GOWOKJoIrWb3cIMeeON6lz2umTqMXV8Mj30yWPpjoSa9ujK8SyeJP5y5mOW1D6hvLepeveEAEDo0mgCRClOEgANv3B9a6fikgUSu/DmAMATrGx7nng5p5iimPNZsfQLYB2sDLIkzRKZOHGAaUyDcpFBSLG9MCQALgAIgQs2YunOszLSAyQYPVC2YdGGeHD2dTdJk1pAHGAWDjnkcLKFymS3RQZTInzySoBwMG0QueC3gMsCEYxUqlrcxK6k1LQQcsmyYeQPdC2YfuGPASCBkcVMQQqpVJshui1tkXQJQV0OXGAZMXSOEEBRirXbVRQW7ugq7IM7rPWSZyDlM3IuNEkxzCOJ0ny2ThNkyRai1b6ev//3dzNGzNb//4uAvHT5sURcZCFcuKLhOFs8mLAAEAt4UWAAIABAAAAAB4qbHo0tIjVkUU//uQZAwABfSFz3ZqQAAAAAngwAAAE1HjMp2qAAAAACZDgAAAD5UkTE1UgZEUExqYynN1qZvqIOREEFmBcJQkwdxiFtw0qEOkGYfRDifBui9MQg4QAHAqWtAWHoCxu1Yf4VfWLPIM2mHDFsbQEVGwyqQoQcwnfHeIkNt9YnkiaS1oizycqJrx4KOQjahZxWbcZgztj2c49nKmkId44S71j0c8eV9yDK6uPRzx5X18eDvjvQ6yKo9ZSS6l//8elePK/Lf//IInrOF/FvDoADYAGBMGb7FtErm5MXMlmPAJQVgWta7Zx2go+8xJ0UiCb8LHHdftWyLJE0QIAIsI+UbXu67dZMjmgDGCGl1H+vpF4NSDckSIkk7Vd+sxEhBQMRU8j/12UIRhzSaUdQ+rQU5kGeFxm+hb1oh6pWWmv3uvmReDl0UnvtapVaIzo1jZbf/pD6ElLqSX+rUmOQNpJFa/r+sa4e/pBlAABoAAAAA3CUgShLdGIxsY7AUABPRrgCABdDuQ5GC7DqPQCgbbJUAoRSUj+NIEig0YfyWUho1VBBBA//uQZB4ABZx5zfMakeAAAAmwAAAAF5F3P0w9GtAAACfAAAAAwLhMDmAYWMgVEG1U0FIGCBgXBXAtfMH10000EEEEEECUBYln03TTTdNBDZopopYvrTTdNa325mImNg3TTPV9q3pmY0xoO6bv3r00y+IDGid/9aaaZTGMuj9mpu9Mpio1dXrr5HERTZSmqU36A3CumzN/9Robv/Xx4v9ijkSRSNLQhAWumap82WRSBUqXStV/YcS+XVLnSS+WLDroqArFkMEsAS+eWmrUzrO0oEmE40RlMZ5+ODIkAyKAGUwZ3mVKmcamcJnMW26MRPgUw6j+LkhyHGVGYjSUUKNpuJUQoOIAyDvEyG8S5yfK6dhZc0Tx1KI/gviKL6qvvFs1+bWtaz58uUNnryq6kt5RzOCkPWlVqVX2a/EEBUdU1KrXLf40GoiiFXK///qpoiDXrOgqDR38JB0bw7SoL+ZB9o1RCkQjQ2CBYZKd/+VJxZRRZlqSkKiws0WFxUyCwsKiMy7hUVFhIaCrNQsKkTIsLivwKKigsj8XYlwt/WKi2N4d//uQRCSAAjURNIHpMZBGYiaQPSYyAAABLAAAAAAAACWAAAAApUF/Mg+0aohSIRobBAsMlO//Kk4soosy1JSFRYWaLC4qZBYWFRGZdwqKiwkNBVmoWFSJkWFxX4FFRQWR+LsS4W/rFRb/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////VEFHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAU291bmRib3kuZGUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMjAwNGh0dHA6Ly93d3cuc291bmRib3kuZGUAAAAAAAAAACU=");return{beep:e}}angular.module("oncoscape").service("osSound",e)}(),function(){"use strict";function e(e,t){var a=t.protocol()+"://"+t.host()+":"+("3000"==t.port()?80:t.port())+"/api/",n=function(e){
var t=a+e.table;return angular.isDefined(e.query)&&(t+="/?q="+encodeURIComponent(JSON.stringify(e.query))),t},o=function(t){return e({method:"GET",url:n(t)})};return{queryString:n,query:o}}e.$inject=["$http","$location"],angular.module("oncoscape").factory("osHttp",e)}(),function(){"use strict"}(),function(){"use strict";function e(e,t,a){var n=new a.Signal,o=new a.Signal,s=new a.Signal,i=new a.Signal,r=new Worker("app/components/oncoscape/oncoscape.cohort.service.worker.js");r.addEventListener("message",function(e){n.dispatch(e)},!1);var l,c,d=[],u=[];e.onDataSource.add(function(t){u=localStorage.getItem(e.getDataSource().disease+"PatientCohorts"),u=null==u?[]:JSON.parse(u),i.dispatch(u)});var p=function(e,t){r.postMessage({cmd:"getSurvivalData",data:{cohorts:e,all:t}})},m=function(){l.ids&&r.postMessage({cmd:"getPatientMetric",data:l.ids})},h=function(){return u},g=function(){return l},v=function(t){-1==u.indexOf(l)&&(u.push(l),localStorage.setItem(e.getDataSource().disease+"PatientCohorts",JSON.stringify(u)))},f=function(t){u.splice(u.indexOf(t),1),localStorage.setItem(e.getDataSource().disease+"PatientCohorts",JSON.stringify(u))},b=function(e,t){function a(){return(65536*(1+Math.random())|0).toString(16).substring(1)}l=angular.isArray(e)?{id:(a()+a()+"-"+a()+"-4"+a().substr(0,3)+"-"+a()+"-"+a()+a()+a()).toLowerCase(),ids:e,name:t,time:new Date}:e,o.dispatch(l)},y=function(){},w=function(){return d},x=function(){return c},A=function(){d.push(c)},k=function(e){d.splice(d.indexOf(e),1)},C=function(e,t){function a(){return(65536*(1+Math.random())|0).toString(16).substring(1)}c=Array.isArray(e)?{id:(a()+a()+"-"+a()+"-4"+a().substr(0,3)+"-"+a()+"-"+a()+a()+a()).toLowerCase(),ids:e,name:t,time:new Date}:e,s.dispatch(c)},S={onMessage:n,onPatientsSelect:o,onCohortsChange:i,getPatientCohorts:h,getPatientCohort:g,setPatientCohort:b,addPatientCohort:v,delPatientCohort:f,getPatientMetric:m,onGenesSelect:s,getGeneCohorts:w,getGeneCohort:x,setGeneCohort:C,addGeneCohort:A,delGeneCohort:k,getGeneMetric:y,getSurvivalData:p};return S}e.$inject=["osApi","moment","signals"],angular.module("oncoscape").service("osCohortService",e)}(),function(){"use strict";function e(e,t,a,n){function o(){return p}function s(){return m}function i(e){angular.isObject(e)?m!=e&&(m=e,h.dispatch(m)):angular.isString(e)&&m.disease!=e&&m!=e&&(m=p.filter(function(e){e.disease==disease},{key:e})[0],h.dispatch(m))}function r(){var e=new a.Signal,o=new a.Signal,s={name:"",password:"",domain:{name:"Guest"},authenticated:!1,token:null,datasets:[]},i=[{name:"Guest"},{name:"FHCRC"},{name:"UW"}],r=function(){s.name="",s.password="",s.domain={name:"Guest"},s.authenticated=!1,s.token=null,s.datasets=[],o.dispatch()},l=function(a){s=a;var o={method:"POST",url:n.protocol()+"://"+n.host()+":"+("3000"==n.port()?80:n.port())+"/login",data:{username:s.name,password:s.password,domain:s.domain.name}};return t(o).then(function(t){t.data.success?(s.authenticated=!0,s.token=t.data.token,s.datasets=t.data.datasets,e.dispatch(s)):(s.authenticated=!1,s.token=null)})};return{getDomains:function(){return i},getUser:function(){return s},login:l,logout:r,onLogin:e,onLogout:o}}function l(){return f}function c(e){e?angular.element(".loader-modal").show():angular.element(".loader-modal").hide()}function d(t,a){return e.queryString({table:t,query:a})}function u(t,a){return e.query({table:t,query:a})}var p,m,h=new a.Signal,g=new a.Signal,v=function(){return{left:"true"==angular.element("#cohortmenu-lock").attr("locked")?300:0,right:"true"===angular.element(".tray-right").attr("locked")?300:0}};u("lookup_oncoscape_datasources",{beta:!1}).then(function(e){p=e.data});var f=r();return{query:u,queryString:d,setDataSource:i,getDataSource:s,getDataSources:o,getLayout:v,onDataSource:h,onResize:g,getUserApi:l,setBusy:c}}e.$inject=["osHttp","$http","signals","$location"],angular.module("oncoscape").service("osApi",e)}(),function(){"use strict";function e(){function e(e,t){var a=e.getUserApi(),n=this;n.domains=a.getDomains(),n.user=a.getUser(),n.hasError=!1,n.login=function(){var e=a.login(n.user);angular.isDefined(e)?e.then(function(){n.user.authenticated?t.go("datasource"):n.hasError=!0}):t.go("datasource")}}e.$inject=["osApi","$state"];var t={restrict:"E",templateUrl:"app/components/login/login.html",replace:!0,controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osLogin",e)}(),function(){function e(){function e(e,t,a,n,o,s,i,r,l,c,d,u,p){function m(e){s.$apply(function(){"mouseout"==e.type?$("#cohortmenu-legand").html(""):$("#cohortmenu-legand").html(e.cyTarget.id()+b[e.cyTarget.id()])})}function h(e){}function g(e){E=!1,a.setPatientCohort(A.$('node[nodeType="patient"]:selected').map(function(e){return e.data().id}),"Markers + Patients")}function v(e){a.setPatientCohort(A.$('node[nodeType="gene"]:selected').map(function(e){return e.data().id}),"Markers + Patients")}e.setBusy(!0);var f,b,y,w=function(){return{patients:{select:new l.Signal,unselect:new l.Signal,over:new l.Signal,out:new l.Signal},genes:{select:new l.Signal,unselect:new l.Signal,over:new l.Signal,out:new l.Signal},edges:{select:new l.Signal,unselect:new l.Signal,over:new l.Signal,out:new l.Signal},clear:function(){this.edges.select.removeAll(),this.edges.unselect.removeAll(),this.edges.over.removeAll(),this.edges.out.removeAll(),this.patients.select.removeAll(),this.patients.unselect.removeAll(),this.patients.over.removeAll(),this.patients.out.removeAll(),this.genes.select.removeAll(),this.genes.unselect.removeAll(),this.genes.over.removeAll(),this.genes.out.removeAll()}}}(),x=angular.element("#markers-chart"),A=function(e){return r({container:e,style:[{selector:"core",style:{"selection-box-color":"#3993fa","selection-box-border-color":"#3993fa","selection-box-border-width":"1px","selection-box-opacity":".2"}},{selector:"node",style:{"background-color":"#3993fa",display:"data(display)",width:"data(sizeEle)",height:"data(sizeEle)","border-width":"data(sizeBdr)","font-size":"data(sizeLbl)","text-valign":"center"}},{selector:'node[nodeType="telomere"]',style:{"background-color":"#3993fa"}},{selector:'node[nodeType="patient"]',style:{"background-color":"data(color)","text-halign":"center","border-color":"#FFFFFF"}},{selector:'node[nodeType="patient"]:selected',style:{"border-color":"#000","border-width":50}},{selector:'node[nodeType="gene"]',style:{"background-color":"#FFFFFF","border-color":"#38347b","text-halign":"right",label:"data(id)"}},{selector:'node[nodeType="gene"]:selected',style:{"border-color":"#FF0000"}},{selector:'node[nodeType="centromere"]',style:{"font-size":"200px","text-halign":"center","background-color":"#3993fa",color:"#FFFFFF","border-color":"rgb(19, 150, 222)",height:"400px",width:"400px",shape:"round",label:"  data(id)"}},{selector:"edge",style:{display:"data(display)","line-color":"data(color)",width:"data(sizeEle)"}},{selector:'node[nodeType="annotation-text"]',style:{"font-size":"400px","text-halign":"right","text-valign":"bottom","background-color":"#FFF",color:"#000","border-color":"#FFF",height:"0px",width:"0px",shape:"round",label:"data(label)","text-transform":"uppercase"}}],hideEdgesOnViewport:!1,hideLabelsOnViewport:!0,textureOnViewport:!1,zoom:.01,pan:{x:550,y:160},minZoom:.005,maxZoom:1,layout:{name:"preset",fit:!0}})}(x);!function(){e.query("render_chromosome",{type:"chromosome"}).then(function(e){var t=e.data[0].data,a=[];Object.keys(t).forEach(function(e){var t=this.chromosomes[e];this.elements.push({group:"edges",grabbable:!1,locked:!0,selectable:!1,data:{color:"#3993fa",id:"ce"+e,display:"element",edgeType:"chromosome",sizeBdr:0,sizeEle:60,source:"cp"+e,target:"cq"+e}}),this.elements.push({group:"nodes",grabbable:!1,locked:!0,selectable:!1,position:{x:t.x,y:t.p},data:{id:"cp"+e,display:"element",nodeType:"telomere",degree:1,sizeBdr:50,sizeEle:50,sizeLbl:6,subType:"unassigned"}}),this.elements.push({group:"nodes",grabbable:!1,locked:!0,selectable:!1,position:{x:t.x,y:t.q},data:{id:"cq"+e,display:"element",nodeType:"telomere",degree:1,sizeBdr:50,sizeEle:50,sizeLbl:50,subType:"unassigned"}}),this.elements.push({group:"nodes",grabbable:!1,locked:!0,selectable:!1,position:{x:t.x,y:t.c},data:{id:e,display:"element",sizeBdr:50,nodeType:"centromere",degree:1}})},{chromosomes:t,elements:a}),A.add(a)})}();var k=function(e,t){return e.showPopupSelection=!1,e.datasource=t.getDataSource(),e.detail={show:!1,html:"",title:""},e.optGeneSets=[],e.optGeneSet,e.optPatientLayouts=[],e.optPatientLayout,e.showPanelLayout=!1,e.showPanelColor=!1,e.showPanelColorRna=!1,e.search="",e.optPatientColors=[],e.optPatientColor,e.optCommandModes=[{name:"Sequential"},{name:"Set"},{name:"Ad Hoc"}],e.optCommandMode=e.optCommandModes[0],e.filterModelEdge=function(){angular.element("#modalEdge").modal("hide");var t=e.optEdgeColors.filter(function(e){return e.show}).map(function(e){return e.id}),a=f.edges.filter(function(e){return-1!=t.indexOf(e.data.cn)},{vals:t});A.startBatch();A.add(a);A.endBatch(),f=null},e.edgeToggle=function(e){e.show||A.remove("edge[cn="+e.id+"]")},e.deselectColor=function(e){var t=e.color,a=A.$('node[nodeType="patient"]:selected');A.startBatch(),a.forEach(function(e){e.data().color==this&&e.unselect()},t),A.endBatch()},e.lockPatients=!1,e.lockGenes=!1,e.lock=function(t){switch(t){case"patient":e.lockPatients=!e.lockPatients,A.startBatch(),A.$('node[nodeType="patient"]').forEach(function(t){e.lockPatients?t.unselectify():t.selectify()}),A.endBatch();break;case"gene":e.lockGenes=!e.lockGenes,A.startBatch(),A.$('node[nodeType="cn"]').forEach(function(t){e.lockGenes?t.unselectify():t.selectify()}),A.endBatch()}},e.optEdgeColors=[{name:"mutation",abv:"m",show:!0,color:"#004358","class":"switch-mutation",id:0},{name:"cnGain.1",abv:"cnG1",show:!0,color:"#1F8A70","class":"switch-cnG1",id:1},{name:"cnLoss.1",abv:"cnL1",show:!0,color:"#800080","class":"switch-cnL1",id:-1},{name:"cnGain.2",abv:"cnG2",show:!0,color:"#BEDB39","class":"switch-cnG2",id:2},{name:"cnLoss.2",abv:"cnL2",show:!0,color:"#FD7400","class":"switch-cnL2",id:-2}],p.all([t.query("render_chromosome",{type:"geneset",$fields:["name"]}),t.query("render_patient",{type:"cluster",$fields:["name"]}),t.query("render_patient",{type:"color",$fields:["name"]})]).then(function(t){e.optGeneSets=t[0].data,e.optGeneSet=e.optGeneSets[0],e.optPatientLayouts=t[1].data,e.optPatientLayout=e.optPatientLayouts[0],e.optPatientColors=[{name:"Default"}].concat(t[2].data),e.optPatientColor=e.optPatientColors[0]}),e.resize=function(){var e=d.innerWidth;x.width(e),x.height(d.innerHeight-90),A.resize()},angular.element(d).bind("resize",u.debounce(e.resize,300)),e}(this,e),C=function(e,t){var a=function(){e.fit(),e.center()},n=function(){e.fit(e.$(":selected"),50)};return t.zoom={reset:a,fit:n},e.on("pan",u.debounce(function(t){e.startBatch(),S(),e.endBatch()},50)),t.zoom}(A,k),S=function(){console.log(A.zoom()+"!!!!");var e=1/A.zoom()/80;.02>e&&(e=.02);var t=50*e,a=500*(2*e);a=a>500?0:a,A.$('node[nodeType="patient"],node[nodeType="gene"]').forEach(function(e){e.data({sizeEle:e.data().weight*this.zoom,sizeLbl:this.sizeLbl,sizeBdr:this.sizeBdr})},{zoom:e,sizeBdr:t,sizeLbl:a})},M=function(e,t,n,o,i,r,l){var c={};y=new Worker("app/components/markers/markers.worker.js"),y.addEventListener("message",function(e){c[e.data.cmd](e.data.data)},!1);var d=function(t,a){if(angular.isUndefined(a))return void e.remove(t);try{var n=a.map(function(e){return this.getElementById(e)},e);e.collection(n).remove()}catch(o){}};return c.patients_html=function(e){b=e},c.patients_resize=function(){},c.patients_delete=function(e){d('node[nodeType="patient"]',e)},c.patients_insert=function(n){e.startBatch();var o=l.patients,s=e.add(n.patients);s.on("select",r.debounce(o.select.dispatch,300)),s.on("unselect",r.debounce(o.unselect.dispatch,300)),s.on("mouseover",o.over.dispatch),s.on("mouseout",o.out.dispatch),s.forEach(function(e){try{e.data({weight:n.degrees[e.id()].weight})}catch(t){e.data({weight:100})}}),S(),e.endBatch(),t.resize();var i=a.getPatientCohort();null==i?a.setPatientCohort([],"All Patients"):(e.startBatch(),e.nodes('node[nodeType="patient"]').forEach(function(e){-1!=i.ids.indexOf(e.id())&&e.select()},{pc:i}),e.endBatch())},c.patients_color=function(t){e.startBatch(),e.nodes('node[nodeType="patient"]').forEach(function(e){e.data("color",t[e.id()].color)}),e.endBatch()},c.patients_layout=function(t){e.startBatch(),e.$("node[nodeType='annotation-text']").remove(),t.annotation&&e.add(t.annotation),e.nodes('node[nodeType="patient"]').forEach(function(e){try{var a=t.data[e.id()];a.x-=4e4,e.position(a)}catch(n){}}),S(),e.endBatch()},c.patients_legend=function(e){s.$apply(function(){t.legendNodes=e})},c.genes_html=function(){},c.genes_delete=function(e){d('node[nodeType="gene"]',e)},c.genes_insert=function(t){e.startBatch();var a=l.genes,o=e.add(t.genes);o.on("select",r.debounce(a.select.dispatch,300)),o.on("unselect",r.debounce(a.unselect.dispatch,300)),o.on("mouseover",a.over.dispatch),o.on("mouseout",a.out.dispatch),o.forEach(function(e){try{e.data({weight:t.degrees[e.id()].weight})}catch(a){e.data({weight:500})}}),e.endBatch(),n.setBusy(!1)},c.edges_delete=function(e){d('edge[edgeType="cn"]',e)},c.edges_insert=function(a){if(f=a,a.counts.total>5e3)return angular.element("#modalEdge").modal(),void s.$apply(function(){t.edgeCounts=a.counts});e.startBatch(),"Ad Hoc"==t.optCommandMode.name&&e.$('edge[edgeType="cn"]').remove();e.add(a.edges);e.endBatch()},function(e){y.postMessage({cmd:"setOptions",data:e})}}(A,k,e,p,C,u,w),T=function(e,t){return function(a){a=a||"";var n=t.optGeneSet.name,o={mode:t.optCommandMode.name,cmd:a,patients:{data:t.datasource.collections.pt,layout:t.optPatientLayout.name,color:t.optPatientColor.name,selected:e.$('node[nodeType="patient"]:selected').map(function(e){return e.data().id})},genes:{layout:t.optGeneSet.name,selected:e.$('node[nodeType="gene"]:selected').map(function(e){return e.data().id})},edges:{layout:t.datasource.edges.filter(function(e){return e.name==this},n)[0],colors:t.optEdgeColors.filter(function(e){return e.show}).map(function(e){return{id:e.id,color:e.color}})}};return o}}(A,k);k.cmd=function(){};var E=(function(t,a){var n=1;n+=1,a.$watch("vm.optGeneSet",function(){return n>0?void(n-=1):void(angular.isUndefined(t.optGeneSet)||angular.isUndefined(t.optPatientColor)||angular.isUndefined(t.optPatientLayout)||(e.setBusy(!0),A.$('edge[edgeType="cn"]').remove(),M(T())))}),n+=1,a.$watch("vm.optPatientColor",function(){return n>0?void(n-=1):void M(T())}),n+=1,a.$watch("vm.optPatientLayout",function(){return n>0?void(n-=1):void M(T())}),n+=1,a.$watch("vm.search",u.debounce(function(){if(n>0)return void(n-=1);var e=t.search.toUpperCase().trim();A.$("node").unselect(),e.length>0&&A.$("node").filter(function(t,a){return 0==a.id().toUpperCase().indexOf(e)}).select()},600)),n+=1,a.$watch("vm.optEdgeColors.color",function(){return n>0?void(n-=1):(M(T()),void t.resize())})}(k,s),!0);a.onPatientsSelect.add(function(e){E&&(A.startBatch(),A.$('node[nodeType="patient"]:selected').deselect(),A.$('node[nodeType="patient"]').forEach(function(t){-1!=e.ids.indexOf(t.id())&&t.select()}),A.endBatch()),E=!0});t.select("#markersRnaColorChart").append("svg").attr("width",400).attr("height",200).append("g");k.colorGene="TP53",k.colorGeneSymbol=function(){var a=("+"+k.colorGene.replace(/\s/g,"").toUpperCase()).match(/[-+]\w*/gi).map(function(e){return{op:e.substr(0,1),gene:e.substr(1)}});e.query("molecular_tcga_brca_rna",{gene:{$in:a.map(function(e){return e.gene})}}).then(function(e){if(e.data.length>0){var n;if(1==e.data.length)n=e.data[0];else{n={},n.patients=e.data.reduce(function(e,t){for(var a=e.lookup[t.gene],n=0;n<e.pids.length;n++){var o=e.pids[n],s=e.output.hasOwnProperty(o)?e.output[o]:0;"+"===a&&(e.output[o]=s+t.patients[o]),"-"===a&&(e.output[o]=s-t.patients[o])}return e},{pids:Object.keys(e.data[0].patients),lookup:a.reduce(function(e,t){return e[t.gene]=t.op,e},{}),output:{}}).output;var o=Object.keys(n.patients).reduce(function(e,t){return e.min=Math.min(e.min,e.values[t]),e.max=Math.max(e.min,e.values[t]),e},{values:n.patients,min:1/0,max:-(1/0)});n.min=o.min,n.max=o.max}console.log(n.min+":"+n.max);var s=t.scale.quantize().domain([n.min,n.max]).range(["#6a32b3","#cd2c8e","#e85434","#a9a10a"]);A.startBatch(),A.nodes('node[nodeType="patient"]').forEach(function(e){e.data("color",n.patients.hasOwnProperty(e.id())?this.scale(n.patients[e.id()]):"#000")},{scale:s}),A.endBatch(),k.showPanelColorRna=!1}})},s.$watch("vm.optCommandMode",function(){switch(w.clear(),A.$("node").unselect(),A.$('edge[edgeType="cn"]').remove(),k.optCommandMode.name){case"Sequential":k.cmd=function(e){switch(e){case"HideAllEdges":A.$('edge[edgeType="cn"]').remove();break;case"HideSelectedEdges":A.$('node[nodeType="patient"]:selected, node[nodeType="gene"]:selected').neighborhood("edge").remove();break;case"HideUnselectedEdges":A.$('node[nodeType="patient"]:unselected').neighborhood("edge").remove();break;case"SelectConnected":A.startBatch(),A.$("node:selected").neighborhood("node").forEach(function(e){e.select()}),A.endBatch();break;case"SelectInverse":A.startBatch(),A.$("node").forEach(function(e){e[e._private.selected?"deselect":"select"]()}),A.endBatch();break;case"HideUnselectedNodes":A.startBatch(),A.$('node[nodeType="patient"]:unselected').forEach(function(e){e.style({display:"none"})}),A.endBatch();break;case"ShowAllNodes":A.startBatch(),A.$('node[nodeType="patient"]:hidden').forEach(function(e){e.style({display:"element"})}),A.endBatch();break;default:var t=T(e);M(t)}},w.genes.over.add(h),w.genes.over.add(h),w.genes.select.add(v),w.genes.unselect.add(v),w.patients.over.add(m),w.patients.out.add(m),w.patients.select.add(g),w.patients.unselect.add(g);break;case"Set":var e=function(){A.$('edge[edgeType="cn"]').remove();var e=T();(e.patients.selected.length>0||e.genes.selected.length>0)&&M(e),g(e)},t=function(){A.$('edge[edgeType="cn"]').remove();var e=T();M(e),g(e)},a=function(){A.$('edge[edgeType="cn"]').remove();var e=T();(e.patients.selected.length>0||e.genes.selected.length>0)&&M(e),v(e)},n=function(){A.$('edge[edgeType="cn"]').remove();var e=T();M(e),v(e)};w.genes.over.add(h),w.genes.over.add(h),w.patients.over.add(m),w.patients.out.add(m),w.patients.select.add(t),w.patients.unselect.add(e),w.genes.select.add(n),w.genes.unselect.add(a);break;case"Ad Hoc":var o=function(e){m(e),e.cyTarget.select(),M(T())},s=function(e){m(e),e.cyTarget.unselect()};w.genes.over.add(h),w.genes.over.add(h),w.patients.over.add(o),w.patients.out.add(s),w.genes.over.add(o),w.genes.out.add(s)}}),s.$on("$destroy",function(){y.terminate(),w.clear()})}e.$inject=["osApi","d3","osCohortService","$state","$timeout","$scope","$stateParams","cytoscape","signals","moment","$window","_","$q"];var t={restrict:"E",templateUrl:"app/components/markers/markers.html",scope:{},controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osMarkers",e)}(),function(){"use strict";function e(){var e={restrict:"E",templateUrl:"app/components/loader/loader.html",replace:!0};return e}angular.module("oncoscape").directive("osLoader",e)}(),function(e,t){var a=function(a,n){var o=function(e,t){if(!n.versionCheck||!n.versionCheck("1.10.1"))throw"DataTables Responsive requires DataTables 1.10.1 or newer";e.responsive||(this.s={dt:new n.Api(e),columns:[]},t&&"string"==typeof t.details&&(t.details={type:t.details}),this.c=a.extend(!0,{},o.defaults,t),e.responsive=this,this._constructor())};return o.prototype={_constructor:function(){var t=this,n=this.s.dt;a(e).on("resize.dtr",n.settings()[0].oApi._fnThrottle(function(){t._resize()})),n.on("destroy.dtr",function(){a(e).off("resize.dtr")}),this.c.breakpoints.sort(function(e,t){return e.width<t.width?1:e.width>t.width?-1:0}),this._classLogic(),this._resizeAuto(),this._resize();var o=this.c.details;o.type&&(t._detailsInit(),this._detailsVis(),n.on("column-visibility.dtr",function(){t._detailsVis()}),a(n.table().node()).addClass("dtr-"+o.type))},_columnsVisiblity:function(e){var t,n,o=this.s.dt,s=this.s.columns,i=a.map(s,function(t){return t.auto&&null===t.minWidth?!1:!0===t.auto?"-":-1!==t.includeIn.indexOf(e)}),r=0;for(t=0,n=i.length;n>t;t++)!0===i[t]&&(r+=s[t].minWidth);for(o=o.table().container().offsetWidth-r,t=0,n=i.length;n>t;t++)s[t].control?o-=s[t].minWidth:"-"===i[t]&&(i[t]=0>o-s[t].minWidth?!1:!0,o-=s[t].minWidth);for(o=!1,t=0,n=s.length;n>t;t++)if(!s[t].control&&!i[t]){o=!0;break}for(t=0,n=s.length;n>t;t++)s[t].control&&(i[t]=o);return i},_classLogic:function(){var e=this,t=this.c.breakpoints,n=this.s.dt.columns().eq(0).map(function(e){return{className:this.column(e).header().className,includeIn:[],auto:!1,control:!1}}),o=function(e,t){var a=n[e].includeIn;-1===a.indexOf(t)&&a.push(t)},s=function(a,s,i,r){if(i){if("max-"===i)for(r=e._find(s).width,s=0,i=t.length;i>s;s++)t[s].width<=r&&o(a,t[s].name);else if("min-"===i)for(r=e._find(s).width,s=0,i=t.length;i>s;s++)t[s].width>=r&&o(a,t[s].name);else if("not-"===i)for(s=0,i=t.length;i>s;s++)-1===t[s].name.indexOf(r)&&o(a,t[s].name)}else n[a].includeIn.push(s)};n.each(function(e,n){for(var o=e.className.split(" "),i=!1,r=0,l=o.length;l>r;r++){var c=a.trim(o[r]);if("all"===c)return i=!0,void(e.includeIn=a.map(t,function(e){return e.name}));if("none"===c)return void(i=!0);if("control"===c)return i=!0,void(e.control=!0);a.each(t,function(e,t){var a=t.name.split("-"),o=c.match(RegExp("(min\\-|max\\-|not\\-)?("+a[0]+")(\\-[_a-zA-Z0-9])?"));o&&(i=!0,o[2]===a[0]&&o[3]==="-"+a[1]?s(n,t.name,o[1],o[2]+o[3]):o[2]===a[0]&&!o[3]&&s(n,t.name,o[1],o[2]))})}i||(e.auto=!0)}),this.s.columns=n},_detailsInit:function(){var e=this,t=this.s.dt,n=this.c.details;"inline"===n.type&&(n.target="td:first-child");var o=n.target;a(t.table().body()).on("click","string"==typeof o?o:"td",function(){if("number"==typeof o){var n=0>o?t.columns().eq().length+o:o;if(t.cell(this).index().column!==n)return}if(a(t.table().node()).hasClass("collapsed"))if(n=t.row(a(this).closest("tr")),n.child.isShown())n.child(!1),a(n.node()).removeClass("parent");else{var s=e.c.details.renderer(t,n[0]);n.child(s,"child").show(),a(n.node()).addClass("parent")}})},_detailsVis:function(){var e=this,t=this.s.dt;-1!==t.columns().visible().indexOf(!1)?(a(t.table().node()).addClass("collapsed"),t.rows().eq(0).each(function(a){if(a=t.row(a),a.child()){var n=e.c.details.renderer(t,a[0]);!1===n?a.child.hide():a.child(n,"child").show()}})):(a(t.table().node()).removeClass("collapsed"),t.rows().eq(0).each(function(e){t.row(e).child.hide()}))},_find:function(e){for(var t=this.c.breakpoints,a=0,n=t.length;n>a;a++)if(t[a].name===e)return t[a]},_resize:function(){for(var t=this.s.dt,n=a(e).width(),o=this.c.breakpoints,s=o[0].name,i=o.length-1;i>=0;i--)if(n<=o[i].width){s=o[i].name;break}var r=this._columnsVisiblity(s);t.columns().eq(0).each(function(e,a){t.column(e).visible(r[a])})},_resizeAuto:function(){var e=this.s.dt,t=this.s.columns;if(this.c.auto&&-1!==a.inArray(!0,a.map(t,function(e){return e.auto}))){e.table().node();var n=e.table().node().cloneNode(!1),o=a(e.table().header()).clone(!1).appendTo(n);a(e.table().body().cloneNode(!0)).appendTo(n);var s=e.settings()[0].oApi._fnGetUniqueThs(e.settings()[0],o),n=a("<div/>").css({width:1,height:1,overflow:"hidden"}).append(n).insertBefore(e.table().node());e.columns().eq(0).each(function(a){t[a].minWidth=e.column(a).visible()?s[e.column(a).index("visible")].offsetWidth:null}),n.remove()}}},o.breakpoints=[{name:"desktop",width:1/0},{name:"tablet-l",width:1024},{name:"tablet-p",width:768},{name:"mobile-l",width:480},{name:"mobile-p",width:320}],o.defaults={breakpoints:o.breakpoints,auto:!0,details:{renderer:function(e,t){var n=e.cells(t,":hidden").eq(0).map(function(t){var n=a(e.column(t.column).header());return n.hasClass("control")?"":'<li><span class="dtr-title">'+n.text()+':</span> <span class="dtr-data">'+e.cell(t).data()+"</span></li>"}).toArray().join("");return n?a("<ul/>").append(n):!1},target:0,type:"inline"}},o.version="1.0.0",a.fn.dataTable.Responsive=o,a.fn.DataTable.Responsive=o,a(t).on("init.dt.dtr",function(e,t){if(a(t.nTable).hasClass("responsive")||a(t.nTable).hasClass("dt-responsive")||t.oInit.responsive){var n=t.oInit.responsive;!1!==n&&new o(t,a.isPlainObject(n)?n:{})}}),o};"function"==typeof define&&define.amd?define(["jquery","datatables"],a):"object"==typeof exports?a(require("jquery"),require("datatables")):jQuery&&!jQuery.fn.dataTable.Responsive&&a(jQuery,jQuery.fn.dataTable)}(window,document),function(){"use strict";function e(){function e(e,t,a,n,o,s,i,r,l,c){var d,u=this,p=t.getPatientCohort();null==p&&t.setPatientCohort([],"All Patients");var m=null==p?[]:p.ids,h=["patient_ID","gender","race","age_at_diagnosis","days_to_death","status_vital"],g=h.map(function(e){return{data:e,title:e.replace(/_/g," "),defaultContent:"NA"}});!function(t){t.datasource=e.getDataSource(),t.diagnosisMin=t.diagnosisMinValue=1,t.diagnosisMax=t.diagnosisMaxValue=1e5,t.survivalMin=t.survivalMinValue=0,t.survivalMax=t.survivalMaxValue=10,t.search="",t.detail=null}(u);var v=function(e,t,a){angular.element.fn.DataTable.ext.search=[function(t,a){if(0!=m.length&&-1==m.indexOf(a[0]))return!1;var n=parseFloat(a[3]);return isNaN(n)?!1:n>=e.diagnosisMin&&n<e.diagnosisMax+1}],d=angular.element("#history-datatable").dataTable({paging:!1,columns:t,data:a,scrollY:"60vh",scrollCollapse:!0,buttons:["copy","csv","excel","pdf","print"]}),d.api().draw()},f=function(a,n){var o=function(){var t=e.getLayout();l(".history-content").css("margin-left",t.left).css("margin-right",t.right),d.api().draw()};e.onResize.add(o),o(),a.exportCsv=function(){var e=d._("tr",{filter:"applied"}).map(function(e){for(var t="",a=0;a<h.length;a++)a>0&&(t+=","),t+=e[h[a]];return t});e.unshift(h.join(",")),e=e.join("\n");var t=encodeURI("data:text/csv;charset=utf-8,"+e);window.open(t)},a.applyFilter=function(e){m=[],d.api().draw();var a=d._("tr",{filter:"applied"}).map(function(e){return e.patient_ID.toString().toUpperCase()});a=l.map(a,function(e){return[e]}),t.setPatientCohort(a,"Patient History")},t.onPatientsSelect.add(function(e){m=e.ids,d.api().draw()})};e.setBusy(!0),e.query(u.datasource.collections.pt,{$fields:h}).then(function(t){var a=t.data.reduce(function(e,t){if(angular.isDefined(t.age_at_diagnosis)){var a=parseInt(t.age_at_diagnosis);e.ageAtDiagnosis.min=Math.min(e.ageAtDiagnosis.min,a),e.ageAtDiagnosis.max=Math.max(e.ageAtDiagnosis.max,a)}return e},{ageAtDiagnosis:{max:-(1/0),min:1/0}});u.diagnosisMin=u.diagnosisMinValue=a.ageAtDiagnosis.min,u.diagnosisMax=u.diagnosisMaxValue=a.ageAtDiagnosis.max,v(u,g,t.data),f(u,o,e),e.setBusy(!1)})}e.$inject=["osApi","osCohortService","$state","$timeout","$scope","moment","$stateParams","_","$","$q"];var t={restrict:"E",templateUrl:"app/components/history/history.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osHistory",e)}(),function(){"use strict";function e(){function e(e){var t=this;t.login=function(){e.go("login")}}e.$inject=["$state"];var t={restrict:"E",templateUrl:"app/components/landing/landing.html",replace:!0,controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osLanding",e)}(),function(){"use strict";function e(){function e(){var e=this;e.videos=[{name:"Oncoscape + Github",desc:"Description Lorum Ipsum eos et sid al accusamus et iusto odio",img:""},{name:"Creating Cohorts",desc:"Description Lorum Ipsum eos et sid al accusamus et iusto odio",img:""},{name:"Patients + Markers",desc:"Description Lorum Ipsum eos et sid al accusamus et iusto odio",img:""},{name:"Timelines",desc:"Description Lorum Ipsum eos et sid al accusamus et iusto odio",img:""}]}var t={restrict:"E",templateUrl:"app/components/help/help.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osHelp",e)}(),function(){"use strict";function e(){function e(e,t,a,n,o){e.query("lookup_oncoscape_tools",{beta:!1}).then(function(e){i.tools=e.data}),e.onDataSource.add(function(){n(function(){i.datasets=e.getDataSources(),i.showTools=!0})});var s=e.getUserApi(),i=this;i.showMenu=!0,i.showTools=!0,i.loadDataset=function(e){a.go("markers",{datasource:e})},i.loadTool=function(t){a.go(t,{datasource:e.getDataSource().disease})},i.logoutClick=function(){s.logout(),a.transitionTo("landing")}}e.$inject=["osApi","$stateParams","$state","$timeout","$rootScope"];var t={restrict:"E",templateUrl:"app/components/header/header.html",scope:{},controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osHeader",e)}(),function(){"use strict";function e(){function e(e,t,a,n,o,s,i,r,l){if(angular.isUndefined(n.datasource))return void a.go("datasource");var c=(angular.element("#geneSetTestsInputsDiv"),this);c.datasource=n.datasource,c.geneSets=[],c.geneSet=null;var d=t.getPatientSelections()[0],u=t.getPatientSelections()[1];e.setBusy(!0),e.setDataset(c.datasource).then(function(t){var a=t.payload.rownames.filter(function(e){return e.indexOf("mtx.mrna")>=0});if(a=a[a.length-1].replace(".RData",""),console.log("**** mtx is: ",a),null==d||null==u)c.message="Please select two cohorts to test out the Gene Set",c.optCohort1="Empty",c.optCohort2="Empty";else{c.optCohort1=d.tool+" "+d.desc+" "+d.ids.length+" Patients selected",c.optCohort2=u.tool+" "+u.desc+" "+u.ids.length+" Patients selected";var n="random.24";e.getGeneSetTest(c.datasource,a).then(function(){s.$watchGroup(["vm.optCohort1","vm.optCohort2"],function(){m(d,u,n)})})}e.setBusy(!1)});var p=function(e,t,a){console.log(a),angular.element("#heatMap").highcharts({chart:{type:"heatmap",marginTop:40,marginBottom:80,plotBorderWidth:1},title:{text:"Gene Set Expression Heat Map"},xAxis:{categories:t},yAxis:{lineWidth:5,lineColor:"#F33",categories:e,title:null},colorAxis:{min:0,minColor:"#FFFFFF",maxColor:"#CC9933"},legend:{align:"right",layout:"vertical",margin:10,verticalAlign:"top",y:25,symbolHeight:280},tooltip:{formatter:function(){return"<b>"+this.series.yAxis.categories[this.point.y]+" "+this.series.xAxis.categories[this.point.x]+": "+this.point.value+"</b>"}},series:[{name:"Sales per employee",borderWidth:0,data:JSON.parse(a)}]})},m=function(t,a,n){var o=t.ids,s=a.ids;e.setBusy(!0),e.getGeneSetScore(o,s,n).then(function(t){if(console.log(t.payload),"error"==t.status)c.message=t.payload+"Please select two cohorts to test out the Gene Set";else{c.message=t.payload.summary;var a=t.payload.pt,n=t.payload.genes;p(a,n,t.payload.analysisData)}e.setBusy(!1)})}}e.$inject=["osApi","osHistory","$state","$stateParams","$timeout","$scope","d3","$window","_"];var t={restrict:"E",templateUrl:"app/components/genesettest/genesettest.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osGenesettest",e)}(),function(){"use strict";function e(){function e(e,t){var a=this;a.datasets=e.getDataSources(),a.explore=function(a,n){e.setDataSource(n),t.go(a,{datasource:n.disease})}}e.$inject=["osApi","$state"];var t={restrict:"E",templateUrl:"app/components/datasource/datasource.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osDatasource",e)}(),function(){"use strict";function e(){function e(e,t,a,n,o,s){if(angular.isUndefined(o.datasource))return void t.go("datasource");var i=this;i.dataSources,i.dataSource,i.dataDiseases,i.dataDisease,i.dataTables,i.dataTable,i.dataFields,i.dataField;var r={chart:{type:"discreteBarChart",height:450,margin:{top:20,right:20,bottom:50,left:55},x:function(e){return e.label},y:function(e){return e.value},showValues:!0,valueFormat:function(e){return d3.format(",.4f")(e)},duration:500,xAxis:{axisLabel:"X Axis"},yAxis:{axisLabel:"Y Axis",axisLabelDistance:-10}}};i.chartOptions=r,i.toolTipContentFunction=function(){return function(e,t,a,n,o){return"Super New Tooltip<h1>"+e+"</h1><p>"+a+" at "+t+"</p>"}},i.xFunction=function(){return function(e){
return e.label}},i.yFunction=function(){return function(e){return e.value}},e.setBusy(!0),e.query("_collections").then(function(t){i.dataSources=t.data,i.dataSource=i.dataSources[0],n.$watch("vm.dataSource",function(){i.dataDiseases=i.dataSource.diseases,i.dataDisease=i.dataSource.diseases[0]}),n.$watch("vm.dataDisease",function(){i.dataTables=i.dataDisease.tables,i.dataTable=i.dataTables[0]}),n.$watch("vm.dataTable",function(){e.query("_field_detail",{collection:i.dataTable.collection}).then(function(e){i.dataFields=e.data[0].fields.filter(function(e){return"_id"!=e.key}),i.dataField=i.dataFields[0],console.dir(i.dataField)})}),e.setBusy(!1)})}e.$inject=["osApi","$state","$timeout","$scope","$stateParams","_"];var t={restrict:"E",templateUrl:"app/components/dataexplorer/dataexplorer.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osDataExplorer",e)}(),function(){"use strict";function e(){function e(e,t,a,n,o,s){var i=function(e){if("[object Object]"==e.toString())return!1;switch(e){case"/":case"/datasource":case"/tools/{datasource}":return!1}return!0},r=this;r.cohorts=[],r.patientChartOption=null,r.addCohort=function(){},r.setCohort=function(){},r.removeCohort=function(){},r.editItem={name:""},r.editCohort=function(e){r.editItem=e,r.edit=!0},r.show=i(a.current),r.edit=!1,t.onCohortsChange.add(function(e){r.cohorts=e}),s.$on("$stateChangeStart",function(e,t,a,n,o){r.show=i(t.url)});var l=angular.element(".cohort-menu"),c=function(){l.removeClass("tray-collapsed-left")},d=function(){l.addClass("tray-collapsed-left")},u=angular.element("#cohort-tab-patients"),p=angular.element("#cohort-tab-genes");r.showPatientHistory=function(){u.addClass("active"),p.removeClass("active"),r.cohorts=t.getPatientCohorts(),r.addCohort=t.addPatientCohort,r.setCohort=t.setPatientCohort,r.removeCohort=t.delPatientCohort},r.showGeneHistory=function(){p.addClass("active"),u.removeClass("active"),r.cohorts=t.getGeneCohorts(),r.addCohort=t.addGeneCohort,r.setCohort=t.setGeneCohort,r.removeCohort=t.delGeneCohort};var m=!0;r.toggle=function(){m=!m,angular.element("#cohortmenu-lock").addClass(m?"fa-lock":"fa-unlock-alt").removeClass(m?"fa-unlock-alt":"fa-lock").attr("locked",m?"true":"false"),m?l.unbind("mouseover",c).unbind("mouseout",d).removeClass("tray-collapsed-left"):l.addClass("tray-collapsed-left").bind("mouseover",c).bind("mouseout",d),e.onResize.dispatch()};var h=function(e,t){},g=d3.select("#cohortmenu-chart").append("svg").attr("width",238).attr("height",150).append("g");n.$watch("vm.patientChartOption",function(){if(null!=r.patientChartOption){var e=r.patientChartOption.data,t=Math.floor(238/e.bins);e.histRange[0]>0&&(e.histRange[0]-=2);var a=d3.scale.linear().domain(e.histRange).range([0,135]),n=g.selectAll(".cohort-menu-chart-bar").data(e.hist);n.enter().append("rect").attr("class","cohort-menu-chart-bar").attr("x",function(e,a){return t*a}).attr("y",function(e,t){return 150-a(e.value)}).attr("height",function(e,t){return a(e.value)}).attr("width",t).on("click",h),n.transition().duration(300).attr("x",function(e,a){return(t+1)*a}).attr("y",function(e,t){return 150-a(e.value)}).attr("height",function(e,t){return a(e.value)}).attr("width",t),n.exit().transition().duration(300).attr("y",150).attr("height",0).style("fill-opacity",1e-6).remove();var o=g.selectAll("text").data(e.hist);o.enter().append("text").attr("x",function(e,a){return(t+1)*a+.5*t}).attr("y",function(e,t){return 145-a(e.value)}).attr("fill","#000").attr("height",function(e,t){return a(e.value)}).attr("width",t).attr("font-size","8px").attr("text-anchor","middle").text(function(e){return e.label}),o.transition().duration(300).attr("x",function(e,a){return(t+1)*a+.5*t}).attr("y",function(e,t){var n=145-a(e.value);return 0>n&&(n=20),n}).text(function(e){return e.label}),o.exit().transition().duration(300).attr("y",150).attr("height",0).style("fill-opacity",1e-6).remove()}}),t.onPatientsSelect.add(function(e){t.getPatientMetric()}),t.onGenesSelect.add(function(e){console.log("GENES")}),t.onMessage.add(function(e){"setPatientMetric"==e.data.cmd&&o(function(){r.patientTotal=e.data.data.total,r.patientSelected=e.data.data.selected,r.patientChartOptions=e.data.data.features,r.patientChartOption=r.patientChartOptions[0]})}),r.showPatientHistory()}e.$inject=["osApi","osCohortService","$state","$scope","$timeout","$rootScope"];var t={restrict:"E",templateUrl:"app/components/cohortmenu/cohortmenu.html",controller:e,controllerAs:"vm",scope:{},bindToController:!0};return t}angular.module("oncoscape").directive("osCohortMenu",e)}(),function(){"use strict";function e(e,t,a,n,o){a.onerror=function(e,t,a,o,s){s||(s=new Error(e),s.fileName=t,s.lineNumber=a,s.columnNumber=o||0),n(s)};var s=e.$on("$stateChangeStart",function(e,a,n){return o.setBusy(!1),angular.element.fn.DataTable.ext.search=[],a.authenticate&&!o.getUserApi().getUser().authenticated?(t.transitionTo("landing"),void e.preventDefault()):a.datasource&&(angular.isUndefined(n.datasource)||""===n.datasource)?(t.transitionTo("datasource"),void e.preventDefault()):void o.setDataSource(n.datasource)});e.$on("$destroy",s)}e.$inject=["$rootScope","$state","$window","$exceptionHandler","osApi"],angular.module("oncoscape").run(e)}(),function(){"use strict";function e(e,t){e.state("landing",{url:"/",template:"<os-landing>",authenticate:!1,datasource:!1}).state("help",{url:"/help",template:"<os-help>",authenticate:!1,datasource:!1}).state("datasource",{url:"/datasource",template:"<os-datasource>",authenticate:!0,datasource:!1}).state("tools",{url:"/tools/{datasource}",template:"<os-tools>",authenticate:!0,datasource:!0}).state("metadata",{url:"/metadata/{datasource}",template:"<os-metadata>",authenticate:!0,datasource:!0}).state("history",{url:"/history/{datasource}",template:"<os-history>",authenticate:!0,datasource:!0}).state("plsr",{url:"/plsr/{datasource}",template:"<os-plsr>",authenticate:!0,datasource:!0}).state("pca",{url:"/pca/{datasource}",template:"<os-pca>",authenticate:!0,datasource:!0}).state("pca3d",{url:"/pca3d/{datasource}",template:"<os-pca3d>",authenticate:!0,datasource:!0}).state("markers",{url:"/markers/{datasource}",template:"<os-markers>",authenticate:!0,datasource:!0}).state("pathways",{url:"/pathways/{datasource}",template:"<os-pathways>",authenticate:!0,datasource:!0}).state("timelines",{url:"/timelines/{datasource}",template:"<os-timelines>",authenticate:!0,datasource:!0}).state("survival",{url:"/survival/{datasource}",template:"<os-survival>",authenticate:!0,datasource:!0}).state("dataexplorer",{url:"/dataexplorer/{datasource}",template:"<os-data-explorer>",authenticate:!0,datasource:!0}).state("oncoprint",{url:"/oncoprint/{datasource}",template:"<os-oncoprint>",authenticate:!0,datasource:!0}).state("genesettest",{url:"/genesettest/{datasource}",template:"<os-genesettest>",authenticate:!0,datasource:!0}).state("cohortbuilder",{url:"/cohortbuilder/{datasource}",template:"<os-cohort-builder>",authenticate:!0,datasource:!0}),t.otherwise("/")}e.$inject=["$stateProvider","$urlRouterProvider"],angular.module("oncoscape").config(e)}(),function(){"use strict";angular.module("oncoscape").constant("moment",moment).constant("d3",d3).constant("cytoscape",cytoscape).constant("signals",signals).constant("$",$).constant("_",_),Number.prototype.map=function(e,t,a,n){return(this-e)*(n-a)/(t-e)+a}}(),function(){"use strict";function e(e){e.debugEnabled(!0)}e.$inject=["$logProvider"],angular.module("oncoscape").config(e)}(),angular.module("oncoscape").run(["$templateCache",function(e){e.put("app/components/dataexplorer/dataexplorer.html",'<os-tray content="tray-content-block" change="vm.resize($event)"><section class="tray-content dataexplorer"><div class="row"><div class="col-xs-12 form-label"><h2>Data Source</h2></div><div class="col-xs-12 form-item"><label>Origin</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.dataSource.name}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1" style="width:100%"><li ng-repeat="item in vm.dataSources" ng-click="vm.dataSource = item">{{item.name}}</li></ul></div></div><div class="col-xs-12 form-item"><label>Disease</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.dataDisease.name}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1" style="width:100%"><li ng-repeat="item in vm.dataDiseases" ng-click="vm.dataDisease = item">{{item.name}}</li></ul></div></div><div class="col-xs-12 form-item"><label>Table</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.dataTable.name}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1" style="width:100%"><li ng-repeat="item in vm.dataTables" ng-click="vm.dataTable = item">{{item.name}}</li></ul></div></div><div class="col-xs-12 form-item"><label>Field</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.dataField.key}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1" style="width:100%"><li ng-repeat="item in vm.dataFields" ng-click="vm.dataField = item">{{item.key}}</li></ul></div></div><div class="col-xs-12 form-label"><h2>Table Info</h2><dl><dt>Date Uploaded</dt><dd>{{vm.dataTable.created}}</dd><dt>Record Count</dt><dd>{{vm.dataTable.records}}</dd><dt>Field Count</dt><dd>{{vm.dataFields.length}}</dd></dl></div></div></section></os-tray><section class="tray-content-block dataexplorer"><div class="container-fluid"><h2>Data Explorer</h2><div ng-repeat="item in vm.dataFields" class="data-field"><b>{{item.key}}</b><div style="width:30%; margin-top:10px">{{item.name}}. {{item.desc}}</div><nvd3 options="vm.chartOptions" data="item.values"></nvd3></div></div></section>'),e.put("app/components/cohortmenu/cohortmenu.html",'<div ng-show="vm.show"><label class="tray-label tray-label-left">Cohorts</label><div class="cohort-menu tray tray-left"><section><div class="row"><div class="col-xs-12 form-item"><ul class="nav nav-tabs"><li id="cohort-tab-patients" role="presentation" style="width:50%;text-align:center;" ng-click="vm.showPatientHistory()"><a>Patients</a></li></ul><div style="background-color:#ffffff;border:#dddddd 1px solid;border-top-width:0px;padding:10px;"><br><div id="cohortmenu-chart" style="width:100%;height:150px;"></div><div class="dropdown"><button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown" style="width:100%;">{{vm.patientChartOption.label}} <span class="caret"></span></button><ul class="dropdown-menu"><li style="padding:0px 5px;" ng-repeat="item in vm.patientChartOptions" ng-click="vm.patientChartOption=item">{{item.label}}</li></ul></div><br><button class="btn-xs btn btn-default" style="float:right;" ng-click="vm.addCohort()"><i style="color:#0b97d3" class="glyphicon glyphicon-plus"></i></button> <label>Save current selection as a cohort</label><div ng-if="vm.edit"><hr style="margin:5px;"><label>Edit Cohort (Rename &amp; Remove)</label><div class="row"><div class="col-xs-12 form-group" style="margin-top:10px;"><input type="text" class="form-control" ng-model="vm.editItem.name"></div><button class="col-xs-5 btn btn-sm btn-default" ng-click="vm.removeCohort(vm.editItem);vm.edit=false;">Remove</button> <button class="col-xs-5 col-xs-push-2 btn btn-sm btn-primary" ng-click="vm.edit=false">Done</button></div></div><div ng-if="vm.cohorts.length>0 && !vm.edit"><hr style="margin:5px;"><label>My Cohorts</label><div ng-repeat="cohort in vm.cohorts track by $index"><button class="btn-xs btn btn-default" style="float:right;" ng-click="vm.editCohort(cohort)"><i style="color:#0b97d3" class="glyphicon glyphicon-edit"></i></button> <a class="markers-command hvr-sweep-to-right" style="margin-right:25px;" ng-click="vm.setCohort(cohort)">{{cohort.name}}</a></div></div></div></div></div><div id="cohortmenu-legand"></div><i id="cohortmenu-lock" class="fa fa-lock tray-sticky-icon" ng-click="vm.toggle()" locked="true"></i></section></div></div>'),e.put("app/components/datasource/datasource.html",'<section class="datasource container-fluid"><div class="row"><div class="col-sm-8 col-md-6"><h1>Data Sources</h1><p>Oncoscape has analyzed and curated the following datasets hosted by The Cancer Genome Atlas (TCGA). Raw data sets for these and other available disease sites can be found at <a href="https://tcga-data.nci.nih.gov/tcga/">TCGA Data Portal</a>.</p></div></div><div class="row"><ul><li ng-repeat="dataset in vm.datasets" class="col-xs-12 col-sm-6 col-lg-4" ng-click="vm.explore(\'tools\',dataset)"><img class="datasource-img" ng-src="/assets/images/datasets/{{dataset.img}}"><h3 class="datasource-lbl">{{dataset.name}} ({{dataset.source}})</h3><nobr><a href="">Explore</a></nobr></li></ul></div></section>'),e.put("app/components/genesettest/genesettest.html",'<os-tool-menu datasource="{{vm.datasource}}" change="vm.addCohortPatient()"></os-tool-menu><script src="https://cdn.plot.ly/plotly-latest.min.js"></script><script src="/bower_components/highcharts/modules/heatmap.js"></script><script src="/bower_components/highcharts/modules/exporting.js"></script><os-tray content="tray-content-block" change="vm.resize($event)"><section class="tray-content"><div class="col-xs-12 form-label"><h2>Cohorts</h2></div><div class="col-sm-12 form-item"><label>Patient Cohort 1</label><p>{{vm.optCohort1}}</p></div><div class="col-sm-12 form-item"><label>Patient Cohort 2</label><p>{{vm.optCohort2}}</p></div></section></os-tray><section class="tray-content-block"><div class="container-fluid"><h2 class="h2-tool">Gene Set Binomial Test</h2><h3 class="h3-datasource">{{vm.datasource}}</h3><div id="geneSetTestsModuleDiv" class="genesettest"><div id="geneSetTests_Div"><div id="geneSetTestsControlsDiv"><div class="navbar-collapse collapse navbar-inverse-collapse"><div id="geneSetTestsInputsDiv"><div id="geneSetTestsLaunchButtonDiv"><form><div>{{vm.message}}</div><div id="heatMap"></div></form></div></div></div></div></div></div></div></section>'),e.put("app/components/header/header.html",'<div class="header"><nav class="navbar navbar-inverse navbar-fixed-top"><div class="container-fluid"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button> <a class="navbar-brand" href="#"><img alt="Brand" src="/assets/images/logo.png" style="max-height:50px;"></a></div><div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1" ng-if="vm.showMenu"><ul class="nav navbar-nav navbar-right"><li class="dropdown"><a href="" class="dropdown-toggle header-link" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><span class="glyphicon glyphicon-th"></span>Data Sources</a><ul class="dropdown-menu"><li ng-repeat="item in vm.datasets" ng-click="vm.loadDataset(item.disease)"><a><img class="header-dropdown-img" ng-src="/assets/images/datasets/{{item.img}}">{{item.name}}</a></li></ul></li><li class="dropdown"><a href="" class="dropdown-toggle header-link" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><span class="glyphicon glyphicon-stats"></span>Analysis Tools</a><ul class="dropdown-menu"><li ng-repeat="item in vm.tools" ng-click="vm.loadTool(item.route)"><a><img class="header-dropdown-img" ng-src="/assets/images/datasets/{{item.img}}">{{item.name}}</a></li></ul></li><li><a ng-click="vm.logoutClick()" class="header-link"><span class="glyphicon glyphicon-user"></span>Logout</a></li></ul></div></div><div class="nav-divider"></div></nav></div><a href="https://github.com/FredHutch/Oncoscape/labels/help%20wanted" class="github" tooltip="Submit Issues" style="text-align: right;"><div class="logo"><svg aria-hidden="true" class="octicon octicon-mark-github" height="28" role="img" version="1.1" viewbox="0 0 16 16" width="28"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59 0.4 0.07 0.55-0.17 0.55-0.38 0-0.19-0.01-0.82-0.01-1.49-2.01 0.37-2.53-0.49-2.69-0.94-0.09-0.23-0.48-0.94-0.82-1.13-0.28-0.15-0.68-0.52-0.01-0.53 0.63-0.01 1.08 0.58 1.23 0.82 0.72 1.21 1.87 0.87 2.33 0.66 0.07-0.52 0.28-0.87 0.51-1.07-1.78-0.2-3.64-0.89-3.64-3.95 0-0.87 0.31-1.59 0.82-2.15-0.08-0.2-0.36-1.02 0.08-2.12 0 0 0.67-0.21 2.2 0.82 0.64-0.18 1.32-0.27 2-0.27 0.68 0 1.36 0.09 2 0.27 1.53-1.04 2.2-0.82 2.2-0.82 0.44 1.1 0.16 1.92 0.08 2.12 0.51 0.56 0.82 1.27 0.82 2.15 0 3.07-1.87 3.75-3.65 3.95 0.29 0.25 0.54 0.73 0.54 1.48 0 1.07-0.01 1.93-0.01 2.2 0 0.21 0.15 0.46 0.55 0.38C13.71 14.53 16 11.53 16 8 16 3.58 12.42 0 8 0z"></path></svg></div></a>'),e.put("app/components/help/help.html",'<section class="tools container"><div class="row"><div class="col-sm-8 col-md-6"><br><br><br></div></div><div class="row"><div class="col-xs-12 col-md-7"><h2 style="margin:0px;margin-bottom: 20px;">Now Playing &mdash; Lorum Ipsum</h2><div style="background-color:#000;text-align: center;"><video width="640" height="360" controls="" style="background-color: #000;max-width: 100%;"></video></div><h2>Video Title</h2><p>Transcription At vero eos et accusamus et iusto odio dignissimos ducimus qui blanditiis praesentium voluptatum deleniti atque corrupti quos dolores et quas molestias excepturi sint occaecati cupiditate non provident, similique sunt in culpa qui officia deserunt mollitia animi, id est laborum et dolorum fuga. Et harum quidem rerum facilis est et expedita distinctio. Nam libero tempore, cum soluta nobis est eligendi optio cumque nihil impedit quo minus id quod maxime placeat facere possimus, omnis voluptas assumenda est, omnis dolor repellendus. Temporibus autem quibusdam et aut officiis debitis aut rerum necessitatibus saepe eveniet ut et voluptates repudiandae sint et molestiae non recusandae. Itaque earum rerum hic tenetur a sapiente delectus, ut aut reiciendis voluptatibus maiores alias consequatur aut perferendis doloribus asperiores repellat</p></div><div class="col-xs-12 col-md-5" style="padding-left: 40px;"><h2 style="margin:0px;">Oncoscape Videos</h2><ul><li ng-repeat="video in vm.videos" style="clear: both;"><div style="width:30%;height:90px;background-color:#EEE;display:inline-block;float:left;margin-bottom: 20px;text-align: center;cursor: pointer;"><span class="glyphicon glyphicon-play-circle" style="font-size: 30px;padding-top:30px; color:#FFF"></span></div><div style="width:69%;display: inline-block;float:left;padding-left: 10px;"><h3 class="tools-lbl" style="margin:0px;">{{video.name}}</h3><p>{{video.desc}}</p><a href="" ng-click="vm.explore(tool.route, vm.datasource)">Watch Video</a></div></li></ul></div></div></section>'),e.put("app/components/history/history.html",'<os-tray caption="Patients" content="tray-content-block"><section class="tray-content"><div class="row"><div class="col-xs-12 form-item"><br><label>Export</label><div><button class="btn btn-default" ng-click="vm.exportCsv()">Excel (CSV)</button></div></div></div></section></os-tray><section class="history-content"><div class="container-fluid" style="text-align:center;"><h2 class="h2-tool">Patient Data</h2><span class="h3-tool">{{vm.datasource.source}} {{vm.datasource.name}}</span><table id="history-datatable" class="table table-striped table-bordered dt-responsive nowrap" cellspacing="0" width="100%"></table></div></section>'),e.put("app/components/landing/landing.html",'<div class="landing container"><div class="row" style="padding-top:20px;"><h2>Bridging Cancer Research and Clinical Care</h2></div><div class="row" style="padding-top:20px;"><div class="col-sm-8"><p>Oncoscape is developed at the Fred Hutchinson Cancer Research Center under the auspices of the Seattle Translational Tumor Research initiative. Oncoscape is a web-based, menu-driven analysis and visualization platform for large-scale, heterogeneous clinical and molecular patient timeline data as exemplified by the Fred Hutch HIDRA database. Oncoscape vision and development is managed by a small team comprising: <a href="https://www.fredhutch.org/en/labs/profiles/holland-eric.html">Eric Holland</a>, <a href="http://www.sttrcancer.org/en/contact-us/horse-grant-bio.html">Desert Horse-Grant</a>, <a href="https://www.linkedin.com/in/lisa-mcferrin-9758b029">Lisa McFerrin</a>, <a href="https://www.linkedin.com/in/hbolouri">Hamid Bolouri</a>, <a href="https://www.linkedin.com/in/jenny-zhang-ba62a2104">Jenny Zhang</a>, <a href="https://www.linkedin.com/in/gretchenh">Gretchen Heinrich</a>, <a href="https://www.linkedin.com/in/robert-mcdermott-a77b9011">Robert McDermott</a> and <a href="https://www.linkedin.com/in/zager">Michael Zager</a>.</p><p class="">Through its easy point-and-click browser interface, Oncoscape will become an essential tool for doctors and researchers interested in:</p><ul class=""><li>Comparing patients or populations across an array of features, like genetic alterations (CNV, IHC, sequencing, expression) or clinical elements (treatment regimens, diagnostics, outcomes)</li><li>Defining cohorts based on selected traits – identifying “patients like me”</li><li>Aligning patient histories according to timeline events: diagnosis, treatment, progression, survival</li><li>Performing powerful and integrated statistical analysis: Principle Component Analysis, Partial least squares regression, Kaplan-Meier curves, enrichment scores</li><li>Creating high quality visualizations of molecular/clinical data</li></ul><p class="">By providing a portal equipped with rich data, powerful statistics and a simple interface, Oncoscape not only empowers users to quickly answer questions themselves but also expedites the process of discovering novel patterns and relationships. This can lead to numerous possible findings, including optimized drug therapies for individual patients, identification of novel regulatory pathways, or even the need to reassess adherence strategies.</p></div><div class="col-sm-4"><os-login></os-login></div></div></div>'),e.put("app/components/loader/loader.html",'<div class="loader-modal"><div class="loader"><div class="loader__bar"></div><div class="loader__bar"></div><div class="loader__bar"></div><div class="loader__bar"></div><div class="loader__bar"></div><div class="loader__ball"></div></div></div>'),e.put("app/components/login/login.html",'<form class="login"><h3 class="login-header">Login</h3><div class="login-body"><div class="alert alert-danger" role="alert" ng-show="vm.hasError"><span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span> <span class="sr-only">Error:</span> Invalid Credentials</div><fieldset class="form-group"><span for="domain" class="small">Affiliation</span><select id="domain" class="form-control" ng-options="option.name for option in vm.domains track by option.name" ng-model="vm.user.domain"></select></fieldset><fieldset class="form-group" ng-show="vm.user.domain.name!=\'Guest\'"><span class="form-control-label small" for="username">Username</span> <input id="username" class="form-control input-sm" type="text" placeholder="Username" ng-model="vm.user.name"></fieldset><fieldset class="form-group" ng-show="vm.user.domain.name!=\'Guest\'"><span class="form-control-label small" for="password">Password</span> <input id="password" class="form-control" type="password" placeholder="Password" ng-model="vm.user.password"></fieldset><button class="btn btn-default" ng-click="vm.login()">Login</button></div></form>'),e.put("app/components/markers/markers.html",'<os-tray content="tray-content-block" change="vm.resize()"><section class="tray-content"><div class="row"><br><div class="col-xs-12 form-item"><label>Patient Selection</label><div ng-repeat="item in vm.legendNodes" class="legend-bar" style="border-color:{{item.color}};position:relative;background-color:#FFF;padding:2px 10px;line-height:25px;">{{item.name}} <label style="float:right"></label></div></div><div class="col-xs-12 form-item"><label>Edge Visibility</label><div ng-repeat="item in vm.optEdgeColors" class="legend-bar" style="border-color:{{item.color}};position:relative;background-color:#FFF;padding:2px 10px;line-height:25px;">{{item.name}} <label class="switch {{item.class}}" style="float:right"><input type="checkbox" class="switch-input" ng-model="item.show" ng-change="vm.edgeToggle(item)"> <span class="switch-label" data-on="On" data-off="Off"></span> <span class="switch-handle"></span></label></div></div><div class="col-xs-12 form-item" ng-if="vm.optCommandMode.name==\'Sequential\'"><label>Commands</label><br><a ng-click="vm.cmd(\'ShowSelectedEdges\')" class="markers-command hvr-sweep-to-right">Show Edges of Selected</a> <a ng-click="vm.cmd(\'HideSelectedEdges\')" class="markers-command hvr-sweep-to-right">Hide Edges of Selected</a> <a ng-click="vm.cmd(\'HideUnselectedEdges\')" class="markers-command hvr-sweep-to-right">Hide Edges of Unselected</a> <a ng-click="vm.cmd(\'HideAllEdges\')" class="markers-command hvr-sweep-to-right">Hide All Edges</a> <a ng-click="vm.cmd(\'SelectInverse\')" class="markers-command hvr-sweep-to-right">Invert Node Selection</a> <a ng-click="vm.cmd(\'SelectConnected\')" class="markers-command hvr-sweep-to-right">Select Connected Nodes</a> <a ng-click="vm.cmd(\'HideUnselectedNodes\')" class="markers-command hvr-sweep-to-right">Hide Unselected Nodes</a> <a ng-click="vm.cmd(\'ShowAllNodes\')" class="markers-command hvr-sweep-to-right">Show All Nodes</a></div><div class="col-xs-6 form-item" style="padding-right:5px"><label>Command Mode</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" style="padding-right:30px;">{{vm.optCommandMode.name}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1" style="width:100%"><li ng-repeat="item in vm.optCommandModes" ng-click="vm.optCommandMode=item">{{item.name}}</li></ul></div></div><div class="col-xs-6 form-item" style="padding-left:5px"><label>Gene Set</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" style="padding-right:30px;">{{vm.optGeneSet.name}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1" style="width:100%"><li ng-repeat="item in vm.optGeneSets" ng-click="vm.optGeneSet=item">{{item.name}}</li></ul></div></div><div class="col-xs-12 form-item" style="padding-left:5px"><label>Layout + Color</label><div class="btn-group" role="group" style="display: block"><button class="btn btn-default btn-no-focus" type="button" ng-click="vm.showPanelLayout = true" style="width:50%; font-weight: 300;" title="Patient Selection Lock">Layout</button> <button class="btn btn-default btn-no-focus" type="button" ng-click="vm.showPanelColor = true" style="width:50%; font-weight: 300;" title="Gene Selection Lock">Color</button></div></div><div class="col-xs-12 form-item" style="padding-left:5px"><label>Lock Selections</label><div class="btn-group" role="group" style="display: block"><button class="btn btn-default btn-no-focus" type="button" ng-click="vm.lock(\'patient\')" style="width:50%; font-weight: 300;" title="Patient Selection Lock"><i class="fa fa-unlock" ng-show="!vm.lockPatients"></i> <i class="fa fa-lock" ng-show="vm.lockPatients"></i> Patients</button> <button class="btn btn-default btn-no-focus" type="button" ng-click="vm.lock(\'gene\')" style="width:50%; font-weight: 300;" title="Gene Selection Lock"><i class="fa fa-unlock" ng-show="!vm.lockGenes"></i> <i class="fa fa-lock" ng-show="vm.lockGenes"></i> Genes</button></div></div><div class="col-xs-12 form-item" style="padding-left:5px"><label>Zoom</label><div class="btn-group" role="group" style="display: block"><button class="btn btn-default btn-no-focus" type="button" ng-click="vm.zoom.reset()" style="width:50%; font-weight: 300;" title="Zoom Reset">Reset</button> <button class="btn btn-default btn-no-focus" type="button" ng-click="vm.zoom.fit()" style="width:50%; font-weight: 300;" title="Zoom Selection">Selected</button></div></div><div class="col-xs-12 form-item"><label>Search</label> <input type="text" class="form-control" ng-model="vm.search" placeholder="Genes or Patients"></div></div></section></os-tray><section class="tray-content-block"><div id="markers-chart" class="markers-chart"></div><div style="position:absolute;top:10px;text-align:center;width:100%;"><h2 class="h2-tool">Patients + Markers</h2><span class="h3-tool">{{vm.datasource.source}} {{vm.datasource.name}}</span></div></section><div id="modalEdge" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-body"><h2 style="margin-top:0px;">Your request would add {{vm.edgeCounts.total}} edges to the graph.</h2><p>To improve performance + readability you may want to disable some of the edges.</p><div class="input-group" ng-repeat="item in vm.optEdgeColors | filter:{show:true}"><label class="switch {{item.class}}"><input type="checkbox" class="switch-input" ng-model="item.show"> <span class="switch-label" data-on="On" data-off="Off"></span> <span class="switch-handle"></span></label> <span style="padding-left:20px;">{{item.name}} ({{vm.edgeCounts[item.abv]}})</span></div></div><button class="btn btn-default" style="position:absolute;right:10px;bottom:10px;" ng-click="vm.filterModelEdge()">Continue</button></div></div></div><div class="panel panel-default mdi" ng-if="vm.showPanelColor"><div class="panel-heading"><h3 class="panel-title">Patient Color</h3><span class="pull-right clickable" data-effect="fadeOut" ng-click="vm.showPanelColor=false"><i class="fa fa-times"></i></span></div><div class="panel-body"><div ng-if="!vm.showPanelColorRna"><a class="markers-command hvr-sweep-to-right" ng-click="vm.showPanelColorRna=true">RNA Expression</a> <a class="markers-command hvr-sweep-to-right" ng-repeat="item in vm.optPatientColors" ng-click="vm.optPatientColor=item">{{item.name}}</a></div><div ng-if="vm.showPanelColorRna"><label>Enter Gene Symbol</label><div class="input-group"><input ng-model="vm.colorGene" type="text" class="form-control" placeholder="Hugo Gene Symbol"> <span class="input-group-btn"><button class="btn btn-default" type="button" ng-click="vm.colorGeneSymbol()">Submit</button></span></div><div id="markersRnaColorChart"></div></div></div></div><div class="panel panel-default mdi" ng-if="vm.showPanelLayout"><div class="panel-heading"><h3 class="panel-title">Patient Layout</h3><span class="pull-right clickable" data-effect="fadeOut" ng-click="vm.showPanelLayout=false"><i class="fa fa-times"></i></span></div><div class="panel-body"><a class="markers-command hvr-sweep-to-right" ng-repeat="item in vm.optPatientLayouts" ng-click="vm.optPatientLayout=item">{{item.name}}</a></div></div>'),e.put("app/components/pathways/pathways.html",'<os-tray content="tray-content-block" change="vm.resize($event)"><section class="tray-content"><div class="row"><div class="col-xs-12 form-label"><h2>Options</h2></div><div class="col-xs-12 form-item"><label>Search</label> <input type="text" class="form-control" ng-model="vm.search"></div><div class="col-xs-12 form-label"><h2>Legend</h2><span class="legend-bar" style="border-color: green">Activation</span> <span class="legend-bar" style="border-color: red">Inhibition</span> <span class="legend-bar" style="border-color: #38347B">Modification</span> <span class="legend-bar" style="border-color: #056ce1">Genes</span></div></div></section></os-tray><section class="tray-content-block" style="padding-right:0px;"><div id="pathways-chart" class="pathways-chart"></div><div style="position:absolute;top:10px;text-align:center;width:100%;"><h2 class="h2-tool">Survival Curve</h2><span class="h3-tool">{{vm.datasource.source}} {{vm.datasource.name}}</span></div></section><div class="modal fade pathways" id="gbm-webpage" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="myModalLabel">{{vm.tip}}</h4></div><iframe class="modal-iframe" ng-src="{{vm.frame}}"></iframe></div></div></div>'),
e.put("app/components/pca/pca.html",'<os-tray content="tray-content-block" change="vm.resize($event)"><section class="tray-content"><div class="row"><div class="col-xs-12 form-label"><h2>Filters</h2></div><div class="col-xs-12 form-item"><label>Gene Set</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.geneSet.geneset}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li ng-repeat="item in vm.geneSets" ng-click="vm.geneSet=item">{{item.geneset}}</li></ul></div></div><div class="col-xs-6 form-label"><h2>Legend</h2><span class="circle" style="background-color:black;width:10px;height: 10px;margin-right:10px;"></span>Patients</div><div class="col-xs-6 form-label"><h2>Variance</h2>PC1: {{vm.pc1}}%<br>PC2: {{vm.pc2}}%</div></div></section></os-tray><section class="tray-content-block"><div style="position:absolute;top:10px;text-align:center;width:100%;"><h2 class="h2-tool">Principal Component Analysis</h2><span class="h3-tool">{{vm.datasource.source}} {{vm.datasource.name}}</span><div id="pca-chart" class="pca"></div></div></section>'),e.put("app/components/plsr/plsr.html",'<os-tool-menu datasource="{{vm.datasource}}" change="vm.addCohortGene()"></os-tool-menu><os-tray content="tray-content-block" change="vm.resize($event)"><section class="tray-content"><div class="row"><div class="col-xs-12 form-label"><h2>Filters</h2></div><div class="col-xs-12 form-item"><label>Gene Set</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.geneSet}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li ng-repeat="item in vm.geneSets" ng-click="vm.geneSet=item">{{item}}</li></ul></div></div><div class="col-xs-12 form-item"><label>Age At Diagnosis</label><div range-slider="" min="vm.deathMinValue" model-min="vm.deathMinFilter" max="vm.deathMaxValue" model-max="vm.deathMaxFilter" prevent-equal-min-max="true" show-values="true" attach-handle-values="true" on-handle-up="vm.update()"></div></div><div class="col-xs-12 form-item"><label>Survival</label><div range-slider="" min="vm.survivalMinValue" model-min="vm.survivalMinFilter" max="vm.survivalMaxValue" model-max="vm.survivalMaxFilter" prevent-equal-min-max="" show-values="true" attach-handle-values="true" on-handle-up="vm.update()"></div></div><div class="col-xs-12 form-label"><h2>Legend</h2><span class="legend-bar" style="border-color: #1396de">Age At Diagnosis</span> <span class="legend-bar" style="border-color: #38347b">Survial</span> <span class="legend"><span class="legend-dot" style="background-color:#000"></span>Genes</span></div></div></section></os-tray><section class="tray-content-block"><div class="container-fluid"><h2 class="h2-tool">Partial Least Squares Regression</h2><h3 class="h3-datasource">{{vm.datasource}}</h3><div id="plsr-chart" class="plsr"></div></div></section><div class="modal fade plsr-webpage" id="plsr-webpage" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="myModalLabel">{{vm.tip}}</h4></div><iframe class="modal-iframe" ng-src="{{vm.frame}}"></iframe></div></div></div>'),e.put("app/components/survival/survival.html",'<os-tray content="tray-content-block" change="vm.resize($event)"><section class="tray-content"><div class="row"><div class="col-xs-12 form-item"><br><label>Cohorts</label><div class="legend-bar" style="border-color:#000;position:relative;background-color:#FFF;padding:2px 10px;line-height:25px;">All Patients <label class="switch {{item.class}}" style="float:right"><input type="checkbox" class="switch-input" ng-model="vm.all.show" ng-change="vm.toggle()"> <span class="switch-label" data-on="On" data-off="Off"></span> <span class="switch-handle"></span></label></div><div ng-repeat="cohort in vm.cohorts track by $index" class="legend-bar" style="border-color:{{cohort.color}};position:relative;background-color:#FFF;padding:2px 10px;line-height:25px;">{{cohort.name}} <label class="switch {{item.class}}" style="float:right"><input type="checkbox" class="switch-input" ng-model="cohort.show" ng-change="vm.toggle()"> <span class="switch-label" data-on="On" data-off="Off"></span> <span class="switch-handle"></span></label></div></div></div></section></os-tray><section class="tray-content-block"><div style="position:absolute;top:10px;text-align:center;width:100%;"><h2 class="h2-tool">Survival Curve</h2><span class="h3-tool">{{vm.datasource.source}} {{vm.datasource.name}}</span><div id="survival-chart"></div></div></section>'),e.put("app/components/timelines/timelines.html",'<os-tool-menu datasource="{{vm.datasource}}" change="vm.addCohortPatient()"></os-tool-menu><os-tray content="tray-content-block" change="vm.resize($event)"><section class="tray-content"><div class="row"><div class="col-xs-12 form-label"><h2>Options</h2></div><div class="col-xs-12 form-item"><label>Align By</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.align.name}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1" style="width:100%"><li ng-repeat="item in vm.events" ng-click="vm.align = item">{{item.name}}</li></ul></div></div><div class="col-xs-12 form-item"><label>Order By</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.sort.name}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1" style="width:100%"><li ng-repeat="item in vm.features" ng-click="vm.sort = item">{{item.name}}</li></ul></div></div><div class="col-xs-12 form-item"><label>Filter</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.filter.name}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1" style="width:100%"><li ng-repeat="item in vm.filters" ng-click="vm.filter = item">{{item.name}}</li></ul></div></div><div class="col-xs-12 form-item"><label>Timescale</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.timescale.name}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1" style="width:100%"><li ng-repeat="item in vm.timescales" ng-click="vm.timescale=item">{{item.name}}</li></ul></div></div><div class="col-xs-12 form-item"><label>Event Colors</label> <span ng-repeat="item in vm.events" class="legend-bar btn btn-default filter-button {{item.color}}" ng-style="{\'border-color\':item.color}" ng-click="vm.updateEventColor(item); $event.stopPropagation();">{{item.name}} ({{item.selected ? \'Visible\' : \'Hidden\'}})</span></div><div class="col-xs-12 form-item"><label>Selected Patients Display</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.optCohortMode.name}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1" style="width:100%"><li ng-repeat="item in vm.optCohortModes" ng-click="vm.optCohortMode=item">{{item.name}}</li></ul></div></div></div></section></os-tray><section class="tray-content-block"><div class="container-fluid"><h2 class="h2-tool">Timelines</h2><h3 class="h3-datasource">{{vm.datasource}}</h3><div id="timelines-chart"></div></div><div class="timeline-hover" ng-if="vm.selShow"><dl><dt>Event</dt><dd>{{vm.selEvent}}</dd></dl><dl><dt>Patient Id</dt><dd>{{vm.selPatient}}</dd></dl><dl ng-repeat="item in vm.selFields"><dt>{{item.name}}</dt><dd>{{item.value}}</dd></dl></div></section>'),e.put("app/components/tools/tools.html",'<section class="tools container-fluid"><div class="row"><div class="col-sm-8 col-md-6"><h1>Analysis Tools</h1></div></div><div class="row"><ul><li ng-repeat="tool in vm.tools" class="col-xs-12 col-sm-6 col-md-4 col-lg-3" ng-click="vm.explore(tool.route)"><img class="tools-img" ng-src="/assets/images/datasets/{{tool.img}}"><div class="tools-copy"><h3 class="tools-lbl">{{tool.name}}</h3><a href="">Explore</a></div></li></ul></div></section>'),e.put("app/components/tray/tray.html",'<div><label class="tray-label tray-label-right">Options</label><div class="tray {{vm.trayClass}} tray-right" locked="true"><ng-transclude></ng-transclude><i class="fa fa-lock tray-sticky-icon {{vm.iconClass}}" ng-click="vm.toggle()"></i></div></div>')}]);
//# sourceMappingURL=../maps/scripts/app-90eb8c0f81.js.map
