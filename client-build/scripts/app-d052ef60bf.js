!function(){"use strict";angular.module("oncoscape",["ngAnimate","ngCookies","ngTouch","ngSanitize","ngMessages","ngAria","ngResource","ui.router","ui.bootstrap","ui-rangeSlider","toastr"])}(),function(){"use strict";function e(){function e(e,t){var a=this;a.trayClass=Math.random().toString(36).substring(3),a.iconClass=Math.random().toString(36).substring(3);var n=!0;a.toggle=function(){var i=angular.element("."+a.trayClass),s=angular.element("."+a.iconClass);n=!n,s.addClass(n?"glyphicon-menu-hamburger":"glyphicon-remove").removeClass(n?"glyphicon-remove":"glyphicon-menu-hamburger"),i.attr("locked",n?"true":"false"),n?(i.unbind("mouseover",o).unbind("mouseout",r).removeClass("tray-collapsed"),t(function(){a.change()})):(i.addClass("tray-collapsed").bind("mouseover",o).bind("mouseout",r),t(function(){a.change()})),e.onResize.dispatch()};var o=function(){angular.element("."+a.trayClass).removeClass("tray-collapsed")},r=function(){angular.element("."+a.trayClass).addClass("tray-collapsed")}}e.$inject=["osApi","$timeout"];var t={restrict:"E",templateUrl:"app/components/tray/tray.html",scope:{caption:"@",content:"@",change:"&"},controller:e,controllerAs:"vm",bindToController:!0,replace:!0,transclude:!0};return t}angular.module("oncoscape").directive("osTray",e)}(),function(){"use strict";function e(){function e(e,t){var a=this;e.query("lookup_oncoscape_tools").then(function(e){a.tools=e.data.sort(function(e,t){return e.name<t.name?-1:e.name>t.name?1:0})}),a.explore=function(a){t.go(a,{datasource:e.getDataSource().disease})}}e.$inject=["osApi","$state"];var t={restrict:"E",templateUrl:"app/components/tools/tools.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osTools",e)}(),function(){"use strict";function e(){function e(e,t,a,n,o,r,i,s,l,c){function d(){c.debounce(B.update,300)}e.setBusy(!0);var u,p,m,h,g,v,f=[],b=[],y=[],w=20,x=1,A=1,C=l.brushY(),_=l.brushX(),k=l.brushY(),S=t.getPatientCohort();null==S&&t.setPatientCohort([],"All Patients");var P=null==S?[]:S.ids,M=function(e){P=e.ids,B.update()};t.onPatientsSelect.add(M);var B=function(t){return t.timescales=[{name:"Log",valFn:function(e){return(0>e?-1:1)*Math.log(Math.abs(1e3*e/864e5)+1)/Math.log(2)}},{name:"Linear",valFn:function(e){return s.duration(1e3*e).asDays()}}],t.timescale=t.timescales[0],t.filters=[{name:"Alive + Dead"},{name:"Only Alive"},{name:"Only Dead"}],t.filter=t.filters[2],t.modes=[{name:"Highlight"},{name:"Filter"}],t.mode=t.modes[0],t.displayModes=[{name:"Selected Patients"},{name:"All Patients"}],t.displayMode=t.displayModes[0],t.datasource=e.getDataSource(),t}(this);B.resetZoom=function(){P=[],t.setPatientCohort([],"All Patients"),F.d3ScrollY.call(C.move,null),F.d3ScrollX.call(C.move,null),B.update()};var F=function(e,t){var a=null,n=t.select(".timelines-content"),o=n.append("svg");o.attr("class","timeline-chart");var r=n.append("svg");r.attr("class","timeline-scroll-y");var i=n.append("svg");i.attr("class","timeline-scroll-x");var s=o.append("g");s.attr("class","timeline-patients-hitarea");var l=o.append("g"),c=o.append("rect");c.attr("class","timeline-axis-bg");var d=o.append("g");return{elChart:e.element(".timelines-content"),elTip:a,d3Chart:o,d3ScrollY:r,d3ScrollX:i,gPatients:l,rPatients:s,gAxis:d,rAxis:c}}(angular,l),D=function(){var e=B.align.name,t=B.sort.name,a=B.filter.name,n=B.events.filter(function(e){return e.selected}).map(function(e){return e.name.toLowerCase()});b=f,y=[1/0,-(1/0)],b.forEach(function(e){if(e.hash.hasOwnProperty(this.align)&&e.hash.hasOwnProperty(this.sort)&&e.hash.hasOwnProperty("Status")){var t=e.hash.Status.data.status;"Only Alive"==this.filter&&"Dead"==t||"Only Dead"==this.filter&&"Dead"!=t?e.visible=!1:("Selected Patients"==B.displayMode.name&&P.length>0?e.visible=-1!=P.indexOf(e.id):e.visible=!0,e.visible&&(this.offset=0-e.hash[this.align].tsStart,e.events.forEach(function(e){e.visible=-1!=this.events.indexOf(e.name.toLowerCase()),e.visible&&(e.tsStartAligned=B.timescale.valFn(e.tsStart+this.offset),e.tsEndAligned=B.timescale.valFn(e.tsEnd+this.offset),this.domain[0]=Math.min(this.domain[0],e.tsStartAligned),this.domain[1]=Math.max(this.domain[1],e.tsEndAligned))},this)))}else e.visible=!1},{align:e,sort:t,filter:a,events:n,domain:y,offset:0}),b=b.filter(function(e){return e.visible}),b.forEach(function(e){e.selected=-1!=P.indexOf(e.id)}),b=b.sort(function(e,a){return e.status==a.status?(e=e.hash[t].tsStartAligned,a=a.hash[t].tsStartAligned,e>a?1:a>e?-1:0):"dead"==e.status?1:-1})},E=function(e,a){e-=70,a-=20,u=l.scaleLinear().domain(y).range([0,a]).nice(),F.gPatients.selectAll("*").remove();var n=F.gPatients.selectAll("g.patient").data(b);n.exit().transition().delay(200).duration(500).style("opacity",0).remove();var o=n.enter().append("g");o.attr("class","patient"),o.attr("transform",function(e,t){return"translate(0,"+t*w+")"});var r=o.selectAll("rect").data(function(e){return e.events.filter(function(e){return e.visible})});r.exit().remove(),r.enter().append("rect").attr("class","event").attr("width",function(e){return Math.max(u(e.tsEndAligned)-u(e.tsStartAligned),3)}).attr("height",function(e){return"Radiation"==e.name||"Drug"==e.name?w/2:w}).attr("y",function(e){return"Radiation"==e.name?w/2:0}).attr("x",function(e){return u(e.tsStartAligned)}).style("fill",function(e){return e.color}).on("mouseover",function(){var e=l.select(this).datum();if(null==e.html){var t=e.data;e.html=Object.keys(t).reduce(function(e,t){return e.html+="<li>"+t+":"+e.data[t]+"</li>",e},{html:"<b>"+e.name+"</b>",data:t}).html}null==F.elTip&&(F.elTip=angular.element("#timelines-tip")),F.elTip.html(e.html)}).on("mouseout",function(){F.elTip.html("<b>Rollover Event For Details</b>")}),r.attr("width",function(e){return Math.max(u(e.tsEndAligned)-u(e.tsStartAligned),2)}).attr("height",function(e){return"Radiation"==e.name||"Drug"==e.name?w/2:w}).attr("y",function(e){return"Radiation"==e.name?w/2:0}).attr("x",function(e){return u(e.tsStartAligned)}).style("fill",function(e){return e.color}),F.rPatients.call(k),k.on("end",function(){if(null!=l.event.selection){for(var e=Math.floor(l.event.selection[0]/m/20),a=Math.ceil(l.event.selection[1]/m/20),n=[],o=e;a>=o;o++)n.push(b[o].id);t.setPatientCohort(n,"All Patients"),F.rPatients.call(l.event.target.move,null)}})},T=function(e){e-=70,A=e/(b.length*w),x=1,p=x,m=A,h=0,g=0,F.gPatients.attr("transform","translate("+h+","+g+") scale("+p+","+m+")")},$=function(e,t,a){e-=70,t-=20,F.elChart.css("margin-left",a.left+20).css("margin-right",a.right+20).css("width",t).css("height",e+70),F.d3ScrollY.attr("height",e),F.d3ScrollX.attr("width",t),F.d3Chart.attr("height",e+70).attr("width",t),F.rPatients.attr("height",e+70).attr("width",t),F.gAxis.attr("transform",function(){return"translate(0,"+e+")"}),F.rAxis.attr("transform",function(){return"translate(0,"+e+")"}).attr("width",t).attr("fill","#FFF")},z=function(e){return 0==Math.abs(e)?e:Math.abs(e)<30?e+" Days":Math.abs(e)<360?Math.round(e/30.4*10)/10+" Months":Math.round(e/365*10)/10+" Years"},L=function(){v=l.axisBottom(u).ticks(7),"Linear"==B.timescale.name?v.tickFormat(function(e){return z(e)}):v.tickFormat(function(e){return z(Math.round((0>e?-1:1)*(Math.pow(2,Math.abs(e))-1)*100)/100)}),F.gAxis.call(v)},O=function(e,t){F.d3ScrollY.call(C.on("end",function(){if(null!=l.event.selection){var t=l.event.selection[0],a=l.event.selection[1],n=e-70,o=t/n,r=a/n,i=r-o;m=A/i,g=20*b.length*m*-o}else{if(m==A&&0==g)return;m=A,g=0,F.d3ScrollY.call(C.move,null)}F.gPatients.transition().duration(750).attr("transform","translate("+h+","+g+") scale("+p+","+m+")")})),F.d3ScrollX.call(_.on("end",function(){if(null!=l.event.selection){var e=l.event.selection[0],a=l.event.selection[1],n=t-20,o=e/n,r=a/n,i=r-o;p=x/i,h=t*p*-o}else{if(p==x&&0==h)return;p=x,h=0,F.d3ScrollX.call(_.move,null)}F.gPatients.transition().duration(750).attr("transform","translate("+h+","+g+") scale("+p+","+m+")");var s=l.zoomIdentity.translate(h).scale(p).rescaleX(u),c=l.axisBottom(s).ticks(7);"Linear"==B.timescale.name?c.tickFormat(function(e){return z(e)}):c.tickFormat(function(e){return z(Math.round((0>e?-1:1)*(Math.pow(2,Math.abs(e))-1)*100)/100)}),F.gAxis.call(c)}))};B.update=function(){var t=e.getLayout(),a=r.innerHeight-180,n=r.innerWidth-t.left-t.right-40;D(),$(a,n,t),O(a,n),E(a,n),T(a,n),L(a,n)},e.onResize.add(B.update),angular.element(r).bind("resize",d),e.setBusy(!0),e.query(e.getDataSource().clinical.events,{}).then(function(t){var a=function(e){return"Birth"==e?"#E91E63":"Diagnosis"==e?"#673AB7":"Pathology"==e?"#2196F3":"Progression"==e?"#00BCD4":"Absent"==e?"#CDDC39":"Status"==e?"#FFC107":"Radiation"==e?"#FF5722":"Procedure"==e?"#795548":"Encounter"==e?"#607D8B":"Drug"==e?"#03A9F4":"black"},n=t.data[0],o={};n=Object.keys(n).map(function(e){var t=this.data[e].filter(function(e){return null!=e.start}).map(function(e){return this.events[e.name]=null,e.tsStart=s(e.start,"MM/DD/YYYY").unix(),e.tsEnd=null==e.end?e.tsStart:s(e.end,"MM/DD/YYYY").unix(),e.tsStartAligned="",e.tsEndAligned="",e.end=null==e.end?e.start:e.end,e.color=this.colorFn(e.name),e.visible=!0,e},{events:this.events,colorFn:this.colorFn}),a=t.reduce(function(e,t){return e[t.name]=t,e},{});return{id:e,events:t,hash:a}},{data:n,events:o,colorFn:a}),f=n.filter(function(e){try{return e.status=e.hash.Status.data.status.toLowerCase(),!0}catch(t){return!1}return!1}),B.events=Object.keys(o).map(function(e){return{name:e,selected:-1==["Birth","Drug","Pathology","Absent","Procedure"].indexOf(e),color:this(e)}},a),B.align=B.events.filter(function(e){return"Diagnosis"==e.name?!0:void 0})[0],B.sort=B.events.filter(function(e){return"Status"==e.name?!0:void 0})[0],B.update(),e.setBusy(!1)}),n.$on("$destroy",function(){t.onPatientsSelect.remove(M),e.onResize.remove(B.update),angular.element(r).unbind("resize",d),C.on("end",null),_.on("end",null)})}e.$inject=["osApi","osCohortService","$state","$scope","$stateParams","$window","$document","moment","d3","_"];var t={restrict:"E",templateUrl:"app/components/timelines/timelines.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osTimelines",e)}(),function(){"use strict";function e(){function e(e,t,a,n,o,r,i,s,l){var c=a.getPatientCohort(),d=JSON.parse(JSON.stringify(a.getPatientCohorts()));null==c?a.setPatientCohort([],"All Patients"):c.ids.length>0&&d.push({id:"Last Selection",ids:c.ids,name:"Last Selection",time:new Date}),t.setBusy(!0);var u=this;u.datasource=t.getDataSource(),u.cohorts=d,u.all={show:!0,color:"#000"};for(var p=["#E91E63","#673AB7","#2196F3","#00BCD4","#4CAF50","#CDDC39","#FFC107","#FF5722","#795548","#607D8B","#03A9F4","#03A9F4"],m=0;m<u.cohorts.length;m++)u.cohorts[m].show=!0,u.cohorts[m].color=p[m];u.toggle=function(){a.getSurvivalData(u.cohorts.filter(function(e){return e.show}),u.all.show,"SurvivalController")};var h=e.select("#survival-chart").append("svg"),g=h.append("g").attr("class","axis"),v=h.append("g").attr("class","axis"),f={},b={width:0,height:0,xScale:null,yScale:null,xAxis:e.axisBottom().ticks(5),yAxis:e.axisLeft().ticks(5)},y=function(a){var n=t.getLayout();b.width=s.innerWidth-n.left-n.right-60,b.height=s.innerHeight-160,angular.element("#survival-chart").css("margin-left",n.left+20),h.attr("width","100%").attr("height",b.height),b.xScale=e.scaleLinear().domain(a).range([50,b.width]),b.yScale=e.scaleLinear().domain([0,100]).range([b.height-50,0]),b.xAxis.scale(b.xScale),b.yAxis.scale(b.yScale),v.attr("transform","translate(50, 10)").call(b.yAxis),g.attr("transform","translate(0, "+(b.yScale(0)+10)+")").call(b.xAxis)},w=function(e){"getSurvivalData"==e.data.cmd&&"SurvivalController"==e.data.data.correlationId&&(f=e.data.data,A())};a.onMessage.add(w);var x=function(t){var a=e.line().x(function(e){return b.xScale(e[0])}).y(function(e){return b.yScale(e[2])+10});h.append("path").attr("class","line").attr("stroke-width",1.5).attr("stroke",t.color).attr("fill","none").attr("d",a(t.data.line)).on("mouseover",function(){e.select(this).attr("stroke-width",3)}).on("mouseout",function(){e.select(this).attr("stroke-width",1)});for(var n=0;n<t.data.tick.length;n++)h.append("line").attr("class","line").attr("stroke-width",.5).attr("stroke",t.color).attr("x1",b.xScale(t.data.tick[n][0])).attr("x2",b.xScale(t.data.tick[n][0])).attr("y1",b.yScale(t.data.tick[n][2])+5).attr("y2",b.yScale(t.data.tick[n][2])+10)},A=function(){h.selectAll(".line").remove(),y([f.min,f.max]);for(var e=0;e<f.cohorts.length;e++)x(f.cohorts[e]);t.setBusy(!1)};t.onResize.add(A),angular.element(s).bind("resize",l.debounce(A,300)),r.$on("$destroy",function(){a.onMessage.remove(w)}),u.toggle()}e.$inject=["d3","osApi","osCohortService","$state","$timeout","$scope","$stateParams","$window","_"];var t={restrict:"E",templateUrl:"app/components/survival/survival.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osSurvival",e)}(),function(){"use strict";function e(){function e(e,t,a,n,o,r,i,s,l){var c,d=this;d.patients=[],d.patient=null,d.datasource=t.getDataSource(),d.charts=[];var u=function(e){var t=["#F44336","#E91E63","#9C27B0","#673AB7","#3F51B5","#2196F3","#0277BD","#00BCD4","#009688","#4CAF50","#8BC34A","#CDDC39","#FFEB3B","#FFC107","#FF9800","#FF5722","#795548","#C51162","#B388FF"],a=e.reduce(function(e,t){return a=t.groups.reduce(function(e,t){return l.union(e,t.tags)},[]),l.union(e,a)},[]);t.length=a.length;var n=l.object(a,t);return n.Tumor="#FEFEFE",n.Normal="#EAEAEA",n};t.setBusy(!0),t.query("biomarker_immune_tree").then(function(e){t.setBusy(!1),c=u(e.data[0].barcharts),e.data.forEach(function(e){e.barcharts.forEach(function(e){e.groups.forEach(function(e){e.show=!0,e.tags=e.tags.map(function(e){return{name:e,color:c[e]}})})})}),d.patients=e.data,d.patient=d.patients[0],d.draw()}),d.draw=function(){p.draw(d,c),m.draw(d,c)};var p=function(){var a,n,o,r,i,l,c,d,u,p,m=e.scaleOrdinal(e.schemeCategory20),h=(e.format(",d"),e.select("#sunburst-chart").append("div").attr("class","tooltip").style("opacity",0)),g=e.select(window),v=function(e){l=e,c=l.append("text").text("Tumor"),d=l.append("text").text("Normal"),u=l.append("g"),p=l.append("g")},f=function(t){h.style("top",e.event.layerY+10+"px").style("left",e.event.layerX+10+"px")},b=function(t){h.html(t.data.name).style("opacity",1).style("top",e.event.layerY+10+"px").style("left",e.event.layerX+10+"px"),g.on("mousemove",f).on("mouseup",null)},y=function(e){h.html(e.data.Name).style("opacity",0)},w=function(t){for(var i=t;i.parent;)i=i.parent;var s="Normal"==i.data.name?u:p;s.transition().duration(750).tween("scale",function(){var a=e.interpolate(o.domain(),[t.x0,t.x1]),i=e.interpolate(r.domain(),[t.y0,1]),s=e.interpolate(r.range(),[t.y0?20:0,n]);return function(e){o.domain(a(e)),r.domain(i(e)).range(s(e))}}).selectAll("path").attrTween("d",function(e){return function(){return a(e)}})},x=function(t,n,o,r){var i=e.partition(),s=e.hierarchy(t);s.sum(function(e){return e.size});var l=i(s).descendants(),c=n.selectAll("path").data(l).enter().append("g");c.append("path").attr("d",a).style("fill",function(e){return m((e.children?e:e.parent).data.name)}).style("stroke","#FFF").style("stroke-width","2").on("click",w).on("mouseover",b).on("mouseout",y)},A=function(m){i=m.patient;var h=t.getLayout(),g=s.innerHeight-180,v=s.innerWidth-h.left-h.right;n=Math.min(.5*v,g-200)/2-10,o=e.scaleLinear().range([0,2*Math.PI]),r=e.scaleSqrt().range([0,n]),a=e.arc().startAngle(function(e){return Math.max(0,Math.min(2*Math.PI,o(e.x0)))}).endAngle(function(e){return Math.max(0,Math.min(2*Math.PI,o(e.x1)))}).innerRadius(function(e){return Math.max(0,r(e.y0))}).outerRadius(function(e){return Math.max(0,r(e.y1))}),l.attr("width",v).attr("height",g),d.attr("transform","translate("+(n+10)+",20)"),c.attr("transform","translate("+(v-n-10)+",20)"),u.attr("transform","translate("+(n+10)+","+n+")"),p.attr("transform","translate("+(v-n-10)+","+n+")"),x(i.tumor,p,o,r),x(i.normal,u,o,r)};return{init:v,draw:A}}(),m=function(){var a,n,o,r,i,c=function(e,t){a=e,n=a.append("g"),i=t},d=function(e){var a=t.getLayout(),n=s.innerWidth-a.left-a.right-40,o=Math.floor(n/e.length),r=200,i=Math.min(.5*(s.innerWidth-a.left-a.right),s.innerHeight-50-200)-10,l=20;return{layout:a,widthTotal:n,widthChart:o,heightChart:r,yChart:i,xChart:l,numCharts:e.length}},u=function(e,t){function a(){return l.reduce(arguments,function(e,t){return l.flatten(l.map(e,function(e){return l.map(t,function(t){return e.concat([t])})}),!0)},[[]])}return e.map(function(e){var n=a.apply(this,e.groups.filter(function(e){return e.show}).map(function(e){return e.tags.map(function(e){return e.name})})).map(function(e){return{value:0,tags:e}});n.sort(function(e,t){for(var a=e.tags.length-1;a>=0;a--){if(e.tags[a]>t.tags[a])return 1;if(e.tags[a]<t.tags[a])return-1}return 0});e.values;n.forEach(function(t){e.values.forEach(function(e){0==l.difference(t.tags,e.tags).length&&(t.value+=e.data)})});var o=n.reduce(function(e,a){var n=e;return a.tags.reverse().forEach(function(e,a){var o=n.children.map(function(e){return e.name}).indexOf(e.name);-1==o?(n.children.push({name:e,children:[],value:1,color:t[e]}),n=n.children[n.children.length-1]):(n=n.children[o],n.value+=1)}),a.tags.reverse(),e},{name:e.name,children:[],value:n.length,color:"#DDD"});return{bars:n,tree:o}})},p=function(t){var a=e.select(this);a.append("rect").style("fill","#EEE").attr("width",o.widthChart-5).attr("height",o.heightChart),a.append("text").text(t.tree.name).attr("y",20).attr("x",Math.round((o.widthChart-5)/2)).attr("text-anchor","middle");var n=a.selectAll(".cat-bar").data(t.bars),r=l.max(t.bars,function(e){return e.value}).value,i=l.min(t.bars,function(e){return e.value}).value,s=e.scaleLinear();s.range([0,110]),s.domain([i,r]);var c=o.widthChart/t.bars.length;console.log(c);var d=(n.enter().append("rect").attr("x",function(e,t){return c*t}).attr("y",function(e){return 140-s(e.value)}).attr("width",c).attr("height",function(e){return s(e.value)}).attr("fill",function(e){return"Normal"==e.tags[0].name?"#1476b6":"#adc7ea"}),e.hierarchy(t.tree,function(e){return e.children})),u=60*(1/d.height+1),p=e.partition().size([o.widthChart-5,u]),m=p(d).descendants(),h=a.selectAll(".cat-node").data(m);h.enter().append("rect").attr("class","cat-node").attr("x",function(e){return e.x0}).attr("y",function(e){return 200-u-(e.y0-u)}).attr("width",function(e){return e.x1-e.x0}).attr("height",function(e){return e.y1-e.y0}).attr("fill",function(e){return e.data.color}).style("visibility",function(e){return"chart"==e.data.name?"hidden":"visible"})},m=function(e,t){i.charts=e=i.patient.barcharts,o=d(e),r=u(e,t);var a=n.selectAll(".sunburst-barchart").data(r);a.enter().append("g").attr("class","sun-chart-g").attr("transform",function(e,t){return"translate("+(t*o.widthChart+o.xChart)+","+(s.innerHeight-380)+")"}),n.selectAll(".sun-chart-g").each(p)};return{init:c,draw:m}}(),h=e.select("#sunburst-chart").append("svg");p.init(h),m.init(h,d)}e.$inject=["d3","osApi","osCohortService","$state","$timeout","$scope","$stateParams","$window","_"];var t={restrict:"E",templateUrl:"app/components/sunburst/sunburst.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osSunburst",e)}(),function(){"use strict";function e(){function e(e,t,a,n,o,r,i,s,l,c,d){function u(){var e=w.selectAll(".plsr-node-selected")[0];0!=e.length&&t.addGeneSelection("PLSR","Manual Selection",w.selectAll(".plsr-node-selected")[0].map(function(e){return e.__data__.name.toUpperCase()}))}function p(){0==C.length?w.selectAll(".plsr-node-selected").classed("plsr-node-selected",!1):w.selectAll("circle").classed("plsr-node-selected",function(){return C.indexOf(this.__data__.name)>=0})}if(angular.isUndefined(n.datasource))return void a.go("datasource");var m,h,g,v,f,b,y,w=i.select("#plsr-chart").append("svg").attr("id","chart"),x=i.select("body").append("div").attr("class","tooltip plsr-tooltip"),A=this;A.datasource=n.datasource,A.deathMinFilter=A.deathMinValue=45,A.deathMaxFilter=A.deathMaxValue=66,A.survivalMinFilter=A.survivalMinValue=3,A.survivalMaxFilter=A.survivalMaxValue=7,A.geneSets=[],A.geneSet=null,A.frame,A.tip=null;var C=null==t.getGeneSelection()?[]:t.getGeneSelection().ids;e.setBusy(!0)("Loading Dataset"),e.setDataset(A.datasource).then(function(a){var n=a.payload.rownames.filter(function(e){return e.indexOf("mtx.mrna")>=0});n=n[n.length-1].replace(".RData",""),e.getPLSR(A.datasource,n).then(function(){e.getGeneSetNames().then(function(a){A.geneSets=a.payload,A.geneSet=A.geneSets[0],e.getSummarizedPLSRPatientAttributes().then(function(e){var a=e.payload;A.deathMinValue=Math.floor(a.AgeDx[0]/365.24),A.deathMaxValue=Math.floor(a.AgeDx[4]/365.24),A.survivalMinValue=Math.floor(a.Survival[0]/365.24),A.survivalMaxValue=Math.floor(a.Survival[4]/365.24),r.$watch("vm.geneSet",function(){A.update()}),t.onGeneSelectionChange.add(function(e){C=e.ids,p()})})})})}),A.update=function(){function t(){m=c.innerWidth-400,"false"==angular.element(".tray-right").attr("locked")&&(m+=300),h=c.innerHeight-190,"true"==angular.element(".tray").attr("locked")&&(m-=300),w.attr("width","100%").attr("height",h),g=i.scale.linear().domain([-f,f]).range([0,m]).nice(),v=i.scale.linear().domain([-b,b]).range([h,0]).nice()}function a(e,a,n){f=.9*e,b=.9*e,t(),y=i.svg.brush().x(g).y(v).on("brushend",function(){var e=y.extent();w.selectAll("circle").classed("plsr-node-selected",function(t){return t[0]>e[0][0]&&t[0]<e[1][0]&&t[1]>e[0][1]&&t[1]<e[1][1]}),i.select(this).transition().duration(300).call(y.extent([[0,0],[0,0]])),u()}),w.call(y);var o=w.selectAll("circle").data(n,function(e){return e});o.enter().append("circle").attr({"class":"plsr-node",cx:.5*m,cy:.5*h,r:3}).style("fill-opacity","0").on("mouseover",function(e){x.transition().duration(200).style("opacity",1),x.html(e.name).style("left",i.event.pageX+15+"px").style("top",i.event.pageY-15+"px")}).on("mouseout",function(){x.transition().duration(500).style("opacity",0)}).on("click",function(e){angular.element("#plsr-webpage").modal();var t="https://www.genecards.org/cgi-bin/carddisp.pl?gene="+e.name;r.$apply(function(){A.frame=l.trustAsResourceUrl(t)})}),o.transition().duration(750).delay(function(e,t){return t/300*500}).attr("cx",function(e){return g(e[0])}).attr("cy",function(e){return v(e[1])}).style("fill-opacity",1),o.exit().transition().duration(600).delay(function(e,t){return t/300*500}).attr("cx",.5*m).attr("cy",.5*h).style("fill-opacity","0").remove();var s=w.selectAll("line").data(a);s.enter().append("line").attr({"class":"line","stroke-width":3,x1:g(0),y1:v(0),x2:g(0),y2:v(0)}).style("stroke",function(e){return e.name.indexOf("Age")?"#1396de":"#38347b"}),s.transition().duration(900).attr({x1:g(0),y1:v(0),x2:function(e){return g(e[0])},y2:function(e){return v(e[1])}}),s.exit().remove();var c=w.selectAll("text").data(a);c.enter().append("text").attr({"class":"text",x:.5*m,y:.5*h,"text-anchor":function(e){return e[0]>0?"start":"end"}}).text(function(e){return e.name}).style({fill:"black","text-anchor":"middle"}),c.transition().duration(900).attr({x:function(e){return g(e[0])},y:function(e){return v(e[1])}}),c.exit().remove(),p()}var n=[{name:"Survival",low:365.24*Number(A.survivalMinFilter),high:365.24*Number(A.survivalMaxFilter)},{name:"AgeDx",low:365.24*Number(A.deathMinFilter),high:365.24*Number(A.deathMaxFilter)}];e.getCalculatedPLSR(A.geneSet,n).then(function(t){var n=t.payload,o=n.loadings.map(function(e,t){return e.name=this[t],e},n.loadingNames),r=n.vectors.map(function(e,t){return e.name=this[t],e},n.vectorNames),i=1.2*n.maxValue;a(i,r,o),e.setBusy(!1)}),A.resize=function(){t(),w.selectAll("circle").attr({cx:function(e){return g(e[0])},cy:function(e){return v(e[1])}}),w.selectAll("text").attr({x:function(e){return g(e[0])},y:function(e){return v(e[1])}}),w.selectAll("line").attr({x1:g(0),y1:v(0),x2:function(e){return g(e[0])},y2:function(e){return v(e[1])}})},angular.element(c).bind("resize",d.debounce(A.resize,300))}}e.$inject=["osApi","osHistory","$state","$stateParams","$timeout","$scope","d3","moment","$sce","$window","_"];var t={restrict:"E",templateUrl:"app/components/plsr/plsr.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osPlsr",e)}(),function(){"use strict";function e(){function e(e,t,a,n,o,r,i,s,l,c,d){function u(){0==g.length?S.selectAll(".pca-node-selected").classed("pca-node-selected",!1):S.selectAll("circle").classed("pca-node-selected",function(){return g.indexOf(this.__data__.id)>=0})}function p(){if(D.legendCaption=F.name,D.legendNodes=F.data,"None"==F.name)D.legendCaption="",x.forEach(function(e){e.color="#0096d5"});else{var e=F.data.reduce(function(e,t){for(var a=0;a<t.values.length;a++)e[t.values[a]]=t.color;return e},{});x=x.map(function(e){return e.color=void 0!=this[e.id]?this[e.id]:"#DDD",e},e)}}function m(){p();var e=t.getLayout();C=c.innerWidth-e.left-e.right,_=c.innerHeight-120,angular.element("#pca-chart").css({width:C+"px","padding-left":e.left+"px"}),k.attr("width",C).attr("height",_),B.attr("width",C).attr("height",_),S.attr("width",C).attr("height",_),f=s.scaleLinear().domain([A.xMin,A.xMax]).range([50,C-50]).nice(),b=s.scaleLinear().domain([A.yMin,A.yMax]).range([50,_-50]).nice();var n=S.selectAll("circle").data(x);n.enter().append("svg:circle").attr("class","pca-node").attr("cx",function(e){return f(e[0])}).attr("cy",function(e){return b(e[1])}).style("fill",function(e){return e.color}),n.exit().transition().duration(200).delay(function(e,t){return t/300*100}).style("fill-opacity","0").remove(),n.style("fill",function(e){return e.color}).transition().duration(750).delay(function(e,t){return t/300*100}).attr("cx",function(e){return f(e[0])}).attr("cy",function(e){return b(e[1])}).style("fill",function(e){return e.color}).style("fill-opacity",.8),y=s.axisTop().scale(f).ticks(5),w=s.axisLeft().scale(b).ticks(5),P.attr("class","axis").attr("transform","translate(0, "+b(0)+")").call(y).append("text").attr("x",50).attr("y",15).text("PC1"),M.attr("class","axis").attr("transform","translate("+f(0)+", 0)").call(w).append("text").attr("y",55).attr("x",25).text("PC2");var o=s.brush().on("end",function(){if(!s.event.selection)return void a.setPatientCohort([],"PCA");var e=s.event.selection,t=e[0][0],n=e[1][0],o=e[0][1],r=e[1][1],i=S.selectAll("circle").data().filter(function(e){var a=f(e[0]),i=b(e[1]);return a>t&&n>a&&i>o&&r>i}).map(function(e){return e.id});a.setPatientCohort(i,"PCA")});B.attr("class","brush").call(o),u()}var h=a.getPatientCohort();null==h&&a.setPatientCohort([],"All Patients");var g=null==h?[]:h.ids,v=!0;a.onPatientsSelect.add(function(e){v?(g=e.ids,u()):v=!0});var f,b,y,w,x,A,C,_,k=s.select("#pca-chart").append("svg"),S=k.append("g"),P=k.append("g"),M=k.append("g"),B=k.append("g"),F={data:[],dataset:t.getDataSource().disease,name:"None",type:"color"},D=function(e,t){return e.datasource=t.getDataSource(),e.geneSets=[],e.geneSet=null,e.search="",t.query("render_pca",{disease:e.datasource.disease,$fields:["type","geneset","source"]}).then(function(t){var a=t.data.reduce(function(e,t){return e.hasOwnProperty(t.geneset)||(e[t.geneset]=[]),e[t.geneset].push({name:t.type,source:t.source,label:(t.type+"-"+t.source).toUpperCase().replace(/-/gi," - ")}),e},{});e.geneSets=Object.keys(a).reduce(function(e,t){return e.rv.push({name:t,types:e.values[t],label:t.toUpperCase()}),e},{rv:[],values:a}).rv.sort(function(e,t){return e.label>t.label}),e.geneSet=e.geneSets[0]}),e}(this,t);i.$watch("vm.geneSet",function(){null!=D.geneSet&&(D.pcaTypes=D.geneSet.types.sort(function(e,t){return e.name!=t.name?e.name>t.name:e.source<t.source}),D.pcaType=D.pcaTypes[0])}),i.$watch("vm.pcaType",function(e){null!=e&&t.query("render_pca",{disease:D.datasource.disease,geneset:D.geneSet.name,type:D.pcaType.name,source:D.pcaType.source}).then(function(e){D.pc1=e.data[0].pc1,D.pc2=e.data[0].pc2;var t=Object.keys(e.data[0].data);x=t.map(function(e){return this.data[e].id=e,this.data[e]},{data:e.data[0].data}),A=x.reduce(function(e,t){return e.xMin=Math.min(e.xMin,t[0]),e.xMax=Math.max(e.xMax,t[0]),e.yMin=Math.min(e.yMin,t[1]),e.yMax=Math.max(e.yMax,t[1]),e},{xMin:1/0,yMin:1/0,xMax:-(1/0),yMax:-(1/0)}),A.xMax=Math.max(Math.abs(A.xMin),A.xMax),A.xMin=-A.xMax,A.yMax=Math.max(Math.abs(A.yMin),A.yMax),A.yMin=-A.yMax,m()})}),t.onResize.add(m),angular.element(c).bind("resize",d.debounce(m,300));var E=function(e){F=e,D.showPanelColor=!1,m()};a.onPatientColorChange.add(E),i.$on("$destroy",function(){a.onPatientColorChange.remove(E)})}e.$inject=["$q","osApi","osCohortService","$state","$stateParams","$timeout","$scope","d3","moment","$window","_"];var t={restrict:"E",templateUrl:"app/components/pca/pca.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osPca",e)}(),function(){"use strict";function e(){function e(e,t,a,n,o,r,i,s,l,c){function d(){var e="rgb(5, 108, 225)",t="red",a="rgb(56, 52,123)",n="green";return[{selector:"node",style:{content:"data(label)","text-valign":"center","text-halign":"center",shape:"ellipse",width:"60px",height:"50px",color:e,"background-color":"rgb(250, 250, 250)","border-width":"2px","border-color":e}},{selector:"edge",style:{width:"2px","line-color":e,"line-style":"solid"}},{selector:'node[nodeType="class"], node[nodeType="family"], node[nodeType="complex"]',style:{content:"","background-color":"white",shape:"roundrectangle"}},{selector:'edge[edgeType="activates"], edge[edgeType="indirectly activates"]',style:{"line-color":n,"target-arrow-shape":"triangle","target-arrow-color":n}},{selector:'edge[edgeType="inhibits"], edge[edgeType="ubiquitinylates"]',style:{"line-color":t,"target-arrow-shape":"tee","target-arrow-color":t}},{selector:'edge[edgeType="fusion"]',style:{"line-color":n}},{selector:'edge[edgeType="contains"]',style:{display:"none"}},{selector:'node[nodeType="process"]',style:{}},{selector:'node[nodeType="gene"]:selected',style:{"overlay-opacity":"0.5","overlay-color":"red"}},{selector:'node[nodeType="rtk"]',style:{content:"data(label)","background-color":"rgb(224, 209, 178)","border-color":"black","border-width":"0px","font-size":"48px",shape:"roundrectangle",width:"40px",height:"160px"}},{selector:'node[nodeType="kinase"]',style:{content:"data(label)","background-color":"rgb(255, 206, 194)",shape:"ellipse",width:"160px",height:"120px","font-size":"48px","border-color":"black","border-width":"1px"}},{selector:'node[nodeType="dimer"]',style:{content:"","background-color":"rgb(234, 219, 188)",shape:"ellipse",width:"160px",height:"120px","font-size":"48px","border-color":"black","border-width":"0px"}},{selector:'node[nodeType="loop"]',style:{content:"","background-color":"rgb(255, 255, 255)",shape:"ellipse",width:"160px",height:"120px","font-size":"48px","border-color":"black","border-width":"1px","border-style":"dotted"}},{selector:'node[nodeType="gtpase"]',style:{content:"data(label)","background-color":"rgb(194, 194, 255)",shape:"ellipse",width:"160px",height:"120px","font-size":"48px","border-color":"black","border-width":"1px"}},{selector:'node[nodeType="adaptor"]',style:{content:"data(label)","background-color":"rgb(77, 184, 255)",shape:"ellipse",width:"60px",height:"120px","font-size":"48px","border-color":"black","border-width":"1px"}},{selector:'node[nodeType="GEF"]',style:{content:"data(label)","background-color":"rgb(77, 184, 255)",shape:"ellipse",width:"60px",height:"60px","font-size":"48px","border-color":"black","border-width":"1px"}},{selector:'node[nodeType="process"]',style:{content:"data(label)","background-color":"rgb(255, 255, 255)",shape:"roundrectangle",width:"100px",height:"40px","font-size":"24px","border-color":"black","border-width":"0px"}},{selector:'node[nodeType="TF"]',style:{content:"data(label)","background-color":"rgb(255, 206, 94)",shape:"diamond",width:"160px",height:"60px","font-size":"48px","border-color":"black","border-width":"1px"}},{selector:'node[nodeType="gene fusion"]',
style:{content:"data(label)",shape:"roundrectangle","font-size":"24px","border-color":"red","border-width":"3px"}},{selector:"edge:selected",style:{"overlay-color":"grey","overlay-opacity":"0.3"}},{selector:'edge[edgeType="recruits"]',style:{width:"2px"}},{selector:'edge[edgeType="fusion"]',style:{"line-color":a}},{selector:'edge[edgeType="recruits"]',style:{"line-color":"red",width:"1px","line-style":"dashed","target-arrow-shape":"triangle","target-arrow-color":"black"}},{selector:'edge[edgeType="cycles"]',style:{"line-color":"black",width:"1px","line-style":"dashed","target-arrow-shape":"triangle","source-arrow-shape":"triangle","target-arrow-color":"green","source-arrow-color":"red"}},{selector:'edge[edgeType="associates"]',style:{"line-color":"black",width:"1px","line-style":"solid"}},{selector:'edge[edgeType="activation"]',style:{"line-color":"green",width:"1px"}},{selector:'edge[edgeType="inhibition"]',style:{"line-color":"red",width:"1px"}}]}var u,p,m=this,h=angular.element("#pathways-chart");m.datasource=e.getDataSource(),m.search="",m.frame,m.tip=null,m.linkTitle="",m.links=[],m.resize=function(){h.width("100%"),h.height(i.innerHeight-90),p&&(p.resize(),p.center())},o.$watch("vm.search",function(){if(!angular.isUndefined(p)){var e=m.search.toUpperCase(),t=e.length;p.startBatch(),p.nodes().map(function(a){0==t?a.unselect():a.attr("name").substr(0,t)===e?a.select():a.unselect()}),p.endBatch()}}),e.setBusy(!0),e.query("render_pathways").then(function(t){u=t.data[0],p=l({container:h,elements:u.elements,style:d(),minZoom:.1,maxZoom:5,zoom:.2,wheelSensitivity:.5,layout:{name:"preset",fit:!0}}).on("click","node",function(e){"gene"==e.cyTarget.data().nodeType&&(angular.element("#gbm-webpage").modal(),o.$apply(function(){m.frame=r.trustAsResourceUrl("https://www.genecards.org/cgi-bin/carddisp.pl?gene="+e.cyTarget.data().id)}))}).on("click","edge",function(e){angular.element("#gbm-webpage").modal(),o.$apply(function(){m.frame=r.trustAsResourceUrl("https://www.ncbi.nlm.nih.gov/pubmed/?term="+e.cyTarget.data().pmid)})}).on("mouseover","edge",function(e){o.$apply(function(){m.tip=e.cyTarget.data().source+" Extract"}),e.cyTarget.style({width:"4px"})}).on("mouseout","edge",function(e){o.$apply(function(){m.tip=null}),e.cyTarget.style({width:"2px"})}).on("mouseover","node",function(e){o.$apply(function(){m.tip=e.cyTarget.data().name+" Gene Card"})}).on("mouseout","node",function(){o.$apply(function(){m.tip=null})}),m.resize(),e.setBusy(!1)}),e.onResize.add(m.resize),angular.element(i).bind("resize",c.debounce(m.resize,300))}e.$inject=["osApi","osCohortService","$state","$stateParams","$scope","$sce","$window","moment","cytoscape","_"];var t={restrict:"E",templateUrl:"app/components/pathways/pathways.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osPathways",e)}(),function(){"use strict";function e(){function e(){t.play()}var t=new Audio("data:audio/wav;base64,//uQRAAAAWMSLwUIYAAsYkXgoQwAEaYLWfkWgAI0wWs/ItAAAGDgYtAgAyN+QWaAAihwMWm4G8QQRDiMcCBcH3Cc+CDv/7xA4Tvh9Rz/y8QADBwMWgQAZG/ILNAARQ4GLTcDeIIIhxGOBAuD7hOfBB3/94gcJ3w+o5/5eIAIAAAVwWgQAVQ2ORaIQwEMAJiDg95G4nQL7mQVWI6GwRcfsZAcsKkJvxgxEjzFUgfHoSQ9Qq7KNwqHwuB13MA4a1q/DmBrHgPcmjiGoh//EwC5nGPEmS4RcfkVKOhJf+WOgoxJclFz3kgn//dBA+ya1GhurNn8zb//9NNutNuhz31f////9vt///z+IdAEAAAK4LQIAKobHItEIYCGAExBwe8jcToF9zIKrEdDYIuP2MgOWFSE34wYiR5iqQPj0JIeoVdlG4VD4XA67mAcNa1fhzA1jwHuTRxDUQ//iYBczjHiTJcIuPyKlHQkv/LHQUYkuSi57yQT//uggfZNajQ3Vmz+Zt//+mm3Wm3Q576v////+32///5/EOgAAADVghQAAAAA//uQZAUAB1WI0PZugAAAAAoQwAAAEk3nRd2qAAAAACiDgAAAAAAABCqEEQRLCgwpBGMlJkIz8jKhGvj4k6jzRnqasNKIeoh5gI7BJaC1A1AoNBjJgbyApVS4IDlZgDU5WUAxEKDNmmALHzZp0Fkz1FMTmGFl1FMEyodIavcCAUHDWrKAIA4aa2oCgILEBupZgHvAhEBcZ6joQBxS76AgccrFlczBvKLC0QI2cBoCFvfTDAo7eoOQInqDPBtvrDEZBNYN5xwNwxQRfw8ZQ5wQVLvO8OYU+mHvFLlDh05Mdg7BT6YrRPpCBznMB2r//xKJjyyOh+cImr2/4doscwD6neZjuZR4AgAABYAAAABy1xcdQtxYBYYZdifkUDgzzXaXn98Z0oi9ILU5mBjFANmRwlVJ3/6jYDAmxaiDG3/6xjQQCCKkRb/6kg/wW+kSJ5//rLobkLSiKmqP/0ikJuDaSaSf/6JiLYLEYnW/+kXg1WRVJL/9EmQ1YZIsv/6Qzwy5qk7/+tEU0nkls3/zIUMPKNX/6yZLf+kFgAfgGyLFAUwY//uQZAUABcd5UiNPVXAAAApAAAAAE0VZQKw9ISAAACgAAAAAVQIygIElVrFkBS+Jhi+EAuu+lKAkYUEIsmEAEoMeDmCETMvfSHTGkF5RWH7kz/ESHWPAq/kcCRhqBtMdokPdM7vil7RG98A2sc7zO6ZvTdM7pmOUAZTnJW+NXxqmd41dqJ6mLTXxrPpnV8avaIf5SvL7pndPvPpndJR9Kuu8fePvuiuhorgWjp7Mf/PRjxcFCPDkW31srioCExivv9lcwKEaHsf/7ow2Fl1T/9RkXgEhYElAoCLFtMArxwivDJJ+bR1HTKJdlEoTELCIqgEwVGSQ+hIm0NbK8WXcTEI0UPoa2NbG4y2K00JEWbZavJXkYaqo9CRHS55FcZTjKEk3NKoCYUnSQ0rWxrZbFKbKIhOKPZe1cJKzZSaQrIyULHDZmV5K4xySsDRKWOruanGtjLJXFEmwaIbDLX0hIPBUQPVFVkQkDoUNfSoDgQGKPekoxeGzA4DUvnn4bxzcZrtJyipKfPNy5w+9lnXwgqsiyHNeSVpemw4bWb9psYeq//uQZBoABQt4yMVxYAIAAAkQoAAAHvYpL5m6AAgAACXDAAAAD59jblTirQe9upFsmZbpMudy7Lz1X1DYsxOOSWpfPqNX2WqktK0DMvuGwlbNj44TleLPQ+Gsfb+GOWOKJoIrWb3cIMeeON6lz2umTqMXV8Mj30yWPpjoSa9ujK8SyeJP5y5mOW1D6hvLepeveEAEDo0mgCRClOEgANv3B9a6fikgUSu/DmAMATrGx7nng5p5iimPNZsfQLYB2sDLIkzRKZOHGAaUyDcpFBSLG9MCQALgAIgQs2YunOszLSAyQYPVC2YdGGeHD2dTdJk1pAHGAWDjnkcLKFymS3RQZTInzySoBwMG0QueC3gMsCEYxUqlrcxK6k1LQQcsmyYeQPdC2YfuGPASCBkcVMQQqpVJshui1tkXQJQV0OXGAZMXSOEEBRirXbVRQW7ugq7IM7rPWSZyDlM3IuNEkxzCOJ0ny2ThNkyRai1b6ev//3dzNGzNb//4uAvHT5sURcZCFcuKLhOFs8mLAAEAt4UWAAIABAAAAAB4qbHo0tIjVkUU//uQZAwABfSFz3ZqQAAAAAngwAAAE1HjMp2qAAAAACZDgAAAD5UkTE1UgZEUExqYynN1qZvqIOREEFmBcJQkwdxiFtw0qEOkGYfRDifBui9MQg4QAHAqWtAWHoCxu1Yf4VfWLPIM2mHDFsbQEVGwyqQoQcwnfHeIkNt9YnkiaS1oizycqJrx4KOQjahZxWbcZgztj2c49nKmkId44S71j0c8eV9yDK6uPRzx5X18eDvjvQ6yKo9ZSS6l//8elePK/Lf//IInrOF/FvDoADYAGBMGb7FtErm5MXMlmPAJQVgWta7Zx2go+8xJ0UiCb8LHHdftWyLJE0QIAIsI+UbXu67dZMjmgDGCGl1H+vpF4NSDckSIkk7Vd+sxEhBQMRU8j/12UIRhzSaUdQ+rQU5kGeFxm+hb1oh6pWWmv3uvmReDl0UnvtapVaIzo1jZbf/pD6ElLqSX+rUmOQNpJFa/r+sa4e/pBlAABoAAAAA3CUgShLdGIxsY7AUABPRrgCABdDuQ5GC7DqPQCgbbJUAoRSUj+NIEig0YfyWUho1VBBBA//uQZB4ABZx5zfMakeAAAAmwAAAAF5F3P0w9GtAAACfAAAAAwLhMDmAYWMgVEG1U0FIGCBgXBXAtfMH10000EEEEEECUBYln03TTTdNBDZopopYvrTTdNa325mImNg3TTPV9q3pmY0xoO6bv3r00y+IDGid/9aaaZTGMuj9mpu9Mpio1dXrr5HERTZSmqU36A3CumzN/9Robv/Xx4v9ijkSRSNLQhAWumap82WRSBUqXStV/YcS+XVLnSS+WLDroqArFkMEsAS+eWmrUzrO0oEmE40RlMZ5+ODIkAyKAGUwZ3mVKmcamcJnMW26MRPgUw6j+LkhyHGVGYjSUUKNpuJUQoOIAyDvEyG8S5yfK6dhZc0Tx1KI/gviKL6qvvFs1+bWtaz58uUNnryq6kt5RzOCkPWlVqVX2a/EEBUdU1KrXLf40GoiiFXK///qpoiDXrOgqDR38JB0bw7SoL+ZB9o1RCkQjQ2CBYZKd/+VJxZRRZlqSkKiws0WFxUyCwsKiMy7hUVFhIaCrNQsKkTIsLivwKKigsj8XYlwt/WKi2N4d//uQRCSAAjURNIHpMZBGYiaQPSYyAAABLAAAAAAAACWAAAAApUF/Mg+0aohSIRobBAsMlO//Kk4soosy1JSFRYWaLC4qZBYWFRGZdwqKiwkNBVmoWFSJkWFxX4FFRQWR+LsS4W/rFRb/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////VEFHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAU291bmRib3kuZGUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMjAwNGh0dHA6Ly93d3cuc291bmRib3kuZGUAAAAAAAAAACU=");return{beep:e}}angular.module("oncoscape").service("osSound",e)}(),function(){"use strict";function e(e,t){var a="https://dev.oncoscape.sttrcancer.io/api/",n=function(e){var t=a+e.table;return angular.isDefined(e.query)&&(t+="/"+encodeURIComponent(JSON.stringify(e.query))),t},o=function(t){return e({method:"GET",url:n(t),headers:{apikey:"password"}})};return{queryString:n,query:o}}e.$inject=["$http","$location"],angular.module("oncoscape").factory("osHttp",e)}(),function(){"use strict"}(),function(){"use strict";function e(e,t,a,n){var o=new a.Signal,r=new a.Signal,i=new a.Signal,s=new a.Signal,l=new a.Signal,c=new Worker("app/components/oncoscape/oncoscape.cohort.service.worker.js");c.addEventListener("message",function(e){"filterPatients"==e.data.cmd?_(e.data.data,"Filter"):"validatePatientIds"==e.data.cmd?(_(e.data.data,"Import"),x()):o.dispatch(e)},!1);var d,u,p=[],m=[],h=["#E91E63","#673AB7","#4CAF50","#CDDC39","#FFC107","#FF5722","#795548","#607D8B","#03A9F4","#03A9F4","#004358","#800080","#BEDB39","#FD7400","#1F8A70"];e.onDataSource.add(function(t){c.postMessage({cmd:"setPatientDataSource",data:t.clinical.patient}),m=n.getItem(e.getDataSource().disease+"PatientCohorts"),m=null==m?[]:JSON.parse(m);for(var a=0;a<m.length;a++)m[a].color=h[a];s.dispatch(m)});var g={name:"xxx",data:[{name:"Patient",color:"#1396DE",show:!0}]},v=function(e){g=e,l.dispatch(g)},f=function(e,t,a){c.postMessage({cmd:"getSurvivalData",data:{cohorts:e,all:t,correlationId:a}})},b=function(){d.ids&&c.postMessage({cmd:"getPatientMetric",data:d.ids})},y=function(){return m},w=function(){return d},x=function(){-1==m.indexOf(d)&&(d.color=h[m.length],m.push(d),n.setItem(e.getDataSource().disease+"PatientCohorts",JSON.stringify(m)))},A=function(e){c.postMessage({cmd:"validatePatientIds",data:e})},C=function(t){m.splice(m.indexOf(t),1),n.setItem(e.getDataSource().disease+"PatientCohorts",JSON.stringify(m))},_=function(e,t){function a(){return(65536*(1+Math.random())|0).toString(16).substring(1)}d=angular.isArray(e)?{id:(a()+a()+"-"+a()+"-4"+a().substr(0,3)+"-"+a()+"-"+a()+a()+a()).toLowerCase(),ids:e,name:t,time:new Date}:e,r.dispatch(d)},k=function(e,t,a){c.postMessage({cmd:"filterPatients",data:{ids:d.ids,type:a,bounds:e,prop:t}})},S=function(){},P=function(){return p},M=function(){return u},B=function(){p.push(u)},F=function(e){p.splice(p.indexOf(e),1)},D=function(e,t){function a(){return(65536*(1+Math.random())|0).toString(16).substring(1)}u=Array.isArray(e)?{id:(a()+a()+"-"+a()+"-4"+a().substr(0,3)+"-"+a()+"-"+a()+a()+a()).toLowerCase(),ids:e,name:t,time:new Date}:e,i.dispatch(u)},E={onMessage:o,onPatientsSelect:r,onCohortsChange:s,onPatientColorChange:l,getPatientCohorts:y,getPatientCohort:w,setPatientCohort:_,addPatientCohort:x,delPatientCohort:C,importPatientCohort:A,getPatientMetric:b,onGenesSelect:i,getGeneCohorts:P,getGeneCohort:M,setGeneCohort:D,addGeneCohort:B,delGeneCohort:F,getGeneMetric:S,getSurvivalData:f,setPatientColor:v,filterActivePatientCohort:k};return E}e.$inject=["osApi","moment","signals","localStorage"],angular.module("oncoscape").service("osCohortService",e)}(),function(){"use strict";function e(e,t,a,n,o,r){var i=new a.Signal,s=new a.Signal,l=null,c=function(){return l},d=function(){return null!=l},u=null,p=[{id:"guest",name:"Guest",icon:"fa fa-user"},{id:"facebook",name:"Facebook",icon:"fa fa-facebook",key:"142281766208909",mode:"implicit"},{id:"github",name:"GitHub",icon:"fa fa-github-alt",key:"78b5dbe2ba756151169e",mode:"explicit"},{id:"google",name:"Google",icon:"fa fa-google-plus",key:"428912153446-7c82srcvu1bk1nramiqqctne005epl6s.apps.googleusercontent.com",mode:"implicit"},{id:"instagram",name:"Instagram",icon:"fa fa-instagram",key:"3578c1b7c8c248c6ba80784b9ede0c52",mode:"implicit"},{id:"linkedin",name:"LinkedIn",icon:"fa fa-linkedin",key:"7869gkuwwnacez",mode:"explicit"},{id:"twitter",name:"Twitter",icon:"fa fa-twitter",key:"vrbGiMB0LCtuHeShKE6v5IIFa",mode:"implicit"},{id:"windows",name:"Win Live",icon:"fa fa-windows",key:"caee23ac-d4aa-41c7-9bda-166b86c52de3",mode:"implicit"},{id:"dropbox",name:"Dropbox",icon:"fa fa-dropbox",key:"dropbox",mode:"implicit"},{id:"flickr",name:"Flickr",icon:"fa fa-flickr",key:"",mode:"implicit"}],m=function(){return p},h=function(e){return"guest"==e.id?(l={network:"guest",id:"x",name:"Guest",thumb:"Guest.png"},void r.init().then(function(){i.dispatch()})):void o().login(e.id,{response_type:"code",display:"page",force:!1,scope:"email"})},g=function(){o().logout(u,{force:!1},s.dispatch)};return o.init(p.reduce(function(e,t){return e[t.id]=t.key,e},{}),{oauth_proxy:"/api/auth",redirect_uri:"https://dev.oncoscape.sttrcancer.io/"}),o.on("auth.login",function(e){r.setBusy(),u=e.network,o(u).api("/me","get",null,function(e){l={network:u,id:e.id,name:e.name,thumb:e.thumbnail},r.init().then(function(){i.dispatch()})})}),{isAuthenticated:d,getUser:c,getAuthSources:m,login:h,logout:g,onLogin:i,onLogout:s}}e.$inject=["osHttp","$http","signals","$location","auth","osApi"],angular.module("oncoscape").service("osAuth",e)}(),function(){"use strict";function e(e,t,a,n,o){function r(){return o(function(e,t){f("lookup_oncoscape_datasources",{beta:!1}).then(function(t){i=t.data.filter(function(e){return angular.isDefined(e.img)}).map(function(e){return e.name=e.name.trim(),e}).sort(function(e,t){return e.name<t.name?-1:e.name>t.name?1:0}),e(i)},t)})}var i,s,l,c=new a.Signal,d=new a.Signal,u=function(){return{left:"true"==angular.element("#cohortmenu-lock").attr("locked")?300:0,right:"true"===angular.element(".tray-right").attr("locked")?300:0}},p=function(e){e?angular.element(".loader-modal").show():angular.element(".loader-modal").hide()},m=function(){return i},h=function(){return s},g=function(e){angular.isObject(e)?s!=e&&(s=e,c.dispatch(s)):angular.isString(e)&&s.disease!=e&&s!=e&&(s=i.filter(function(e){return e.disease==this.key},{key:e})[0],c.dispatch(s))},v=function(t,a){return e.queryString({table:t,query:a})},f=function(t,a){return e.query({table:t,query:a})};(function(e){var t=e.substring(0,e.replace("//","--").indexOf("/")),a=function(a,n){var o="get"+n.charAt(0).toUpperCase()+n.slice(1).toLowerCase();a[o]=function(a){return a.data=a.data||{},a.output=a.output||"svg",a.width=a.width||1e3,a.height=a.height||1e3,new Promise(function(o,r){$.ajax({url:e+"/"+n,type:"POST",data:JSON.stringify(a.data),contentType:"application/json; charset=utf-8",dataType:"text",beforeSend:function(e,t){t.xhrFields=t.xhrFields||{},t.xhrFields.withCredentials=!0,t.crossDomain=!0}}).done(function(e){var e=e.split("\n"),n="svg"==a.output?t+e[1]+"/svg?width="+a.width+"&height="+a.height:"json"==a.output?t+e[0]:null;return null==n?void alert("Invalid output option: must be svg or json"):void $.ajax({url:n,type:"GET",crossDomain:!0,beforeSend:function(e,t){t.xhrFields=t.xhrFields||{},t.xhrFields.withCredentials=!0,t.crossDomain=!0}}).done(function(e){o(e)})})})}};return new Promise(function(t,n){$.get(e).then(function(n){var o=n.split("\n").reduce(function(e,t){return""!=t&&a(e,t),e},{});o.getEndpoint=function(){return e},t(o)})})})("https://dev.oncoscape.sttrcancer.io/ocpu/library/oncoscape/R").then(function(e){l=e});var b=function(){return l};return{init:r,query:f,getCpuApi:b,queryString:v,setDataSource:g,getDataSource:h,getDataSources:m,getLayout:u,onDataSource:c,onResize:d,setBusy:p}}e.$inject=["osHttp","$http","signals","$location","$q"],angular.module("oncoscape").service("osApi",e)}(),function(){"use strict";function e(){function e(e,t,a,n,o,r,i,s,l,c,d,u,p){function m(e){$=!1,a.setPatientCohort(w.$('node[nodeType="patient"]:selected').map(function(e){return e.data().id}),"Markers + Patients")}function h(e){}e.setBusy(!0);var g,v,f,b=function(){return{patients:{select:new l.Signal,unselect:new l.Signal,over:new l.Signal,out:new l.Signal},genes:{select:new l.Signal,unselect:new l.Signal,over:new l.Signal,out:new l.Signal},edges:{select:new l.Signal,unselect:new l.Signal,over:new l.Signal,out:new l.Signal},clear:function(){this.edges.select.removeAll(),this.edges.unselect.removeAll(),this.edges.over.removeAll(),this.edges.out.removeAll(),this.patients.select.removeAll(),this.patients.unselect.removeAll(),this.patients.over.removeAll(),this.patients.out.removeAll(),this.genes.select.removeAll(),this.genes.unselect.removeAll(),this.genes.over.removeAll(),this.genes.out.removeAll()}}}(),y=angular.element("#markers-chart"),w=function(e){return s({container:e,style:[{selector:"core",style:{"selection-box-color":"#3993fa","selection-box-border-color":"#3993fa","selection-box-border-width":"1px","selection-box-opacity":".2"}},{selector:"node",style:{"background-color":"#3993fa",display:"data(display)",width:"data(sizeEle)",height:"data(sizeEle)","border-width":"data(sizeBdr)","font-size":"data(sizeLbl)","text-valign":"center"}},{selector:'node[nodeType="telomere"]',style:{"background-color":"#3993fa"}},{selector:'node[nodeType="patient"]',style:{"background-color":"data(color)","text-halign":"center","border-color":"#FFFFFF"}},{selector:'node[nodeType="patient"]:selected',style:{"border-color":"#000","border-width":5}},{selector:'node[nodeType="gene"]',style:{"background-color":"data(color)","border-color":"data(colorBdr)","text-halign":"right","text-margin-x":5,color:"#000",label:"data(id)","border-width":"data(sizeBdr)"}},{selector:'node[nodeType="gene"]:selected',style:{"border-color":"#000","border-width":5}},{selector:'node[nodeType="centromere"]',style:{"font-size":"20px","text-halign":"center","background-color":"#3993fa",color:"#FFFFFF","border-color":"rgb(19, 150, 222)",height:"40px",width:"40px",shape:"round",label:"  data(id)"}},{selector:"edge",style:{display:"data(display)","line-color":"data(color)",width:"data(sizeEle)"}},{selector:'node[nodeType="annotation-text"]',style:{"font-size":"400px","text-halign":"right","text-valign":"bottom","background-color":"#FFF",color:"#000","border-color":"#FFF",height:"0px",width:"0px",shape:"round",label:"data(label)","text-transform":"uppercase"}}],hideEdgesOnViewport:!1,hideLabelsOnViewport:!0,textureOnViewport:!1,wheelSensitivity:.5,zoom:.08,pan:{x:650,y:160},minZoom:.05,maxZoom:20,layout:{name:"preset",fit:!0}})}(y);!function(){e.query("render_chromosome",{type:"chromosome"}).then(function(e){var t=e.data[0].data,a=[];Object.keys(t).forEach(function(e){var t=this.chromosomes[e];this.elements.push({group:"edges",grabbable:!1,locked:!0,selectable:!1,data:{color:"#3993fa",id:"ce"+e,display:"element",edgeType:"chromosome",sizeBdr:0,sizeEle:3,source:"cp"+e,target:"cq"+e}}),this.elements.push({group:"nodes",grabbable:!1,locked:!0,selectable:!1,position:{x:t.x,y:t.p},data:{id:"cp"+e,display:"element",nodeType:"telomere",degree:1,sizeBdr:1,sizeEle:1,sizeLbl:1,subType:"unassigned"}}),this.elements.push({group:"nodes",grabbable:!1,locked:!0,selectable:!1,position:{x:t.x,y:t.q},data:{id:"cq"+e,display:"element",nodeType:"telomere",degree:1,sizeBdr:5,sizeEle:5,sizeLbl:5,subType:"unassigned"}}),this.elements.push({group:"nodes",grabbable:!1,locked:!0,selectable:!1,position:{x:t.x,y:t.c},data:{id:e,display:"element",sizeBdr:1,sizeEle:10,sizeLbl:10,nodeType:"centromere",degree:1}})},{chromosomes:t,elements:a}),w.add(a)})}();var x=function(e,t){return e.showPopupSelection=!1,e.datasource=t.getDataSource(),e.detail={show:!1,html:"",title:""},e.optGeneSets=[],e.optGeneSet,e.optPatientLayouts=[],e.optPatientLayout,e.showPanelLayout=!1,e.showPanelColor=!1,e.showPanelColorRna=!1,e.search="",e.optCommandModes=[{name:"Sequential"},{name:"Set"},{name:"Ad Hoc"}],e.optCommandMode=e.optCommandModes[0],e.hideModal=function(){angular.element("#modalEdge").modal("hide")},e.filterModelEdge=function(){angular.element("#modalEdge").modal("hide");var t=e.optEdgeColors.filter(function(e){return e.show}).map(function(e){return e.id}),a=g.edges.filter(function(e){return-1!=t.indexOf(e.data.cn)},{vals:t});w.startBatch();w.add(a);w.endBatch(),g=null},e.edgeToggle=function(t){e.cmd("ShowSelectedEdges")},e.selectColor=function(e){var t=e.color,a=w.$('node[nodeType="patient"]');w.startBatch(),a.forEach(function(e){e.data().color==this&&e.select()},t),w.endBatch()},e.deselectColor=function(e){var t=e.color,a=w.$('node[nodeType="patient"]:selected');w.startBatch(),a.forEach(function(e){e.data().color==this&&e.unselect()},t),w.endBatch()},e.lockPatients=!1,e.lockGenes=!1,e.lock=function(t){switch(t){case"patient":e.lockPatients=!e.lockPatients,w.startBatch(),w.$('node[nodeType="patient"]').forEach(function(t){e.lockPatients?t.unselectify():t.selectify()}),w.endBatch();break;case"gene":e.lockGenes=!e.lockGenes,w.startBatch(),w.$('node[nodeType="cn"]').forEach(function(t){e.lockGenes?t.unselectify():t.selectify()}),w.endBatch()}},e.optEdgeColors=[{name:"mutation",abv:"m",show:!0,color:"#9C27B0","class":"switch-mutation",count:"",id:0},{name:"cnGain.1",abv:"cnG1",show:!0,color:"#03A9F4","class":"switch-cnG1",count:"",id:1},{name:"cnGain.2",abv:"cnG2",show:!0,color:"#3F51B5","class":"switch-cnG2",count:"",id:2},{name:"cnLoss.1",abv:"cnL1",show:!0,color:"#FF9800","class":"switch-cnL1",count:"",id:-1},{name:"cnLoss.2",abv:"cnL2",show:!0,color:"#F44336","class":"switch-cnL2",count:"",id:-2}],p.all([t.query("render_chromosome",{type:"geneset",$fields:["name"]}),t.query("render_patient",{type:"cluster",dataset:t.getDataSource().disease,$fields:["name"]}),t.query("render_patient",{type:"color",dataset:t.getDataSource().disease,$fields:["name"]})]).then(function(a){e.optGeneSets=a[0].data,"brain"==t.getDataSource().disease?e.optGeneSet=e.optGeneSets.filter(function(e){return"TCGA pancan mutated"==e.name})[0]:e.optGeneSet=e.optGeneSets.filter(function(e){return"TCGA pancan mutated"==e.name})[0],e.optPatientLayouts=a[1].data,e.optPatientLayout=e.optPatientLayouts[0]}),e.resize=function(){var e=d.innerWidth;y.width(e),y.height(d.innerHeight-90),w.resize()},angular.element(d).bind("resize",u.debounce(e.resize,300)),e}(this,e),A=function(e,t){var a=function(){e.fit(),e.center()},n=function(){e.fit(e.$(":selected"),50)};return t.zoom={reset:a,fit:n},e.on("pan",u.debounce(function(t){e.startBatch(),P(),e.endBatch()},50)),t.zoom}(w,x),C=t.scaleLog().domain([.005,20]).range([5,1]),_=t.scaleLog().domain([.005,20]).range([80,1]),k=t.scaleLog().domain([.005,20]).range([50,1]),S=t.scalePow().range([.01,2]),P=function(){S.domain(w.$('node[nodeType="patient"],node[nodeType="gene"]').toArray().reduce(function(e,t){var a=t.data().weight;return e[0]=Math.min(e[0],a),e[1]=Math.max(e[1],a),e},[1/0,-(1/0)]));var e=w.zoom(),t=_(e),a=.375>e?0:k(e),n=C(e);w.$('node[nodeType="patient"],node[nodeType="gene"]').forEach(function(e){e.data({sizeEle:Math.round(this.sizeNode*S(e.data().weight)),sizeLbl:this.sizeLbl,sizeBdr:this.sizeBdr})},{sizeNode:t,sizeBdr:n,sizeLbl:a,scale:S})},M=function(e,t,n,o,i,s,l){var c={};f=new Worker("app/components/markers/markers.worker.js"),f.addEventListener("message",function(e){c[e.data.cmd](e.data.data)},!1);var d=function(t,a){if(angular.isUndefined(a))return void e.remove(t);try{var n=a.map(function(e){return this.getElementById(e)},e);e.collection(n).remove()}catch(o){}};return c.patients_html=function(e){v=e},c.patients_resize=function(){},c.patients_delete=function(e){d('node[nodeType="patient"]',e)},c.patients_insert=function(n){e.startBatch();var o=(l.patients,e.add(n.patients));o.on("select",s.debounce(l.patients.select.dispatch,300)),o.on("unselect",s.debounce(l.patients.unselect.dispatch,300)),o.on("mouseover",l.patients.over.dispatch),o.on("mouseout",l.patients.out.dispatch),o.forEach(function(e){try{e.data({weight:n.degrees[e.id()].weight})}catch(t){e.data({weight:100})}}),P(),e.endBatch(),t.resize();var r=a.getPatientCohort();null==r?a.setPatientCohort([],"All Patients"):(e.startBatch(),e.nodes('node[nodeType="patient"]').forEach(function(e){-1!=r.ids.indexOf(e.id())&&e.select()},{pc:r}),e.endBatch(),t.zoom.reset(),e.center(),e.fit(e.nodes(),400))},c.patients_layout=function(t){e.startBatch(),e.$("node[nodeType='annotation-text'],edge[nodeType='annotation-line'],node[nodeType='annotation-point']").remove(),t.annotation&&e.add(t.annotation),e.nodes('node[nodeType="patient"]').forEach(function(e){try{var a=t.data[e.id()];a.x-=4e3,e.position(a)}catch(n){}}),P(),e.endBatch()},c.genes_html=function(){},c.genes_delete=function(e){d('node[nodeType="gene"]',e)},c.genes_insert=function(t){e.startBatch();var a=(l.genes,e.add(t.genes));a.on("select",s.debounce(l.genes.select.dispatch,300)),a.on("unselect",s.debounce(l.genes.unselect.dispatch,300)),a.on("mouseover",l.genes.over.dispatch),a.on("mouseout",l.genes.out.dispatch),a.forEach(function(e){try{e.data({weight:t.degrees[e.id()].weight})}catch(a){e.data({weight:500})}}),e.endBatch(),P(),n.setBusy(!1)},c.edges_delete=function(e){d('edge[edgeType="cn"]',e)},c.edges_insert=function(a){if(g=a,a.counts.total>5e3)return angular.element("#modalEdge").modal(),void r.$apply(function(){t.edgeCounts=a.counts});if("Ad Hoc"==t.optCommandMode.name){e.startBatch(),e.$('edge[edgeType="cn"]').remove();var n=e.add(a.edges);if("patient"==F){var o=n.map(function(e){return[e.data().source,e.data().color]}).reduce(function(e,t){return e[t[0]]=t[1],e},{});e.$('node[nodeType="gene"]').forEach(function(e,t,a){var n=e.id(),o=this.hasOwnProperty(n);e.data("sizeBdr",o?10:1),e.data("colorBdr",o?this[n]:"#FFFFFF"),e.data("color",o?this[n]:"#0096d5")},o)}e.endBatch()}else e.startBatch(),e.add(a.edges),t.edgeCounts=a.counts,e.endBatch()},function(e){f.postMessage({cmd:"setOptions",data:e})}}(w,x,e,p,A,u,b),B=function(t,a){return function(n){n=n||"";var o=a.optGeneSet.name,r=e.getDataSource().edges.filter(function(e){return e.name==this.geneset},{geneset:o})[0],i={mode:a.optCommandMode.name,cmd:n,dataset:e.getDataSource().disease,patients:{data:a.datasource.clinical.patient,layout:a.optPatientLayout.name,selected:t.$('node[nodeType="patient"]:selected').map(function(e){return e.data().id})},genes:{layout:a.optGeneSet.name,selected:t.$('node[nodeType="gene"]:selected').map(function(e){return e.data().id})},edges:{patientWeights:r.patientWeights,geneWeights:r.genesWeights,layout:a.datasource.edges.filter(function(e){return e.name==this},o)[0],colors:a.optEdgeColors.filter(function(e){return e.show}).map(function(e){return{id:e.id,color:e.color}})}};return i}}(w,x);x.cmd=function(){};var F=(function(t,a){var n=1,o=!0,r=function(){o&&(o=!1,O())||M(B())};n+=0,a.$watch("vm.optGeneSet",function(){return n>0?void(n-=1):void(angular.isUndefined(t.optGeneSet)||angular.isUndefined(t.optPatientLayout)||(e.setBusy(!0),w.$('edge[edgeType="cn"]').remove(),r()))}),n+=1,a.$watch("vm.optPatientLayout",function(){return n>0?void(n-=1):void r()}),n+=1,a.$watch("vm.search",u.debounce(function(){if(n>0)return void(n-=1);var e=t.search.toUpperCase().trim();e.length>0&&w.$("node").filter(function(t,a){return 0==a.id().toUpperCase().indexOf(e)}).select()},600)),n+=1,a.$watch("vm.optEdgeColors.color",function(){return n>0?void(n-=1):(r(),void t.resize())})}(x,r),""),D=function(){angular.element(".legend-count").text("");var e=w.$('node[nodeType="patient"]:selected').toArray();0==e.length&&(e=w.$('node[nodeType="patient"]').toArray());var t=e.reduce(function(e,t){var a=t.data().color;return e.hasOwnProperty(a)||(e[a]=0),e[a]+=1,e},{});Object.keys(t).forEach(function(e){angular.element("#legend-"+e.substr(1)).text(" ("+this[e]+")")},t)},E=function(e){r.$apply(function(){"mouseout"==e.type||(F="patient")})},T=function(e){r.$apply(function(){"mouseout"==e.type?angular.element("#cohortmenu-legand").html(""):(F="gene",angular.element("#cohortmenu-legand").html(e.cyTarget.id()))})},$=!0;a.onPatientsSelect.add(function(e){$&&(w.startBatch(),w.$('node[nodeType="patient"]:selected').deselect(),w.$('node[nodeType="patient"]').forEach(function(t){-1!=e.ids.indexOf(t.id())&&t.select()}),w.endBatch()),$=!0}),r.$watch("vm.optCommandMode",function(){switch(b.clear(),w.$("node").unselect(),w.$('edge[edgeType="cn"]').remove(),x.optCommandMode.name){case"Sequential":x.cmd=function(e){switch(e){case"ShowSelectedEdges":var t=w.$('node[nodeType="patient"]:selected, node[nodeType="gene"]:selected');if(0==t.length)return;t.neighborhood("edge").remove();var a=B(e);M(a);break;case"HideAllEdges":w.$('edge[edgeType="cn"]').remove();break;case"HideSelectedEdges":w.$('node[nodeType="patient"]:selected, node[nodeType="gene"]:selected').neighborhood("edge").remove();break;case"HideUnselectedEdges":w.$('node[nodeType="patient"]:unselected').neighborhood("edge").remove();break;case"SelectConnected":w.startBatch(),w.$("node:selected").neighborhood("node").forEach(function(e){e.select()}),w.endBatch();break;case"SelectInverse":w.startBatch(),w.$("node").forEach(function(e){e[e._private.selected?"deselect":"select"]()}),w.endBatch();break;case"HideUnselectedNodes":w.startBatch(),w.$('node[nodeType="patient"]:unselected').forEach(function(e){e.style({display:"none"})}),w.endBatch();break;case"ShowAllNodes":w.startBatch(),w.$('node[nodeType="patient"]:hidden').forEach(function(e){e.style({display:"element"})}),w.endBatch();break;default:var a=B(e);M(a)}},b.patients.select.add(D),b.patients.unselect.add(D),b.genes.over.add(T),b.genes.out.add(T),b.genes.select.add(h),b.genes.unselect.add(h),b.patients.over.add(E),b.patients.out.add(E),b.patients.select.add(m),b.patients.unselect.add(m);break;case"Set":var e=function(){w.$('edge[edgeType="cn"]').remove();var e=B();(e.patients.selected.length>0||e.genes.selected.length>0)&&M(e),m(e)},t=function(){w.$('edge[edgeType="cn"]').remove();var e=B();M(e),m(e)},a=function(){w.$('edge[edgeType="cn"]').remove();var e=B();(e.patients.selected.length>0||e.genes.selected.length>0)&&M(e),h(e)},n=function(){w.$('edge[edgeType="cn"]').remove();var e=B();M(e),h(e)};b.patients.select.add(D),b.patients.unselect.add(D),b.genes.over.add(T),b.genes.out.add(T),b.patients.over.add(E),b.patients.out.add(E),b.patients.select.add(t),b.patients.unselect.add(e),b.genes.select.add(n),b.genes.unselect.add(a);break;case"Ad Hoc":var o=function(e){w.nodes().unselect(),e.cyTarget.select(),M(B())},r=function(e){e.cyTarget.unselect(),w.startBatch(),w.$('edge[edgeType="cn"]').remove(),w.$('node[nodeType="gene"]').forEach(function(e,t,a){e.data("color","#0096d5"),e.data("sizeBdr",1),e.data("colorBdr","#FFFFFF")}),w.endBatch()};b.genes.over.add(T),b.genes.out.add(T),b.patients.over.add(E),b.patients.out.add(E),b.patients.over.add(o),b.patients.out.add(r),b.genes.over.add(o),b.genes.out.add(r)}});var z=function(e){if(x.showPanelColor=!1,x.legendCaption=e.name,x.legendNodes=e.data,"None"==e.name)return x.legendCaption="",w.startBatch(),w.nodes('node[nodeType="patient"]').forEach(function(e){e.data("color","#0096d5")}),void w.endBatch();var t=e.data.reduce(function(e,t){for(var a=0;a<t.values.length;a++)e[t.values[a]]=t.color;return e},{});w.startBatch(),w.nodes('node[nodeType="patient"]').forEach(function(e){t.hasOwnProperty(e.id())?e.data("color",t[e.id()]):e.data("color","#DDD")}),w.endBatch(),o(D)};a.onPatientColorChange.add(z);var L,O=function(){L=e.getDataSource().disease;var t=localStorage.getItem(e.getDataSource().disease+"MarkersPatients");if(null===t)return!1;t=JSON.parse(t),w.load(t.elements),x.resize();var n=w.nodes('node[nodeType="patient"]');n.on("select",u.debounce(b.patients.select.dispatch,300)),n.on("unselect",u.debounce(b.patients.unselect.dispatch,300)),n.on("mouseover",b.patients.over.dispatch),n.on("mouseout",b.patients.out.dispatch),w.center(),w.fit(w.nodes(),400);var o=a.getPatientCohort();return null==o?a.setPatientCohort([],"All Patients"):(w.startBatch(),w.nodes('node[nodeType="patient"]').forEach(function(e){-1!=o.ids.indexOf(e.id())&&e.select()},{pc:o}),w.endBatch()),e.setBusy(!1),!0},G=function(){console.log("!!!");var e=JSON.stringify(w.json());localStorage.setItem(L+"MarkersPatients",e)};r.$on("$destroy",function(){G(),a.onPatientColorChange.remove(z),f.terminate(),b.clear()})}e.$inject=["osApi","d3","osCohortService","$state","$timeout","$scope","$stateParams","cytoscape","signals","moment","$window","_","$q"];var t={restrict:"E",templateUrl:"app/components/markers/markers.html",scope:{},controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osMarkers",e)}(),function(){"use strict";function e(){function e(e,t,a,n){var o=this;o.networks=n.getAuthSources(),o.login=n.login;var r=function(){t.go("datasource")};n.onLogin.add(r),a.$on("$destroy",function(){n.onLogin.remove(r)})}e.$inject=["osApi","$state","$scope","osAuth"];var t={restrict:"E",templateUrl:"app/components/login/login.html",replace:!0,controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osLogin",e)}(),function(){"use strict";function e(){var e={restrict:"E",templateUrl:"app/components/loader/loader.html",replace:!0};return e}angular.module("oncoscape").directive("osLoader",e)}(),function(){"use strict";function e(){function e(e){var t=this;t.login=function(){e.go("login")}}e.$inject=["$state"];var t={restrict:"E",templateUrl:"app/components/landing/landing.html",
replace:!0,controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osLanding",e)}(),function(){"use strict";function e(){function e(e,t,a,n,o,r,i,s,l,c,d,u){var p,m,h,g,v=function(e,t){return""==e?!1:null==t?!1:-1!=t.toString().toUpperCase().indexOf(e)},f=this,b={manualColumnResize:!0,manualColumnMove:!0,fixedRowsTop:0,readonly:!0,contextMenu:!0,columnSorting:!0,sortIndicator:!0,comments:!0,allowEmpty:!0,autoColumnSize:{samplingRatio:23},search:{queryMethod:v},mergeCells:!1};p=angular.element("#history-grid");var y=t.getPatientCohort();null==y&&t.setPatientCohort([],"All Patients");var w=null==y?[]:y.ids;!function(t){t.datasource=e.getDataSource(),t.cohortMode="Filter",t.search="",t.collections=Object.keys(t.datasource.clinical).map(function(e){var t=this.data[e];return{name:e,collection:t}},{data:t.datasource.clinical}).filter(function(e){return"events"!=e.name}),t.collection=t.collections[0]}(f),f.exportCsv=function(){var e=(m.getColHeader(),m.getData()),t=String.fromCharCode(11),a=String.fromCharCode(0),n='","',o='"\r\n"',r='"'+e.map(function(e,a){return e.map(function(e,t){var a="";return e&&(a=e.toString()),a}).join(t)}).join(a).split(a).join(o).split(t).join(n)+'"',i=encodeURI("data:text/csv;charset=utf-8,"+r);d.open(i)};var x=function(){g=0==w.length?h:h.filter(function(e){return-1!=this.indexOf(e.patient_ID)},w),m.loadData(g),m.render()},A=function(){e.setBusy(!0),e.query(f.collection.collection).then(function(t){h=t.data.map(function(e){return e.color="#0b97d3",e}),f.columns=Object.keys(h[0]).map(function(e){return{field:e,displayName:e.replace(/_/g," ").toUpperCase(),show:!0}}),null==m&&(b.startCols=f.columns.length,m=new u(p[0],b)),f.setSize(!1),x(),f.setColumns(!1),e.setBusy(!1)})},C=function(e,t,a,n,o,r,i){u.TextRenderer.apply(this,arguments),t.style.color=g[a].color};f.setColumns=function(e){var t=f.columns.filter(function(e){return e.show});b.colHeaders=t.map(function(e){return e.displayName}),b.columns=t.map(function(e){return{data:e.field}}),b.cells=function(e,t,a){var n={};return n.renderer=C,n},m.updateSettings(b),m.render(),e&&m.render()},f.setSize=function(t){var a=e.getLayout();p.css("margin-left",a.left-30+"px"),p.css("width",d.innerWidth-a.left-a.right-80+"px"),p.css("height",d.innerHeight-170+"px"),m.render()},o.$watch("vm.collection",A),o.$watch("vm.search",function(e){if(angular.isDefined(m)){m.search.query(e.toUpperCase().trim());m.render()}}),e.onResize.add(f.setSize);var _=function(){f.setSize(!0)};angular.element(d).bind("resize",_),f.resetFilter=function(){w=[],x()};var k=function(e){w=e.ids,x()};t.onPatientsSelect.add(k);var S=function(e){f.legendCaption=e.name,f.legendNodes=e.data;var t=e.data.reduce(function(e,t){for(var a=0;a<t.values.length;a++)e[t.values[a]]=t.color;return e},{});h.forEach(function(e){e.color=this[e.patient_ID],console.log(e.color)},t)};t.onPatientColorChange.add(S),e.setBusy(!0),o.$on("$destroy",function(){t.onPatientsSelect.remove(onPatientsSelect),t.onPatientColorChange.remove(S)})}e.$inject=["osApi","osCohortService","$state","$timeout","$scope","moment","$stateParams","_","$","$q","$window","Handsontable"];var t={restrict:"E",templateUrl:"app/components/history/history.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osHistory",e)}(),function(){"use strict";function e(){function e(e,t,a,n,o,r,i,s){function l(t,a,n){function o(e){return(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function r(e,t,a,n){this.widths=e,this.heights=t;var o,r=null,i=null,s=0,l=0;for(o=0;o<e.length;o++)if("*"===e[o]){if(null!==r)throw new Error("Only one column can be designated as fill");r=o}else s+=e[o];if(null!==r)e[r]=a-s;else if("number"==typeof a&&a!==s)throw new Error("Column widths don't add up to total width");for(o=0;o<t.length;o++)if("*"===t[o]){if(null!==i)throw new Error("Only one row can be designated as fill");i=o}else l+=t[o];if(null!==i)t[i]=n-l;else if("number"==typeof n&&n!==l)throw new Error("Column heights don't add up to total height")}function i(e){return{position:"absolute",top:e.top+"px",left:e.left+"px",width:e.width+"px",height:e.height+"px"}}function s(t,a,n,r){function i(e){e.attr("x",function(e,t){return d(t%s)}).attr("y",function(e,t){return u(Math.floor(t/s))}).attr("width",d(1)-d(0)-f).attr("height",u(1)-u(0)-f)}if(0===a.length)return function(){};v.show_grid||t.style("shape-rendering","crispEdges");var s=a.dim[1],l=a.dim[0],c=a.merged,d=e.scale.linear().domain([0,s]).range([0,n]),u=e.scale.linear().domain([0,l]).range([0,r]),p=e.tip().attr("class","d3heatmap-tip").html(function(e,t){return'<table><tr><th align="right">Row</th><td>'+o(a.rows[e.row])+'</td></tr><tr><th align="right">Column</th><td>'+o(a.cols[e.col])+'</td></tr><tr><th align="right">Value</th><td>'+o(e.label)+"</td></tr></table>"}).direction("se").style("position","fixed"),m=e.svg.brush().x(d).y(u).clamp([!0,!0]).on("brush",function(){var t=m.extent();t[0][0]=Math.round(t[0][0]),t[0][1]=Math.round(t[0][1]),t[1][0]=Math.round(t[1][0]),t[1][1]=Math.round(t[1][1]),e.select(this).call(m.extent(t))}).on("brushend",function(){if(m.empty())g.transform({scale:[1,1],translate:[0,0],extent:[[0,0],[s,l]]});else{var t=(g.transform(),m.extent()),a=[s/(t[1][0]-t[0][0]),l/(t[1][1]-t[0][1])],o=[t[0][0]*(n/s)*a[0]*-1,t[0][1]*(r/l)*a[1]*-1];g.transform({scale:a,translate:o,extent:t})}m.clear(),e.select(this).call(m).select(".brush .extent").style({fill:v.brush_color,stroke:v.brush_color})});t=t.attr("width",n).attr("height",r);var h=t.selectAll("rect").data(c);h.enter().append("rect").classed("datapt",!0).property("colIndex",function(e,t){return t%s}).property("rowIndex",function(e,t){return Math.floor(t/s)}).property("value",function(e,t){return e.value}).attr("fill",function(e){return e.color?e.color:"transparent"}),h.exit().remove(),h.append("title").text(function(e,t){return e.label}),h.call(p);var f;f="number"==typeof v.show_grid?v.show_grid:v.show_grid?.25:0,i(h),g.on("transform.colormap",function(e){d.range([e.translate[0],n*e.scale[0]+e.translate[0]]),u.range([e.translate[1],r*e.scale[1]+e.translate[1]]),i(h.transition().duration(v.anim_duration).ease("linear"))});var b=t.append("g").attr("class","brush").call(m).call(m.event);b.select("rect.background").on("mouseenter",function(){p.style("display","block")}).on("mousemove",function(){var t=e.event,a=e.event.offsetX,n=e.event.offsetY;if("undefined"==typeof a){var o=t.target||t.srcElement,r=o.getBoundingClientRect();a=t.clientX-r.left,n=t.clientY-r.top}var i=Math.floor(d.invert(a)),l=Math.floor(u.invert(n)),m=c[l*s+i].label;p.show({col:i,row:l,label:m}).style({top:e.event.clientY+15+"px",left:e.event.clientX+15+"px",opacity:.9}),g.datapoint_hover({col:i,row:l,label:m})}).on("mouseleave",function(){p.hide().style("display","none"),g.datapoint_hover(null)}),g.on("highlight.datapt",function(e){h.classed("highlight",function(t,a){return this.rowIndex===e.y||this.colIndex===e.x})})}function l(t,a,n,o,r,i){function s(e){e.attr("transform",function(e,t){var a=n?c(e)+c.rangeBand()/2:0,o=n?i+6:c(e);return"translate("+a+","+o+")"}).selectAll("rect").attr("height",c.rangeBand()/(n?1.414:1)).attr("width",n?1.414*r*1.2:o)}t=t.append("g");var l;a.children?l=e.layout.cluster().nodes(a).filter(function(e){return!e.children}).map(function(e){return e.label+""}):a.length&&(l=a);var c=e.scale.ordinal().domain(l).rangeBands([0,n?o:r]),d=e.svg.axis().scale(c).orient(n?"bottom":"right").outerTickSize(0).tickPadding(i).tickValues(l),u=t.append("g").attr("transform",n?"translate(0,"+i+")":"translate("+i+",0)").call(d),p=v[(n?"x":"y")+"axis_font_size"]||Math.min(18,Math.max(9,c.rangeBand()-(n?11:8)))+"px";u.selectAll("text").style("font-size",p);var m=t.append("g").selectAll("g").data(l);m.enter().append("g").append("rect").attr("transform",n?"rotate(45),translate(0,0)":"").attr("fill","transparent").on("click",function(t,a){var o=n?"x":"y",r=g.highlight()||{x:null,y:null};r[o]==a?(r[o]=null,g.highlight(r)):(r[o]=a,g.highlight(r)),e.event.stopPropagation()}),s(m),n&&u.selectAll("text").attr("transform","rotate(45),translate(6, 0)").style("text-anchor","start"),g.on("highlight.axis-"+(n?"x":"y"),function(e){var t=u.selectAll(".tick"),a=e[n?"x":"y"];return"number"!=typeof a?void t.classed("faded",!1):void t.classed("faded",function(e,t){return t!==a})}),g.on("transform.axis-"+(n?"x":"y"),function(e){var t=n?0:1,a=[e.translate[t],(n?o:r)*e.scale[t]+e.translate[t]];c.rangeBands(a);var i=u.transition().duration(v.anim_duration).ease("linear");i.call(d),u.selectAll("text").style("text-anchor","start"),i.selectAll("g").style("opacity",function(a,n){return n>=e.extent[0][t]&&n<e.extent[1][t]?1:0}),i.selectAll("text").style("text-anchor","start"),m.transition().duration(v.anim_duration).ease("linear").call(s).style("opacity",function(a,n){return n>=e.extent[0][t]&&n<e.extent[1][t]?1:0})})}function c(e){return e.edgePar&&e.edgePar.lwd?e.edgePar.lwd:1}function d(e,t){for(var a=0,n=0;n<e.children.length;n++)t&&(a=Math.max(a,d(e.children[n],!0))),a=Math.max(a,c(e.children[n]));return a}function u(t,a,n,o,r,i){function s(e){function t(e,t){return u(e.source.y)+","+p(e.source.x)+" "+u(e.source.y)+","+p(e.target.x)+" "+u(e.target.y)+","+p(e.target.x)}e.attr("points",t)}var l=d(a,!1),u=e.scaleLinear().domain([a.height,0]).range([l/2,o-i]),p=e.scaleLinear().domain([0,r]).range([0,r]),m=(e.cluster(a).separation(function(e,t){return 1}).size([n?o:r,NaN]),"translate(1,0)");n&&(u.range([l/2,-r+i+2]),m="rotate(-90) translate(-2,0)");var h=t.attr("width",o).attr("height",r).append("g").attr("transform",m),f=h.selectAll("polyline").data(links1);f.enter().append("polyline").attr("class","link").attr("stroke",function(e,t){return e.edgePar.col?e.edgePar.col:v.link_color}).attr("stroke-width",c).attr("stroke-dasharray",function(e,t){var a;switch(e.edgePar.lty){case 6:a=[3,3,5,3];break;case 5:a=[15,5];break;case 4:a=[2,4,4,4];break;case 3:a=[2,4];break;case 2:a=[4,4];break;case 1:default:a=[]}for(var t=0;t<a.length;t++)a[t]=a[t]*(e.edgePar.lwd||1);return a.join(",")}),g.on("transform.dendr-"+(n?"x":"y"),function(e){var t=e.scale[n?0:1],a=e.translate[n?0:1];p.range([a,r*t+a]),s(f.transition().duration(v.anim_duration).ease("linear"))}),s(f)}r.prototype.getCellBounds=function(e,t){if(0>e||e>=this.widths.length||0>t||t>=this.heights.length)throw new Error("Invalid cell bounds");for(var a=0,n=0;e>n;n++)a+=this.widths[n];for(var o=0,r=0;t>r;r++)o+=this.heights[r];return{width:this.widths[e],height:this.heights[t],top:o,left:a}};var p=e.select(t),m=p.node().getBoundingClientRect(),h=function(){this._events=e.dispatch("highlight","datapoint_hover","transform"),this._highlight={x:null,y:null},this._datapoint_hover={x:null,y:null,value:null},this._transform=null};(function(){this.highlight=function(e,t){return arguments.length?(1==arguments.length?this._highlight=e:this._highlight={x:e,y:t},void this._events.highlight.call(this,this._highlight)):{x:this._highlight.x,y:this._highlight.y}},this.datapoint_hover=function(e){return arguments.length?(this._datapoint_hover=e,void this._events.datapoint_hover.call(this,e)):this._datapoint_hover},this.transform=function(e){return arguments.length?(this._transform=e,void this._events.transform.call(this,e)):this._transform},this.on=function(e,t){this._events.on(e,t)}}).call(h.prototype);var g=new h,v={};n=n||{},v.width=n.width||m.width,v.height=n.height||m.height,v.xclust_height=n.xclust_height||.12*v.height,v.yclust_width=n.yclust_width||.12*v.width,v.link_color=v.link_color||"#AAA",v.xaxis_height=n.xaxis_height||80,v.yaxis_width=n.yaxis_width||120,v.axis_padding=n.axis_padding||6,v.show_grid=n.show_grid,"undefined"==typeof v.show_grid&&(v.show_grid=!0),v.brush_color=n.brush_color||"#0000FF",v.xaxis_font_size=n.xaxis_font_size,v.yaxis_font_size=n.yaxis_font_size,v.anim_duration=n.anim_duration,"undefined"==typeof v.anim_duration&&(v.anim_duration=500),a.rows||(v.yclust_width=0),a.cols||(v.xclust_height=0);var f=new r([v.yclust_width,"*",v.yaxis_width],[v.xclust_height,"*",v.xaxis_height],v.width,v.height),b=f.getCellBounds(1,1),y=f.getCellBounds(1,0),w=f.getCellBounds(0,1),x=f.getCellBounds(2,1),A=f.getCellBounds(1,2);!function(){var e=p.append("div").classed("inner",!0),t=(e.append("div").classed("info",!0),e.append("svg").classed("dendrogram colDend",!0));t.style(i(y));var a=e.append("svg").classed("dendrogram rowDend",!0);a.style(i(w));var n=e.append("svg").classed("colormap",!0);n.style(i(b));var o=e.append("svg").classed("axis xaxis",!0);o.style(i(A));var r=e.append("svg").classed("axis yaxis",!0);r.style(i(x)),o.style("width",v.width-v.yclust_width+"px"),o.append("defs").append("clipPath").attr("id","xaxis-clip").append("polygon").attr("points",""+[[0,0],[A.width,0],[A.width+x.width,A.height],[0,A.height]]),o.node(0).setAttribute("clip-path","url(#xaxis-clip)"),e.on("click",function(){g.highlight(null,null)}),g.on("highlight.inner",function(t){e.classed("highlighting","number"==typeof t.x||"number"==typeof t.y)})}();var s=(a.rows?u(p.select("svg.rowDend"),a.rows,!1,w.width,w.height,v.axis_padding):null,a.cols?u(p.select("svg.colDend"),a.cols,!0,y.width,y.height,v.axis_padding):null,s(p.select("svg.colormap"),a.matrix,b.width,b.height)),C=(l(p.select("svg.xaxis"),a.cols||a.matrix.cols,!0,A.width,A.height,v.axis_padding),l(p.select("svg.yaxis"),a.rows||a.matrix.rows,!1,x.width,x.height,v.axis_padding),e.dispatch("hover","click"));return g.on("datapoint_hover",function(e){C.hover({data:e})}),{on:function(e,t){return C.on(e,t),this}}}var c=this;c.datasource=t.getDataSource();var d=($("#heatmap-chart"),{x:{rows:{members:32,height:425.344651694364,edgePar:{col:""},children:[{members:23,height:261.849881468371,edgePar:{col:""},children:[{members:16,height:141.704447795403,edgePar:{col:""},children:[{members:12,height:113.302300506212,edgePar:{col:""},children:[{members:11,height:74.3824295717746,edgePar:{col:""},children:[{members:6,height:50.1094029998363,edgePar:{col:""},children:[{members:5,height:33.180384265406,edgePar:{col:""},children:[{members:4,height:20.6939435584424,edgePar:{col:""},children:[{members:3,height:13.1357108677072,edgePar:{col:""},children:[{members:2,height:8.65359029536296,edgePar:{col:""},children:[{members:1,height:0,label:"Toyota Corona",edgePar:{col:""}},{members:1,height:0,label:"Porsche 914-2",edgePar:{col:""}}]},{members:1,height:0,label:"Datsun 710",edgePar:{col:""}}]},{members:1,height:0,label:"Volvo 142E",edgePar:{col:""}}]},{members:1,height:0,label:"Merc 230",edgePar:{col:""}}]},{members:1,height:0,label:"Lotus Europa",edgePar:{col:""}}]},{members:5,height:64.889871320569,edgePar:{col:""},children:[{members:4,height:15.6724726830197,edgePar:{col:""},children:[{members:2,height:1.52315462117278,edgePar:{col:""},children:[{members:1,height:0,label:"Merc 280",edgePar:{col:""}},{members:1,height:0,label:"Merc 280C",edgePar:{col:""}}]},{members:2,height:.61532511731604,edgePar:{col:""},children:[{members:1,height:0,label:"Mazda RX4 Wag",edgePar:{col:""}},{members:1,height:0,label:"Mazda RX4",edgePar:{col:""}}]}]},{members:1,height:0,label:"Merc 240D",edgePar:{col:""}}]}]},{members:1,height:0,label:"Ferrari Dino",edgePar:{col:""}}]},{members:4,height:14.7807070196253,edgePar:{col:""},children:[{members:3,height:10.3922856003865,edgePar:{col:""},children:[{members:2,height:5.14734154685698,edgePar:{col:""},children:[{members:1,height:0,label:"Fiat 128",edgePar:{col:""}},{members:1,height:0,label:"Fiat X1-9",edgePar:{col:""}}]},{members:1,height:0,label:"Toyota Corolla",edgePar:{col:""}}]},{members:1,height:0,label:"Honda Civic",edgePar:{col:""}}]}]},{members:7,height:103.431069316719,edgePar:{col:""},children:[{members:5,height:51.8242520447715,edgePar:{col:""},children:[{members:3,height:2.13834047803431,edgePar:{col:""},children:[{members:2,height:.982649479723062,edgePar:{col:""},children:[{members:1,height:0,label:"Merc 450SL",edgePar:{col:""}},{members:1,height:0,label:"Merc 450SE",edgePar:{col:""}}]},{members:1,height:0,label:"Merc 450SLC",edgePar:{col:""}}]},{members:2,height:14.0154994559595,edgePar:{col:""},children:[{members:1,height:0,label:"Dodge Challenger",edgePar:{col:""}},{members:1,height:0,label:"AMC Javelin",edgePar:{col:""}}]}]},{members:2,height:33.5508692137775,edgePar:{col:""},children:[{members:1,height:0,label:"Hornet 4 Drive",edgePar:{col:""}},{members:1,height:0,label:"Valiant",edgePar:{col:""}}]}]}]},{members:9,height:214.936685793747,edgePar:{col:""},children:[{members:8,height:134.811946429091,edgePar:{col:""},children:[{members:5,height:101.738968566622,edgePar:{col:""},children:[{members:3,height:21.2655989805131,edgePar:{col:""},children:[{members:2,height:10.0761202851097,edgePar:{col:""},children:[{members:1,height:0,label:"Duster 360",edgePar:{col:""}},{members:1,height:0,label:"Camaro Z28",edgePar:{col:""}}]},{members:1,height:0,label:"Ford Pantera L",edgePar:{col:""}}]},{members:2,height:40.005247468301,edgePar:{col:""},children:[{members:1,height:0,label:"Pontiac Firebird",edgePar:{col:""}},{members:1,height:0,label:"Hornet Sportabout",edgePar:{col:""}}]}]},{members:3,height:40.8399635773589,edgePar:{col:""},children:[{members:2,height:15.6224446230416,edgePar:{col:""},children:[{members:1,height:0,label:"Cadillac Fleetwood",edgePar:{col:""}},{members:1,height:0,label:"Lincoln Continental",edgePar:{col:""}}]},{members:1,height:0,label:"Chrysler Imperial",edgePar:{col:""}}]}]},{members:1,height:0,label:"Maserati Bora",edgePar:{col:""}}]}]},cols:{members:11,height:1475.10429122825,edgePar:{col:""},children:[{members:9,height:115.849514457334,edgePar:{col:""},children:[{members:7,height:34.7850542618522,edgePar:{col:""},children:[{members:1,height:0,label:"cyl",edgePar:{col:""}},{members:6,height:18.9208879284245,edgePar:{col:""},children:[{members:2,height:3.60555127546399,edgePar:{col:""},children:[{members:1,height:0,label:"am",edgePar:{col:""}},{members:1,height:0,label:"vs",edgePar:{col:""}}]},{members:4,height:10.6897474245185,edgePar:{col:""},children:[{members:2,height:8.59634050046879,edgePar:{col:""},children:[{members:1,height:0,label:"carb",edgePar:{col:""}},{members:1,height:0,label:"wt",edgePar:{col:""}}]},{members:2,height:2.98172768709686,edgePar:{col:""},children:[{members:1,height:0,label:"drat",edgePar:{col:""}},{members:1,height:0,label:"gear",edgePar:{col:""}}]}]}]}]},{members:2,height:33.2610913831762,edgePar:{col:""},children:[{members:1,height:0,label:"qsec",edgePar:{col:""}},{members:1,height:0,label:"mpg",edgePar:{col:""}}]}]},{members:2,height:656.640441946732,edgePar:{col:""},children:[{members:1,height:0,label:"hp",edgePar:{col:""}},{members:1,height:0,label:"disp",edgePar:{col:""}}]}]},matrix:{data:["4","0","1","1","2.465","3.7","3","20.01","21.5","97","120.1","4","1","0","2","2.14","4.43","5","16.7","26","91","120.3","4","1","1","1","2.32","3.85","4","18.61","22.8","93","108","4","1","1","2","2.78","4.11","4","18.6","21.4","109","121","4","0","1","2","3.15","3.92","4","22.9","22.8","95","140.8","4","1","1","2","1.513","3.77","5","16.9","30.4","113","95.1","6","0","1","4","3.44","3.92","4","18.3","19.2","123","167.6","6","0","1","4","3.44","3.92","4","18.9","17.8","123","167.6","6","1","0","4","2.875","3.9","4","17.02","21","110","160","6","1","0","4","2.62","3.9","4","16.46","21","110","160","4","0","1","2","3.19","3.69","4","20","24.4","62","146.7","6","1","0","6","2.77","3.62","5","15.5","19.7","175","145","4","1","1","1","2.2","4.08","4","19.47","32.4","66","78.7","4","1","1","1","1.935","4.08","4","18.9","27.3","66","79","4","1","1","1","1.835","4.22","4","19.9","33.9","65","71.1","4","1","1","2","1.615","4.93","4","18.52","30.4","52","75.7","8","0","0","3","3.73","3.07","3","17.6","17.3","180","275.8","8","0","0","3","4.07","3.07","3","17.4","16.4","180","275.8","8","0","0","3","3.78","3.07","3","18","15.2","180","275.8","8","0","0","2","3.52","2.76","3","16.87","15.5","150","318","8","0","0","2","3.435","3.15","3","17.3","15.2","150","304","6","0","1","1","3.215","3.08","3","19.44","21.4","110","258","6","0","1","1","3.46","2.76","3","20.22","18.1","105","225","8","0","0","4","3.57","3.21","3","15.84","14.3","245","360","8","0","0","4","3.84","3.73","3","15.41","13.3","245","350","8","1","0","4","3.17","4.22","5","14.5","15.8","264","351","8","0","0","2","3.845","3.08","3","17.05","19.2","175","400","8","0","0","2","3.44","3.15","3","17.02","18.7","175","360","8","0","0","4","5.25","2.93","3","17.98","10.4","205","472","8","0","0","4","5.424","3","3","17.82","10.4","215","460","8","0","0","4","5.345","3.23","3","17.42","14.7","230","440","8","1","0","8","3.57","3.54","5","14.6","15","335","301"],dim:[32,11],rows:["Toyota Corona","Porsche 914-2","Datsun 710","Volvo 142E","Merc 230","Lotus Europa","Merc 280","Merc 280C","Mazda RX4 Wag","Mazda RX4","Merc 240D","Ferrari Dino","Fiat 128","Fiat X1-9","Toyota Corolla","Honda Civic","Merc 450SL","Merc 450SE","Merc 450SLC","Dodge Challenger","AMC Javelin","Hornet 4 Drive","Valiant","Duster 360","Camaro Z28","Ford Pantera L","Pontiac Firebird","Hornet Sportabout","Cadillac Fleetwood","Lincoln Continental","Chrysler Imperial","Maserati Bora"],cols:["cyl","am","vs","carb","wt","drat","gear","qsec","mpg","hp","disp"]},image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAALCAYAAAAeEY8BAAAEZElEQVQ4jWXTW2xTBRzH8W/P6XXrlfWybt26DQaDbYzJYF7IzIIkKCgRwSAkSogajDEYXxZfZMQXw4M3jDFCTIREVEggAiFAyIZhW1CZ4ByDXdtd6LbSbr2st3N6jg/GJsT3T34P33/+mgsDs+qjdJZvro3Tsb2OaCZH73iMzSsdfHpxmMZaJ09V2yjSidgNOo6cu8d7z68gnJSodpjoOHWHbDpHx94mfuyb4sCzfnSCULCiqKFjex0pSeb83XlEQQOAoqpsrXci7njr/U67QU/XvTC9oxGWl1pwFOk43TuN32tFzqvMJSQsRi0aQWVrQylLkszJGwHKXMWUeqwYzAZCsRzdP19FKPPhLzESz8m82OQt7Po9ZvauK+ePmRg3bwXZvcnP0Z8GEFv3vNtpNWgRTDq2Nbk5eSNAKJHD7zETT0voRAFR1KCgIS0pxHMyY5FMwSZyMh67iXhaomF9HRkpj71YTzL7r13mKCIQStBe7+KL7nGa/XYw6pmL53jpSR/Cg/kUwViaSruBgdkU+bzKvtZyHkZTbFnjJCPlyeTyrHKbmFzIIGig0m7AaTJwcEsNsViGBq+ZKrcZs0mHSa/lXO8UPSMR6krM1DqNtK3zcuzyKPtay/n6x36eXuFgmcXAV2f/RtjV4GFyIUff2CK1TiOHX17DscujxGIZfFYT+zaUMbuQ4tq9CMMzMT757jeq7UUAOE0G8nmVM72TtNc42N3oYXYhxYpKOwatQOe5QcrMJtqrHYVd/3I3tSXF7Kr3UOq1IkobXuscGIvQ1zPM/udWoxU0tNW5CrfzuYo5sNHPh59foeWJapbXuPj24hA7N1aiqNA3scDbm6uRFIWrw1FU4JVmD/VlZkxmIylZ5tLgPENzSyQzcsFefhAhkZXRnO6fVhVVZWg+hceso3s4ikErEpxN8Ga7H0GjoWciztximj0tXhRV5dfxGK1+C5cGwv+z4aTEnekEB1srCSaWmE9KWIwCt6eWmJhLkEjmHrPC1ftRJEVltbuISEpmW6MLW7GeEruRgdkUiqpydyTMG60+bgbiaNDQVmPj+5tTWE16WqqsrKywF+yZ3kl2rvVw/Pcp/JZi3GYdX14YodSi54W1btavcnGiK4iiqrjMOkR3++udobhEmd2A16LHotdRbtNzvmeSR4ksfwZihWzd98MMziYJJSRebfHSWuGgSC9y6voY0ZRE/8QikqSwrsZO72iUuWyesz1BHoWTHN7RyFwqw4lfhrDZjfRPxGiusiF+dORwp82k48pgmLXlViRFYWoxi89rBUFgOhRnMLREc5WNJp8Vt9VIOJmjcpmRTD5PYCFNTbkNWYVYMotWKxZs11CY+wPTHD/UxnQyxa1gko93NNA1FmF0KMREIo/wXwpJVnjn6HVMWpEKu4G0rHBoUzVWm5HAePixbA+jKT747AbxrIzPZgBge6OLbFZmemaRE13Bwtsl/urhh/6H3J5JcqlrBL1WYP8zFSwGxnA6TPwDUPUZFSxOfbgAAAAASUVORK5CYII=",theme:null,options:{xaxis_height:80,yaxis_width:120,xaxis_font_size:null,yaxis_font_size:null,brush_color:"#0000FF",show_grid:!0,anim_duration:500}},width:null,height:null,sizingPolicy:{defaultWidth:null,defaultHeight:null,padding:null,viewer:{defaultWidth:null,defaultHeight:null,padding:null,fill:!0,suppress:!1,paneHeight:null},browser:{defaultWidth:null,defaultHeight:null,padding:null,fill:!0},knitr:{defaultWidth:null,defaultHeight:null,figure:!0}},dependencies:null,elementId:null,preRenderHook:null,jsHooks:[]});l("#heatmap-chart",d.x)}e.$inject=["d3","osApi","osCohortService","$state","$timeout","$scope","$stateParams","$window"];var t={restrict:"E",templateUrl:"app/components/heatmap/heatmap.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osHeatmap",e)}(),function(){"use strict";function e(){function e(e,t,a,n,o,r,i){e.query("lookup_oncoscape_tools",{beta:!1}).then(function(e){s.tools=e.data}),e.onDataSource.add(function(){r(function(){s.datasets=e.getDataSources()})});var s=this;s.cohorts=[],s.addPatientCohort=t.addPatientCohort,s.setPatientCohort=t.setPatientCohort,t.onCohortsChange.add(function(e){s.cohorts=e}),s.importPatientIds="",s.importPatientCohort=function(e){var a=s.importPatientIds.split(",").map(function(e){return e.trim()});t.importPatientCohort(a)},s.showImport=!1,s.showTools=!1,s.showDatasets=!1,s.showCohorts=!1,s.showHelp=!1,s.showLogout=!1;var l;i.$on("$stateChangeStart",function(e,t){switch(l=t.name,t.name){case"landing":s.showTools=!1,s.showDatasets=!1,s.showLogout=!1,s.showCohorts=!1,s.showHelp=!1;break;case"tools":s.showTools=!0;break;case"datasource":s.showHelp=!0,s.showDatasets=!0,s.showCohorts=!0,s.showLogout=!0,s.showTools=!1}}),s.loadDataset=function(e){o.go(l,{datasource:e}),$(".navbar-collapse").collapse("hide")},s.loadTool=function(t){o.go(t,{datasource:e.getDataSource().disease}),$(".navbar-collapse").collapse("hide")},s.logoutClick=function(){a.logout(),o.transitionTo("landing")}}e.$inject=["osApi","osCohortService","osAuth","$stateParams","$state","$timeout","$rootScope"];var t={restrict:"E",templateUrl:"app/components/header/header.html",scope:{},controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osHeader",e)}(),function(){"use strict";function e(){function e(e,t){var a=this;a.datasets=e.getDataSources(),a.explore=function(a,n){e.setDataSource(n),t.go(a,{datasource:n.disease})}}e.$inject=["osApi","$state"];var t={restrict:"E",templateUrl:"app/components/datasource/datasource.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osDatasource",e)}(),function(){"use strict";function e(){function e(e,t,a,n,o,r,i,s,l,c,d,u){function p(){0==v.length?A.selectAll(".point").classed("point-unselected",!1):A.selectAll(".point").classed("point-unselected",function(){return-1==v.indexOf(this.__data__.id)})}function m(e){var t=a.select(this);t.append("svg:rect").attr("class","cell").attr("x",0).attr("y",0).attr("width",y.w).attr("height",y.h);var n=a.scaleLinear().domain(e.xDomain).range([0,y.w]),o=a.scaleLinear().domain(e.yDomain).range([0,y.h]);t.selectAll("circle").data(e.data).enter().append("svg:circle").attr("class","point").attr("cx",function(e){return n(e.x)}).attr("cy",function(e){return o(e.y)}).attr("r",1),_.create(t)}function h(){var t=e.getLayout(),a=u.innerHeight-180,n=u.innerWidth-t.left-t.right-40;y.w=Math.floor(n/b),y.h=Math.floor(a/Math.ceil(C.length/b)),x.css("margin-left",t.left+20).css("margin-right",t.right+20).css("width",n).css("height",a+70),A.attr("width",n).attr("height",a),A.selectAll("g.graph").data(C).enter().append("svg:g").attr("class","graph").attr("transform",function(e){return"translate("+e.col*y.w+","+e.row*y.h+")"}).each(m)}var g=t.getPatientCohort();null==g&&t.setPatientCohort([],"All Patients");var v=null==g?[]:g.ids;t.onPatientsSelect.add(function(e){v=e.ids,p()});var f=this,b=3,y={w:0,h:0},w={disease:"brain",source:"TCGA",beta:!1,name:"Brain",img:"DSbrain.png",category:[{source:"tcga",type:"color",collection:"brain_color_tcga_import"}],molecular:[{source:"ucsc",type:"cnv",collection:"brain_cnv_ucsc_gistic"},{source:"ucsc",type:"mut01",collection:"brain_mut01_ucsc_import"},{source:"cBio",type:"cnv",collection:"brain_cnv_cbio_gistic"},{source:"cBio",type:"mut",collection:"brain_mut_cbio_wxs"},{source:"cBio",type:"mut01",collection:"brain_mut01_cbio_import"},{source:"cBio",type:"methylation",collection:"brain_methylation_cbio_hm27"},{source:"cBio",type:"rna",collection:"brain_rna_cbio_rnaseq-bc"},{source:"cBio",type:"protein",collection:"brain_protein_cbio_rppa-zscore"}],clinical:{patient:"brain_patient_tcga_clinical","followUp-v1p0":"brain_followup-v1p0_tcga_clinical",drug:"brain_drug_tcga_clinical",newTumor:"brain_newtumor_tcga_clinical","otherMalignancy-v4p0":"brain_othermalignancy-v4p0_tcga_clinical",events:"brain_events_tcga_clinical"},calculated:[{source:"ucsc",type:"mds",collection:"brain_mds_ucsc_mds-allgenes-cnv-mut01"},{source:"ucsc",type:"mds",collection:"brain_mds_ucsc_mds-allgenes-cnv-mut01-10000"},{source:"ucsc",type:"mds",collection:"brain_mds_ucsc_mds-tcgagbmclassifiers-cnv-mut01"},{source:"ucsc",type:"mds",collection:"brain_mds_ucsc_mds-tcgagbmclassifiers-cnv-mut01-10000"},{source:"ucsc",type:"mds",collection:"brain_mds_ucsc_mds-markergenes545-cnv-mut01"},{source:"ucsc",type:"mds",collection:"brain_mds_ucsc_mds-markergenes545-cnv-mut01-10000"},{source:"ucsc",type:"mds",collection:"brain_mds_ucsc_mds-tcgapancanmutated-cnv-mut01"},{source:"ucsc",type:"mds",collection:"brain_mds_ucsc_mds-tcgapancanmutated-cnv-mut01-10000"},{source:"ucsc",type:"mds",collection:"brain_mds_ucsc_mds-oncovogel274-cnv-mut01"},{source:"ucsc",type:"mds",collection:"brain_mds_ucsc_mds-oncovogel274-cnv-mut01-10000"},{source:"ucsc",type:"pcaScores",collection:"brain_pcascores_ucsc_prcomp-allgenes-cnv"},{source:"ucsc",type:"pcaScores",collection:"brain_pcascores_ucsc_prcomp-allgenes-cnv-10000"},{source:"ucsc",type:"pcaScores",collection:"brain_pcascores_ucsc_prcomp-tcgagbmclassifiers-cnv"},{source:"ucsc",type:"pcaScores",collection:"brain_pcascores_ucsc_prcomp-tcgagbmclassifiers-cnv-10000"},{source:"ucsc",type:"pcaScores",collection:"brain_pcascores_ucsc_prcomp-markergenes545-cnv"},{source:"ucsc",type:"pcaScores",collection:"brain_pcascores_ucsc_prcomp-markergenes545-cnv-10000"},{source:"ucsc",type:"pcaScores",collection:"brain_pcascores_ucsc_prcomp-tcgapancanmutated-cnv"},{source:"ucsc",type:"pcaScores",collection:"brain_pcascores_ucsc_prcomp-tcgapancanmutated-cnv-10000"},{source:"ucsc",type:"pcaScores",collection:"brain_pcascores_ucsc_prcomp-oncovogel274-cnv"},{source:"ucsc",type:"pcaScores",collection:"brain_pcascores_ucsc_prcomp-oncovogel274-cnv-10000"},{source:"ucsc",type:"pcaScores",collection:"brain_pcascores_ucsc_prcomp-tcgagbmclassifiers-mut01"},{source:"ucsc",type:"pcaScores",collection:"brain_pcascores_ucsc_prcomp-tcgagbmclassifiers-mut01-10000"},{source:"ucsc",type:"pcaScores",collection:"brain_pcascores_ucsc_prcomp-tcgapancanmutated-mut01"},{source:"ucsc",type:"pcaScores",collection:"brain_pcascores_ucsc_prcomp-tcgapancanmutated-mut01-10000"},{source:"ucsc",type:"pcaScores",collection:"brain_pcascores_ucsc_prcomp-oncovogel274-mut01"},{source:"ucsc",type:"pcaScores",collection:"brain_pcascores_ucsc_prcomp-oncovogel274-mut01-10000"},{source:"cBio",type:"mds",collection:"brain_mds_cbio_mds-allgenes-cnv-mut01-cbio"},{source:"cBio",type:"mds",collection:"brain_mds_cbio_mds-allgenes-cnv-mut01-10000"},{source:"cBio",type:"mds",collection:"brain_mds_cbio_mds-tcgagbmclassifiers-cnv-mut01-cbio"},{source:"cBio",type:"mds",collection:"brain_mds_cbio_mds-tcgagbmclassifiers-cnv-mut01-10000"},{source:"cBio",type:"mds",collection:"brain_mds_cbio_mds-markergenes545-cnv-mut01-cbio"},{source:"cBio",type:"mds",collection:"brain_mds_cbio_mds-markergenes545-cnv-mut01-10000"},{source:"cBio",type:"mds",collection:"brain_mds_cbio_mds-tcgapancanmutated-cnv-mut01-cbio"},{source:"cBio",type:"mds",collection:"brain_mds_cbio_mds-tcgapancanmutated-cnv-mut01-10000"},{source:"cBio",type:"mds",collection:"brain_mds_cbio_mds-oncovogel274-cnv-mut01-cbio"},{source:"cBio",type:"mds",collection:"brain_mds_cbio_mds-oncovogel274-cnv-mut01-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-allgenes-cnv"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-allgenes-cnv-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-tcgagbmclassifiers-cnv"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-tcgagbmclassifiers-cnv-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-markergenes545-cnv"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-markergenes545-cnv-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-tcgapancanmutated-cnv"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-tcgapancanmutated-cnv-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-oncovogel274-cnv"},{source:"cBio",
type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-oncovogel274-cnv-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-allgenes-mut01"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-allgenes-mut01-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-tcgagbmclassifiers-mut01"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-tcgagbmclassifiers-mut01-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-markergenes545-mut01"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-markergenes545-mut01-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-tcgapancanmutated-mut01"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-tcgapancanmutated-mut01-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-oncovogel274-mut01"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-oncovogel274-mut01-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-allgenes-methylation"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-allgenes-methylation-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-tcgagbmclassifiers-methylation"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-tcgagbmclassifiers-methylation-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-markergenes545-methylation"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-markergenes545-methylation"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-markergenes545-methylation-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-tcgapancanmutated-methylation"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-tcgapancanmutated-methylation-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-oncovogel274-methylation"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-oncovogel274-methylation-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-allgenes-rna"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-allgenes-rna-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-tcgagbmclassifiers-rna"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-tcgagbmclassifiers-rna-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-markergenes545-rna"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-markergenes545-rna-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-tcgapancanmutated-rna"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-tcgapancanmutated-rna-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-oncovogel274-rna"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-oncovogel274-rna-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-allgenes-protein"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-allgenes-protein-10000"}],edges:[{name:"TCGA GBM classifiers",source:"ucsc",edges:"brain_edges_ucsc_tcgagbmclassifiers-mut01-cnv",patientWeights:"brain_ptdegree_ucsc_tcgagbmclassifiers-mut01-cnv",genesWeights:"brain_genedegree_ucsc_tcgagbmclassifiers-mut01-cnv"},{name:"Marker genes 545",source:"ucsc",edges:"brain_edges_ucsc_markergenes545-mut01-cnv",patientWeights:"brain_ptdegree_ucsc_markergenes545-mut01-cnv",genesWeights:"brain_genedegree_ucsc_markergenes545-mut01-cnv"},{name:"TCGA pancan mutated",source:"ucsc",edges:"brain_edges_ucsc_tcgapancanmutated-mut01-cnv",patientWeights:"brain_ptdegree_ucsc_tcgapancanmutated-mut01-cnv",genesWeights:"brain_genedegree_ucsc_tcgapancanmutated-mut01-cnv"},{name:"oncoVogel274",source:"ucsc",edges:"brain_edges_ucsc_oncovogel274-mut01-cnv",patientWeights:"brain_ptdegree_ucsc_oncovogel274-mut01-cnv",genesWeights:"brain_genedegree_ucsc_oncovogel274-mut01-cnv"},{name:"TCGA GBM classifiers",source:"cbio",edges:"brain_edges_cbio_tcgagbmclassifiers-mut01-cnv",patientWeights:"brain_ptdegree_cbio_tcgagbmclassifiers-mut01-cnv",genesWeights:"brain_genedegree_cbio_tcgagbmclassifiers-mut01-cnv"},{name:"Marker genes 545",source:"cbio",edges:"brain_edges_cbio_markergenes545-mut01-cnv",patientWeights:"brain_ptdegree_cbio_markergenes545-mut01-cnv",genesWeights:"brain_genedegree_cbio_markergenes545-mut01-cnv"},{name:"TCGA pancan mutated",source:"cbio",edges:"brain_edges_cbio_tcgapancanmutated-mut01-cnv",patientWeights:"brain_ptdegree_cbio_tcgapancanmutated-mut01-cnv",genesWeights:"brain_genedegree_cbio_tcgapancanmutated-mut01-cnv"},{name:"oncoVogel274",source:"cbio",edges:"brain_edges_cbio_oncovogel274-mut01-cnv",patientWeights:"brain_ptdegree_cbio_oncovogel274-mut01-cnv",genesWeights:"brain_genedegree_cbio_oncovogel274-mut01-cnv"}]},x=angular.element("#compareclusterChart"),A=a.select("#compareclusterChart").append("svg:svg");f.allClusters=w.calculated.map(function(e){return e.selected=!0,e});var C=f.allClusters.filter(function(e){return-1!=e.collection.indexOf("ucsc")}).filter(function(e){return"mds"==e.type});C.pop();var _=function(e,t,a){var n=[],o=function(){null!==e.event.selection&&(n.filter(function(t){return t.brush!==e.event.target}).forEach(function(e){e.rect.call(e.brush.move,null)}),n.filter(function(t){return t.brush===e.event.target}).forEach(function(e){e.brush.on("end",r)}))},r=function(){if(null===e.event.selection)return void a.setPatientCohort([],"Clusters");var o=e.event.selection,r=o[0][0],i=o[1][0],s=o[0][1],l=o[1][1],c=n.filter(function(t){return t.brush===e.event.target})[0];c.brush.on("end",null);var d=c.rect.data()[0],u=e.scaleLinear().domain(d.xDomain).range([0,t.w]),p=e.scaleLinear().domain(d.yDomain).range([0,t.h]),m=d.data.filter(function(e){var t=u(e.x),a=p(e.y);return t>r&&i>t&&a>s&&l>a}).map(function(e){return e.id});a.setPatientCohort(m,"Clusters")},i=function(t){var a=e.brush().on("start",o);t.call(a),n.push({brush:a,rect:t})},s=function(){},l=function(){};return{create:i,clear:s,destory:l}}(a,y,t);d.all(C.map(function(t){return e.query(t.collection)})).then(function(e){C=C.map(function(e,t){var n=this.data[t].data[0].data,o={name:e,data:Object.keys(n).reduce(function(e,t){var a=e.data[t];return e.value.push({id:t,x:a.x,y:a.y}),e},{data:n,value:[]}).value,xDomain:null,yDomain:null,col:t%this.rows,row:parseInt(t/this.rows)},r=function(e){return e.x},i=function(e){return e.x};return o.xDomain=[a.min(o.data,r),a.max(o.data,r)],o.yDomain=[a.min(o.data,i),a.max(o.data,i)],o},{data:e,rows:b}),h()});var k=function(){var t=e.getLayout(),n=u.innerHeight-180,o=u.innerWidth-t.left-t.right-40;y.w=Math.floor(o/b),y.h=Math.floor(n/Math.ceil(C.length/b)),x.css("margin-left",t.left+20).css("margin-right",t.right+20).css("width",o).css("height",n+70),A.attr("width",o).attr("height",n),A.selectAll("g.graph").attr("transform",function(e){return"translate("+e.col*y.w+","+e.row*y.h+")"}).each(function(e){var t=a.scaleLinear().domain(e.xDomain).range([0,y.w]),n=a.scaleLinear().domain(e.yDomain).range([0,y.h]),o=a.select(this);o.select(".cell").attr("width",y.w).attr("height",y.h),o.selectAll(".point").attr("cx",function(e){return t(e.x)}).attr("cy",function(e){return n(e.y)}).attr("r",1)})};e.onResize.add(k),angular.element(u).bind("resize",l.debounce(k,300))}e.$inject=["osApi","osCohortService","d3","$state","$timeout","$scope","moment","$stateParams","_","$","$q","$window"];var t={restrict:"E",templateUrl:"app/components/compareclusters/compareclusters.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osCompareCluster",e)}(),function(){"use strict";function e(){function e(e,t,a,n){var o=this;o.showPanelColorRna=!1,o.colorScales=[{name:"Quantile"},{name:"Quantize"}],o.colorScale=o.colorScales[0],o.colorBins=[2,3,4,5,6,7,8].map(function(e){return{name:e+" Bins",value:e}}),o.colorBin=o.colorBins[2],o.colorOptions=e.getDataSource().colors,0!=o.colorOptions.length&&(o.colorOption=o.colorOptions[0]);var r=e.getDataSource().category.filter(function(e){return"color"==e.type})[0].collection;e.query(r,{type:"color",dataset:e.getDataSource().disease,$fields:["name","subtype"]}).then(function(e){var t=e.data.reduce(function(e,t){return e.hasOwnProperty(t.subtype)||(e[t.subtype]=[]),e[t.subtype].push(t),e},{});o.optPatientColors=Object.keys(t).map(function(e){return{name:e,values:this[e].sort(function(e,t){return e.name>t.name?1:e.name<t.name?-1:0})}},t)}),o.setColor=function(a){return"None"==a.name?void t.setPatientColor({dataset:e.getDataSource().disease,type:"color",name:"None",data:[],show:!0}):void e.query(r,{type:"color",dataset:e.getDataSource().disease,name:a.name}).then(function(e){var a=e.data[0];a.data=a.data.map(function(e){var t=e.name.toLowerCase().trim();return(""==t||"null"==t||"undefined"==t)&&(e.name="Null",e.color="#DDDDDD"),e.id="legend-"+e.color.substr(1),e}).sort(function(e,t){var a=isNaN(e.name)?e.name:parseInt(e.name),n=isNaN(t.name)?t.name:parseInt(t.name);return n>a?-1:a>n?1:"Null"==e.name?1:"Null"==t.name?-1:0}),t.setPatientColor(e.data[0]),o.close()})},o.setGeneColor=function(){var r=("+"+o.geneColor.replace(/\s/g,"").toUpperCase()).match(/[-+]\w*/gi).map(function(e){return{op:e.substr(0,1),gene:e.substr(1)}});e.query(o.colorOption.collection,{gene:{$in:r.map(function(e){return e.gene})}}).then(function(i){if(i.data.length>0){var s;if(1==i.data.length)s=i.data[0];else{s={},s.patients=i.data.reduce(function(e,t){for(var a=e.lookup[t.gene],n=0;n<e.pids.length;n++){var o=e.pids[n],r=e.output.hasOwnProperty(o)?e.output[o]:0;"+"===a&&(e.output[o]=r+t.patients[o]),"-"===a&&(e.output[o]=r-t.patients[o])}return e},{pids:Object.keys(i.data[0].patients),lookup:r.reduce(function(e,t){return e[t.gene]=t.op,e},{}),output:{}}).output;var l=Object.keys(s.patients).reduce(function(e,t){return e.min=Math.min(e.min,e.values[t]),e.max=Math.max(e.min,e.values[t]),e},{values:s.patients,min:1/0,max:-(1/0)});s.min=l.min,s.max=l.max}var c,d=["#9d1cb2","#00a7f7","#3d4eb8","#ff9900","#f7412d","#795548","#E91E63","#673AB7"],u=d.splice(0,o.colorBin.value),p="Quantile"==o.colorScale.name?a.scaleQuantile():a.scaleQuantize();"Quantile"==o.colorScale.name?(p.domain(Object.keys(s).map(function(e){return s[e]},{data:s})).range(u),c=p.quantiles().map(function(e){return parseFloat(e).toFixed(3)}),c.unshift(""),c=c.map(function(e,t,a){return 0==t?"-  "+a[1]:t==a.length-1?a[t]+"  +":a[t]+"  "+a[t+1]}),u=n.zip(u,c).map(function(e){return{color:e[0],name:e[1]}})):(p.domain([s.min,s.max]).range(u),c=p.ticks(u.length).map(function(e){return"~"+parseFloat(e).toFixed(2)}),u=n.zip(u,c).map(function(e){return{color:e[0],name:e[1]}})),s=Object.keys(s.patients).map(function(e){return{id:e,color:this.scale(this.patients[e]),value:this.patients[e]}},{patients:s.patients,scale:p}).reduce(function(e,t){return e.hasOwnProperty(t.color)||(e[t.color]=[]),e[t.color].push(t.id),e},{}),s=Object.keys(s).map(function(e){return{color:e,name:this.names.filter(function(e){return e.color==this.color},{color:e})[0].name,values:this.data[e]}},{data:s,names:u}),s=s.sort(function(e,t){return-1!=e.name.indexOf("-")?-1:-1!=t.name.indexOf("-")?1:-1!=e.name.indexOf("+")?1:-1!=t.name.indexOf("+")?-1:e.name<t.name?-1:e.name>t.name?1:0}),s.push({color:"#DDD",name:"Null",values:[]});var d={dataset:e.getDataSource().disease,type:"color",name:r.reduce(function(e,t){return e+=t.op+t.gene+" "},""),data:s};t.setPatientColor(d)}})}}e.$inject=["osApi","osCohortService","d3","_"];var t={restrict:"E",templateUrl:"app/components/colorpanel/colorpanel.html",controller:e,controllerAs:"vm",bindToController:!0,scope:{close:"&"}};return t}angular.module("oncoscape").directive("osColorPanel",e)}(),function(){"use strict";function e(){function e(e,t,a,n,o,r,i){var s=this;s.cohorts=[],s.patientChartOption=null,s.cohortName="",s.addCohort=function(){},s.setCohort=function(){},s.removeCohort=function(){},s.editItem={name:""},s.editCohort=function(e){s.editItem=e,s.edit=!0},s.show=!1,s.edit=!1,t.onCohortsChange.add(function(e){s.cohorts=e,s.show=!0,s.showPatientHistory(),t.setPatientCohort([],"All Patients")}),r.$on("$stateChangeStart",function(e,t){switch(t.name){case"landing":case"tools":case"datasource":s.show=!1;break;default:s.show=!0}});var l=angular.element(".cohort-menu"),c=function(){l.removeClass("tray-collapsed-left")},d=function(){l.addClass("tray-collapsed-left")},u=angular.element("#cohort-tab-patients"),p=angular.element("#cohort-tab-genes");s.showPatientHistory=function(){u.addClass("active"),p.removeClass("active"),s.cohorts=t.getPatientCohorts(),s.addCohort=t.addPatientCohort,s.setCohort=t.setPatientCohort,s.removeCohort=t.delPatientCohort},s.showGeneHistory=function(){p.addClass("active"),u.removeClass("active"),s.cohorts=t.getGeneCohorts(),s.addCohort=t.addGeneCohort,s.setCohort=t.setGeneCohort,s.removeCohort=t.delGeneCohort};var m=!0;s.toggle=function(){m=!m,angular.element("#cohortmenu-lock").addClass(m?"fa-lock":"fa-unlock-alt").removeClass(m?"fa-unlock-alt":"fa-lock").attr("locked",m?"true":"false"),m?l.unbind("mouseover",c).unbind("mouseout",d).removeClass("tray-collapsed-left"):l.addClass("tray-collapsed-left").bind("mouseover",c).bind("mouseout",d),e.onResize.dispatch()};var h=function(e){if("numeric"==s.patientChartOption.type){var a=e.label.split("-").map(function(e){return parseInt(e)}),n=s.patientChartOption.prop;t.filterActivePatientCohort(a,n,s.patientChartOption.type)}},g=i.select("#cohortmenu-chart").append("svg").attr("width",238).attr("height",150).append("g");n.$watch("vm.patientChartOption",function(){if(null!=s.patientChartOption){var e=s.patientChartOption.data,t=Math.floor(238/e.bins);e.histRange[0]>0&&(e.histRange[0]-=2);var a=i.scaleLinear().domain([0,e.histRange[1]]).range([0,135]),n=g.selectAll(".cohort-menu-chart-bar").data(e.hist);n.enter().append("rect").attr("class","cohort-menu-chart-bar").attr("x",function(e,a){return(t+1)*a}).attr("y",function(e){return 150-a(e.value)}).attr("height",function(e){return a(e.value)}).attr("width",t).on("click",h),n.transition().duration(300).attr("x",function(e,a){return(t+1)*a}).attr("y",function(e){return 150-a(e.value)}).attr("height",function(e){return a(e.value)}).attr("width",t),n.exit().transition().duration(300).attr("y",150).attr("height",0).style("fill-opacity",1e-6).remove();var o=g.selectAll("text").data(e.hist);o.enter().append("text").attr("x",function(e,a){return(t+1)*a+.5*t}).attr("y",function(e){return 145-a(e.value)}).attr("fill","#000").attr("height",function(e){return a(e.value)}).attr("width",t).attr("font-size","8px").attr("text-anchor","middle").text(function(e){return e.label}),o.transition().duration(300).attr("x",function(e,a){return(t+1)*a+.5*t}).attr("y",function(e){var t=145-a(e.value);return 0>t&&(t=20),t}).text(function(e){return e.label}),o.exit().transition().duration(300).attr("y",150).attr("height",0).style("fill-opacity",1e-6).remove()}});var v=i.select("#cohortmenu-survival").append("svg"),f={width:238,height:170,xScale:null,yScale:null},b=function(e){var t=i.line().x(function(e){return f.xScale(e[0])}).y(function(e){return f.yScale(e[2])+10});v.append("path").attr("class","line").attr("stroke-width",e.weight).attr("stroke",e.color).attr("fill","none").attr("d",t(e.data.line));for(var a=0;a<e.data.tick.length;a++)v.append("line").attr("class","line").attr("stroke-width",e.weight).attr("stroke",e.color).attr("x1",f.xScale(e.data.tick[a][0])).attr("x2",f.xScale(e.data.tick[a][0])).attr("y1",f.yScale(e.data.tick[a][2])+5).attr("y2",f.yScale(e.data.tick[a][2])+10)};t.onMessage.add(function(e){if("getSurvivalData"==e.data.cmd){var t=e.data.data;if("CohortMenuController"==t.correlationId){v.attr("width","100%").attr("height",f.height+10),f.xScale=i.scaleLinear().domain([e.data.data.min,e.data.data.max]).range([0,f.width]),f.yScale=i.scaleLinear().domain([0,100]).range([f.height,0]),v.selectAll(".line").remove();for(var a=0;a<t.cohorts.length;a++)a<t.cohorts.length-1?t.cohorts[a].weight=1:t.cohorts[a].weight=1.5,b(t.cohorts[a])}}}),t.onPatientsSelect.add(function(e){angular.isUndefined(e.color)&&(e.color="#000"),s.cohortName=e.name,t.getPatientMetric();var a=JSON.parse(JSON.stringify(t.getPatientCohorts()));a.push(e),t.getSurvivalData(a,!0,"CohortMenuController")}),t.onGenesSelect.add(function(){}),t.onMessage.add(function(e){"setPatientMetric"==e.data.cmd&&o(function(){s.patientTotal=e.data.data.total,s.patientSelected=e.data.data.selected,s.patientChartOptions=e.data.data.features,s.patientChartOption=null==s.patientChartOption?s.patientChartOptions[0]:s.patientChartOptions.filter(function(e){return e.label==this.label},s.patientChartOption)[0]})}),s.showPatientHistory()}e.$inject=["osApi","osCohortService","$state","$scope","$timeout","$rootScope","d3"];var t={restrict:"E",templateUrl:"app/components/cohortmenu/cohortmenu.html",controller:e,controllerAs:"vm",scope:{},bindToController:!0};return t}angular.module("oncoscape").directive("osCohortMenu",e)}(),function(){"use strict";function e(){function e(e,t,a,n,o){function r(){clearTimeout(S),"grouped"===this.value?i():s()}function i(){w.domain([0,h]),k.transition().duration(500).delay(function(e,t){return 10*t}).attr("x",function(e,t,a){return y(e.x)+y.rangeBand()/d*a}).attr("width",y.rangeBand()/d).transition().attr("y",function(e){return w(e.y)}).attr("height",function(e){return b-w(e.y)})}function s(){w.domain([0,g]),k.transition().duration(500).delay(function(e,t){return 10*t}).attr("y",function(e){return w(e.y0+e.y)}).attr("height",function(e){return w(e.y0)-w(e.y0+e.y)}).transition().attr("x",function(e){return y(e.x)}).attr("width",y.rangeBand())}function l(e,t){function a(t){for(var a=1/(.1+Math.random()),n=2*Math.random()-.5,o=10/(.1+Math.random()),r=0;e>r;r++){var i=(r/e-n)*o;t[r]+=a*Math.exp(-i*i)}}var n,o=[];for(n=0;e>n;++n)o[n]=t+t*Math.random();for(n=0;5>n;++n)a(o);return o.map(function(e,t){return{x:t,y:Math.max(0,e)}})}var c=this;c.datasource=t.getDataSource();var d=5,u=58,p=e.layout.stack(),m=p(e.range(d).map(function(){return l(u,.1)})),h=e.max(m,function(t){return e.max(t,function(e){return e.y})}),g=e.max(m,function(t){return e.max(t,function(e){return e.y0+e.y})}),v={top:40,right:10,bottom:20,left:10},f=960-v.left-v.right,b=500-v.top-v.bottom,y=e.scaleOrdinal().domain(e.range(u)).rangeRoundBands([0,f],.08),w=e.scaleLinear().domain([0,g]).range([b,0]),x=e.scaleLinear().domain([0,d-1]).range(["#aad","#556"]),A=e.svg.axis().scale(y).tickSize(0).tickPadding(6).orient("bottom"),C=e.select("body").append("svg").attr("width",f+v.left+v.right).attr("height",b+v.top+v.bottom).append("g").attr("transform","translate("+v.left+","+v.top+")"),_=C.selectAll(".layer").data(m).enter().append("g").attr("class","layer").style("fill",function(e,t){return x(t)}),k=_.selectAll("rect").data(function(e){return e}).enter().append("rect").attr("x",function(e){return y(e.x)}).attr("y",b).attr("width",y.rangeBand()).attr("height",0);k.transition().delay(function(e,t){return 10*t}).attr("y",function(e){return w(e.y0+e.y)}).attr("height",function(e){return w(e.y0)-w(e.y0+e.y)}),C.append("g").attr("class","x axis").attr("transform","translate(0,"+b+")").call(A),e.selectAll("input").on("change",r);var S=o(function(){e.select('input[value="grouped"]').property("checked",!0).each(r)},2e3)}e.$inject=["d3","osApi","osCohortService","$state","$timeout"];var t={restrict:"E",templateUrl:"app/components/barchart/barchart.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osBarchart",e)}(),function(){"use strict";function e(e,t,a,n,o,r){a.onerror=function(e,t,a,o,r){r||(r=new Error(e),r.fileName=t,r.lineNumber=a,r.columnNumber=o||0),n(r)};var i=e.$on("$stateChangeStart",function(e,a,n){return o.setBusy(!1),a.authenticate&&!r.isAuthenticated()?(t.transitionTo("landing"),void e.preventDefault()):a.datasource&&(angular.isUndefined(n.datasource)||""===n.datasource)?(t.transitionTo("datasource"),void e.preventDefault()):void o.setDataSource(n.datasource)});e.$on("$destroy",i)}e.$inject=["$rootScope","$state","$window","$exceptionHandler","osApi","osAuth"],angular.module("oncoscape").run(e)}(),function(){"use strict";function e(e,t){e.state("landing",{url:"/",template:"<os-landing>",authenticate:!1,datasource:!1}).state("datasource",{url:"/datasource",template:"<os-datasource>",authenticate:!0,datasource:!1}).state("tools",{url:"/tools/{datasource}",template:"<os-tools>",authenticate:!0,datasource:!0}).state("history",{url:"/history/{datasource}",template:"<os-history>",authenticate:!0,datasource:!0}).state("plsr",{url:"/plsr/{datasource}",template:"<os-plsr>",authenticate:!0,datasource:!0}).state("pca",{url:"/pca/{datasource}",template:"<os-pca>",authenticate:!0,datasource:!0}).state("comparecluster",{url:"/comparecluster/{datasource}",template:"<os-compare-cluster>",authenticate:!0,datasource:!0}).state("markers",{url:"/markers/{datasource}",template:"<os-markers>",authenticate:!0,datasource:!0}).state("pathways",{url:"/pathways/{datasource}",template:"<os-pathways>",authenticate:!0,datasource:!0}).state("timelines",{url:"/timelines/{datasource}",template:"<os-timelines>",authenticate:!0,datasource:!0}).state("survival",{url:"/survival/{datasource}",template:"<os-survival>",authenticate:!0,datasource:!0}).state("sunburst",{url:"/sunburst/{datasource}",template:"<os-sunburst>",authenticate:!0,datasource:!0}).state("heatmap",{url:"/heatmap/{datasource}",template:"<os-heatmap>",authenticate:!1,datasource:!1}).state("barcharts",{url:"/barchart/{datasource}",template:"<os-barchart>",authenticate:!0,datasource:!0}),t.otherwise("/")}e.$inject=["$stateProvider","$urlRouterProvider"],angular.module("oncoscape").config(e)}(),function(){"use strict";angular.module("oncoscape").constant("moment",moment).constant("d3",d3).constant("cytoscape",cytoscape).constant("signals",signals).constant("$",$).constant("auth",hello).constant("Handsontable",Handsontable).constant("localStorage",localStorage).constant("_",_)}(),function(){"use strict";function e(e){e.debugEnabled(!1)}e.$inject=["$logProvider"],angular.module("oncoscape").config(e)}(),angular.module("oncoscape").run(["$templateCache",function(e){e.put("app/components/cohortmenu/cohortmenu.html",'<div ng-show="vm.show" id="cohortMenu"><label class="tray-label tray-label-left"><i class="fa fa-chevron-right" aria-hidden="true"></i></label><div class="cohort-menu tray tray-left"><section><div class="row"><div class="col-xs-12 form-item"><ul class="nav nav-tabs"><li id="cohort-tab-patients" role="presentation" style="width:50%;text-align:center;" ng-click="vm.showPatientHistory()"><a>Patients</a></li></ul><div style="background-color:#ffffff;border:#dddddd 1px solid;border-top-width:0px;padding:10px;"><br><div id="cohortmenu-chart" style="width:100%;height:150px;"></div><div class="dropdown" style="width:100%"><button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown" style="width:100%;">{{vm.patientChartOption.label}} <span class="caret"></span></button><ul class="dropdown-menu"><li style="padding:0px 5px;" ng-repeat="item in vm.patientChartOptions" ng-click="vm.patientChartOption=item">{{item.label}}</li></ul></div><br><div id="cohortmenu-survival" style="border:0px solid #DDD;width:100%;height:180px;"></div><br><div class="legend-bar ng-binding ng-scope" style="border-color:#000; position: relative; padding: 2px 10px; line-height: 25px; background-color: rgb(255, 255, 255);"><button class="btn-xs btn btn-default" style="float:right;" ng-click="vm.addCohort()" tooltip="Save Cohort"><i style="color:#0b97d3" class="glyphicon glyphicon-plus"></i></button> <label>Selected Patients</label></div><div ng-if="vm.cohorts.length>0 && !vm.edit"><div ng-repeat="cohort in vm.cohorts track by $index" class="legend-bar ng-binding ng-scope" style="border-color:{{cohort.color}}; position: relative; padding: 2px 10px; line-height: 25px; background-color: rgb(255, 255, 255);"><button class="btn-xs btn btn-default" style="float:right;" ng-click="vm.editCohort(cohort)"><i style="color:#0b97d3" class="glyphicon glyphicon-edit"></i></button> <a class="markers-command hvr-sweep-to-right" style="margin-right:25px;" ng-click="vm.setCohort(cohort)">{{cohort.name}} ({{cohort.ids.length}})</a></div></div><div class="legend-bar ng-binding ng-scope" style="border-color:#0b97d3; position: relative; padding: 2px 10px; line-height: 25px; background-color: rgb(255, 255, 255);"><label>All Patients</label></div><br><div ng-if="vm.edit"><hr><div class="legend-bar ng-binding ng-scope" style="border-color:{{vm.editItem.color}}; position: relative; padding: 2px 10px; line-height: 25px; background-color: rgb(255, 255, 255);"><label>Edit Cohort</label></div><div class="row"><div class="col-xs-12 form-group" style="margin-top:10px;"><input type="text" class="form-control" ng-model="vm.editItem.name"></div><div class="col-xs-12 form-group" style="text-align:right"><button class="btn btn-sm btn-default" style="width:80px" ng-click="vm.removeCohort(vm.editItem);vm.edit=false;">Remove</button> <button class="btn btn-sm btn-primary" style="width:80px" ng-click="vm.edit=false">Done</button></div></div></div></div></div></div><div id="cohortmenu-legand"></div><i id="cohortmenu-lock" class="fa fa-lock tray-sticky-icon" ng-click="vm.toggle()" locked="true"></i></section></div></div>'),e.put("app/components/barchart/barchart.html",'<os-tray content="tray-content-block" change="vm.resize($event)"><section class="tray-content"><div class="row"><div class="col-xs-12 form-item"><br><label></label></div></div></section></os-tray><section class="tray-content-block"><div style="position:absolute;top:10px;text-align:center;width:100%;"><h2 class="h2-tool">Heatmap</h2><span class="h3-tool">{{vm.datasource.source}} {{vm.datasource.name}}</span><div id="barchart-chart"></div></div></section>'),e.put("app/components/colorpanel/colorpanel.html",'<div class="panel panel-default mdi" style="padding-bottom:30px;"><div class="panel-heading"><h3 class="panel-title">Patient Color Options</h3><span class="pull-right clickable" data-effect="fadeOut" ng-click="vm.close()"><i class="fa fa-times"></i></span></div><div class="panel-body"><div class="row" ng-if="vm.colorOptions.length>0"><div class="col-xs-12 col-sm-9"><h3>Enter Hugo Gene(s) Seperated By + And - Operators. (eg BRCA1 + BRCA2 - p53)</h3><div class="input-group"><div class="input-group-btn"><button style="width:150px;" type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">{{vm.colorOption.name}}&nbsp;<span class="caret"></span></button><ul class="dropdown-menu"><li ng-click="vm.colorOption=item;" ng-repeat="item in vm.colorOptions">{{item.name}}</li></ul></div><div class="input-group-btn"><button style="width:100px;" type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">{{vm.colorScale.name}}&nbsp;<span class="caret"></span></button><ul class="dropdown-menu"><li ng-click="vm.colorScale=item;" ng-repeat="item in vm.colorScales">{{item.name}}</li></ul></div><div class="input-group-btn"><button style="width:100px;border-radius:0px;" type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">{{vm.colorBin.name}}&nbsp;<span class="caret"></span></button><ul class="dropdown-menu"><li ng-click="vm.colorBin=item;" ng-repeat="item in vm.colorBins">{{item.name}}</li></ul></div><input ng-model="vm.geneColor" type="text" class="form-control" placeholder="Hugo Gene Symbol" style="border-right-width: 0px; border-left-width: 0px; height:33px;"> <span class="input-group-btn"><button class="btn btn-default" type="button" ng-click="vm.setGeneColor()">Submit</button></span></div></div></div><div class="row"><h3 class="col-sm-3" ng-repeat="item in vm.optPatientColors">{{item.name}}<br><div ng-repeat="color in item.values"><a href="" style="font-size:12px;" class="hvr-sweep-to-right markers-command" ng-click="vm.setColor(color)">{{color.name}}</a></div></h3></div></div><div style="position:absolute;bottom:0px;width:100%;padding:10px;font-size:10px;text-align:center;">Percentages Indicate Data Availibility</div></div>'),e.put("app/components/compareclusters/compareclusters.html",'<os-tray caption="Patients" content="tray-content-block"><section class="tray-content"><div class="row"><br><br><div ng-if="vm.legendCaption.length>0" class="col-xs-12 form-item"><label>Patient {{vm.legendCaption}}</label><div ng-repeat="item in vm.legendNodes" class="legend-bar" style="border-color:{{item.color}};position:relative;background-color:#FFF;padding:2px 10px;line-height:25px;">{{item.name}}</div></div><div class="col-xs-12 form-item"><label>Patient</label> <button class="btn btn-default btn-no-focus" type="button" style="width:100%;font-weight: 300;" ng-click="vm.showPanelColor = true">Color Options</button></div><div class="col-xs-12 form-item"><label>Grid</label> <button class="btn btn-default btn-no-focus" type="button" style="width:100%;font-weight: 300;" ng-click="vm.showPanelColor = true">Layout Options</button></div></div></section></os-tray><section class="tray-content-block"><div style="position:absolute;top:10px;text-align:center;width:100%;"><h2 class="h2-tool">Compare Clusters</h2><span class="h3-tool">{{vm.datasource.source}} {{vm.datasource.name}}</span><br><div id="compareclusterChart" class="pca"></div></div></section>'),e.put("app/components/header/header.html",'<div class="header"><nav class="navbar navbar-inverse navbar-fixed-top"><div class="container-fluid"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button> <a class="navbar-brand" href="#"><img alt="Brand" src="/assets/images/logo.png" style="max-height:50px;"></a></div><div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1"><ul class="nav navbar-nav navbar-right"><li class="dropdown" ng-show="vm.showTools"><a href="" class="dropdown-toggle header-link" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><span class="glyphicon glyphicon-stats"></span>Analysis Tools</a><ul class="dropdown-menu"><li class="header-dropdown-menu-li" ng-repeat="item in vm.tools" ng-click="vm.loadTool(item.route)"><a><img class="header-dropdown-img" ng-src="/assets/images/{{item.img}}">{{item.name}}</a></li></ul></li><li class="dropdown" ng-show="vm.showDatasets"><a href="" class="dropdown-toggle header-link" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><span class="glyphicon glyphicon-th"></span>Data Sources</a><ul class="dropdown-menu" roll="menu"><li class="header-dropdown-menu-li" ng-repeat="item in vm.datasets" ng-click="vm.loadDataset(item.disease)"><a><img class="header-dropdown-img" ng-src="/assets/images/{{item.img}}">{{item.name}}</a></li></ul></li><li class="dropdown" ng-show="vm.showCohorts"><a href="" class="dropdown-toggle header-link" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><span class="fa fa-users"></span>My Cohorts</a><div class="dropdown-menu container-fluid"><div class="row"><div ng-if="!vm.showImport" class="col-xs-12 col-sm-4" style="border:0px solid #DDD; border-right-width:1px;"><h2 style="margin-top:0px;">Create A Cohort</h2>Oncoscape allows you to pass cohorts of patients from one tool to the next. To create a cohort out of your current selection click<br><button class="btn btn-primary" style="margin-top:15px;" ng-click="vm.addPatientCohort(); $event.stopPropagation();">Create Cohort</button> <button class="btn btn-primary" style="margin-top:15px;" ng-click="vm.showImport=true; $event.stopPropagation();">Import Cohort</button></div><div ng-if="vm.showImport" class="col-xs-12 col-sm-4" style="border:0px solid #DDD; border-right-width:1px;"><h2 style="margin-top:0px;">Import A Cohort</h2>Enter a comma seperated list of patient IDs below and click save<br><input ng-model="vm.importPatientIds" type="text" class="form-control" style="margin-top:5px;" placeholder="eg. TCGA-01-0110, TCGA-02-0220"> <button class="btn btn-primary" style="margin-top:15px;" ng-click="vm.importPatientCohort(); $event.stopPropagation();">Save</button> <button class="btn btn-primary" style="margin-top:15px;" ng-click="vm.showImport=false; $event.stopPropagation();">Cancel</button></div><div class="col-xs-12 col-sm-8"><h2 style="margin-top:0px;">Your Cohorts</h2><div class="markers-command hvr-sweep-to-right" style="max-width:200px;" ng-repeat="item in vm.cohorts" ng-click="vm.setPatientCohort(item)">{{item.name}} ({{item.ids.length}})</div></div></div></div></li><li ng-show="vm.showHelp"><a href="http://resources.sttrcancer.org/oncoscape" target="_blank" class="header-link"><span class="glyphicon glyphicon-question-sign"></span>Help</a></li><li ng-show="vm.showLogout"><a href="" ng-click="vm.logoutClick()" class="header-link"><span class="glyphicon glyphicon-user"></span>Logout</a></li></ul></div></div><div class="nav-divider"></div></nav></div>'),
e.put("app/components/datasource/datasource.html",'<section class="datasource container-fluid"><div class="row"><div class="col-sm-12 col-md-6"><br><h1>Step 1: Select A Data Source</h1><p>Oncoscape supports both public and private data sets. If you do not see the dataset you are interested in please contact us at <a href="mailto:oncoscape@fredhuth.org">oncoscape@fredhutch.org</a>. To explore a new dataset use the naviation item in the top right.</p></div></div><div class="row"><ul><li ng-repeat="dataset in vm.datasets" class="col-xs-12 col-sm-6 col-lg-4" ng-click="vm.explore(\'tools\',dataset)"><img class="datasource-img" ng-src="/assets/images/{{dataset.img}}"><h3 class="datasource-lbl">{{dataset.name}} ({{dataset.source}})</h3><nobr><a href="">Explore</a></nobr></li></ul></div></section>'),e.put("app/components/heatmap/heatmap.html",'<os-tray content="tray-content-block" change="vm.resize($event)"><section class="tray-content"><div class="row"><div class="col-xs-12 form-item"><br><label></label></div></div></section></os-tray><section class="tray-content-block"><div style="position:absolute;top:10px;text-align:center;width:100%;"><h2 class="h2-tool">Heatmap</h2><span class="h3-tool">{{vm.datasource.source}} {{vm.datasource.name}}</span><div id="heatmap-chart" style="width:500px;height:500px;"></div><div id="tooltip" class="hidden"><p><span id="value"></span></p></div></div></section>'),e.put("app/components/history/history.html",'<os-tray caption="Patients" content="tray-content-block"><section class="tray-content"><div class="row"><br><br><div class="col-xs-12 form-item"><label>Clinical Collections</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.collection.name}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li ng-repeat="item in vm.collections" ng-click="vm.collection=item">{{item.name}}</li></ul></div></div><div class="col-xs-6 form-item" style="padding-right:5px"><label>Search</label> <input type="text" class="form-control" ng-model-options="{ debounce: 200 }" ng-model="vm.search" placeholder=""></div><div class="col-xs-6 form-item" style="padding-left:5px"><label>Export</label> <button class="btn btn-default btn-no-focus" type="button" style="width:100%;font-weight: 300;" ng-click="vm.exportCsv()">CSV</button></div></div><div class="row"><div class="col-xs-6 form-item" style="padding-right:5px"><label>Patient</label> <button class="btn btn-default btn-no-focus" type="button" style="width:100%;font-weight: 300;" ng-click="vm.showPanelColor = true">Color Options</button></div><div class="col-xs-6 form-item" style="padding-left:5px"><label>Patients</label> <button class="btn btn-default btn-no-focus" type="button" style="width:100%;font-weight: 300;" ng-click="vm.resetFilter()">Show All</button></div><div ng-if="vm.legendNodes.length>0" class="col-xs-12 form-item"><label>Patient {{vm.legendCaption}}</label><div ng-repeat="item in vm.legendNodes" class="legend-bar legend-bar-button" style="border-color:{{item.color}};">{{item.name}}<span id="{{item.id}}" class="legend-count"></span></div></div><div class="col-xs-12 form-item"><label>Fields</label><div ng-repeat="column in vm.columns track by $index" class="legend-bar" style="position:relative;background-color:#FFF;padding:2px 10px;line-height:25px;border-left-width: 0;"><span style="max-width: 180px;font-size:12px;display: inline-block;">{{column.displayName}}</span> <label class="switch {{item.class}}" style="float:right"><input type="checkbox" class="switch-input" ng-model="column.show" ng-change="vm.setColumns(true)"> <span class="switch-label" data-on="On" data-off="Off"></span> <span class="switch-handle"></span></label></div></div><div ng-if="vm.legendCaption.length>0" class="col-xs-12 form-item"><label>Patient {{vm.legendCaption}}</label><div ng-repeat="item in vm.legendNodes" class="legend-bar" style="border-color:{{item.color}};position:relative;background-color:#FFF;padding:2px 10px;line-height:25px;">{{item.name}}</div></div></div></section></os-tray><section class="history-content history-grid-container"><div class="container-fluid" style="text-align:center;"><h2 class="h2-tool">Patient Data</h2><span class="h3-tool">{{vm.datasource.source}} {{vm.datasource.name}}</span><div id="history-grid"></div></div></section><os-color-panel ng-if="vm.showPanelColor" close="vm.showPanelColor=false"></os-color-panel>'),e.put("app/components/landing/landing.html",'<div class="landing container"><div class="row" style="padding-top:20px;"><div class="col-sm-12"><h2>Bridging Cancer Research and Clinical Care</h2></div></div><div class="row" style="padding-top:20px;"><div class="col-sm-7"><p class="landing-copy">Oncoscape is developed at the Fred Hutchinson Cancer Research Center under the auspices of the Seattle Translational Tumor Research initiative. Oncoscape is a web-based, menu-driven analysis and visualization platform for large-scale, heterogeneous clinical and molecular patient timeline data as exemplified by the Fred Hutch HIDRA database. Oncoscape vision and development is managed by a small team comprising: <a href="https://www.fredhutch.org/en/labs/profiles/holland-eric.html">Eric Holland</a>, <a href="http://www.sttrcancer.org/en/contact-us/horse-grant-bio.html">Desert Horse-Grant</a>, <a href="https://www.linkedin.com/in/lisa-mcferrin-9758b029">Lisa McFerrin</a>, <a href="https://www.linkedin.com/in/hbolouri">Hamid Bolouri</a>, <a href="https://www.linkedin.com/in/jenny-zhang-ba62a2104">Jenny Zhang</a>, <a href="https://www.linkedin.com/in/gretchenh">Gretchen Heinrich</a>, <a href="https://www.linkedin.com/in/robert-mcdermott-a77b9011">Robert McDermott</a> and <a href="https://www.linkedin.com/in/zager">Michael Zager</a>.</p><p class="landing-copy">Through its easy point-and-click browser interface, Oncoscape will become an essential tool for doctors and researchers interested in:</p><p class="landing-copy"><ul><li>Comparing patients or populations across an array of features, like genetic alterations (CNV, IHC, sequencing, expression) or clinical elements (treatment regimens, diagnostics, outcomes)</li><li>Defining cohorts based on selected traits  identifying patients like me</li><li>Aligning patient histories according to timeline events: diagnosis, treatment, progression, survival</li><li>Performing powerful and integrated statistical analysis: Principle Component Analysis, Partial least squares regression, Kaplan-Meier curves, enrichment scores</li><li>Creating high quality visualizations of molecular/clinical data</li></ul></p><p class="landing-copy">By providing a portal equipped with rich data, powerful statistics and a simple interface, Oncoscape not only empowers users to quickly answer questions themselves but also expedites the process of discovering novel patterns and relationships. This can lead to numerous possible findings, including optimized drug therapies for individual patients, identification of novel regulatory pathways, or even the need to reassess adherence strategies.</p><p>Please adhere to the <a href="http://cancergenome.nih.gov/publications/publicationguidelines">TCGA publication guidelines</a> when using TCGA data in your publications.</p></div><div class="col-sm-5"><os-login></os-login></div></div></div>'),e.put("app/components/loader/loader.html",'<div class="loader-modal"><div class="loader"><div class="loader__bar"></div><div class="loader__bar"></div><div class="loader__bar"></div><div class="loader__bar"></div><div class="loader__bar"></div><div class="loader__ball"></div></div></div>'),e.put("app/components/login/login.html",'<form class="login"><div class="login-body"><h3 class="login-header">Sign in</h3><div ng-repeat="item in vm.networks" class="login-option" ng-click="vm.login(item);"><span class="{{item.icon}} login-icon"></span> {{item.name}}</div></div></form>'),e.put("app/components/markers/markers.html",'<os-tray content="tray-content-block" change="vm.resize()"><section class="tray-content"><div class="row"><br><div class="col-xs-12 form-item"><label>Edge Visibility</label><div ng-repeat="item in vm.optEdgeColors" class="legend-bar" style="border-color:{{item.color}};position:relative;background-color:#FFF;padding:2px 10px;line-height:25px;">{{item.name}} {{item.count}} <label class="switch" style="float:right"><input type="checkbox" class="switch-input" ng-model="item.show" ng-change="vm.edgeToggle(item)"> <span class="switch-label" data-on="On" data-off="Off"></span> <span class="switch-handle"></span></label></div></div><div ng-if="vm.legendNodes.length>0" class="col-xs-12 form-item"><label>Patient {{vm.legendCaption}}</label><div ng-repeat="item in vm.legendNodes" class="legend-bar legend-bar-button" style="border-color:{{item.color}};">{{item.name}}<span id="{{item.id}}" class="legend-count"></span> <label style="float:right;padding-top:5px;" class="btn-group"><button ng-click="vm.deselectColor(item)" class="btn btn-xs btn-default" style="background-color:#47a8d8;color:#FFF;text-shadow: 0 1px rgba(0, 0, 0, 0.2);width:24px;margin-right:1px;"><i class="fa fa-circle-o"></i></button> <button ng-click="vm.selectColor(item)" class="btn btn-xs btn-default" style="background-color:#47a8d8;color:#FFF;text-shadow: 0 1px rgba(0, 0, 0, 0.2);width:24px;margin-left:1px;"><i class="fa fa-dot-circle-o"></i></button></label></div></div><div class="col-xs-12 form-item"><label>Patient Options</label><div class="btn-group" role="group" style="display: block"><button class="btn btn-default btn-no-focus" type="button" style="width:50%; font-weight: 300;" title="Zoom Reset" ng-click="vm.showPanelLayout = true">Layouts</button> <button class="btn btn-default btn-no-focus" type="button" style="width:50%; font-weight: 300;" title="Zoom Selection" ng-click="vm.showPanelColor = true">Colors</button></div></div><div class="col-xs-6 form-item" style="padding-right:5px"><label>Command Mode</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" style="padding-right:30px;">{{vm.optCommandMode.name}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1" style="width:100%"><li ng-repeat="item in vm.optCommandModes" ng-click="vm.optCommandMode=item">{{item.name}}</li></ul></div></div><div class="col-xs-6 form-item" style="padding-left:5px"><label>Gene Set</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" style="padding-right:30px;">{{vm.optGeneSet.name}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1" style="width:100%"><li ng-repeat="item in vm.optGeneSets" ng-click="vm.optGeneSet=item">{{item.name}}</li></ul></div></div><div class="col-xs-12 form-item" ng-if="vm.optCommandMode.name==\'Sequential\'"><label>Commands</label><br><a ng-click="vm.cmd(\'ShowSelectedEdges\')" class="markers-command hvr-sweep-to-right">Show Edges of Selected</a> <a ng-click="vm.cmd(\'HideSelectedEdges\')" class="markers-command hvr-sweep-to-right">Hide Edges of Selected</a> <a ng-click="vm.cmd(\'HideUnselectedEdges\')" class="markers-command hvr-sweep-to-right">Hide Edges of Unselected</a> <a ng-click="vm.cmd(\'HideAllEdges\')" class="markers-command hvr-sweep-to-right">Hide All Edges</a> <a ng-click="vm.cmd(\'SelectInverse\')" class="markers-command hvr-sweep-to-right">Invert Node Selection</a> <a ng-click="vm.cmd(\'SelectConnected\')" class="markers-command hvr-sweep-to-right">Select Connected Nodes</a> <a ng-click="vm.cmd(\'HideUnselectedNodes\')" class="markers-command hvr-sweep-to-right">Hide Unselected Nodes</a> <a ng-click="vm.cmd(\'ShowAllNodes\')" class="markers-command hvr-sweep-to-right">Show All Nodes</a></div><div class="col-xs-12 form-item"><label>Lock Selections</label><div class="btn-group" role="group" style="display: block"><button class="btn btn-default btn-no-focus" type="button" ng-click="vm.lock(\'patient\')" style="width:50%; font-weight: 300;" title="Patient Selection Lock"><i class="fa fa-unlock" ng-show="!vm.lockPatients"></i> <i class="fa fa-lock" ng-show="vm.lockPatients"></i> Patients</button> <button class="btn btn-default btn-no-focus" type="button" ng-click="vm.lock(\'gene\')" style="width:50%; font-weight: 300;" title="Gene Selection Lock"><i class="fa fa-unlock" ng-show="!vm.lockGenes"></i> <i class="fa fa-lock" ng-show="vm.lockGenes"></i> Genes</button></div></div><div class="col-xs-12 form-item"><label>Zoom</label><div class="btn-group" role="group" style="display: block"><button class="btn btn-default btn-no-focus" type="button" ng-click="vm.zoom.reset()" style="width:50%; font-weight: 300;" title="Zoom Reset">Reset</button> <button class="btn btn-default btn-no-focus" type="button" ng-click="vm.zoom.fit()" style="width:50%; font-weight: 300;" title="Zoom Selection">Selected</button></div></div><div class="col-xs-12 form-item"><label>Search</label> <input type="text" class="form-control" ng-model="vm.search" placeholder="Genes or Patients"></div></div></section></os-tray><section class="tray-content-block"><div id="markers-chart" class="markers-chart"></div><div style="position:absolute;top:10px;text-align:center;width:100%;"><h2 class="h2-tool">Markers + Patients</h2><span class="h3-tool">{{vm.datasource.source}} {{vm.datasource.name}}</span> <span class="h3-tool">(Layout: {{vm.optPatientLayout.name}})</span></div></section><div id="modalEdge" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-body"><h2 style="margin-top:0px;">Your request would add {{vm.edgeCounts.total}} edges to the graph.</h2><p>To improve performance + readability you may want to disable some of the edges.</p><div class="input-group" ng-repeat="item in vm.optEdgeColors | filter:{show:true}"><label class="switch {{item.class}}"><input type="checkbox" class="switch-input" ng-model="item.show"> <span class="switch-label" data-on="On" data-off="Off"></span> <span class="switch-handle"></span></label> <span style="padding-left:20px;">{{item.name}} ({{vm.edgeCounts[item.abv]}})</span></div></div><div style="position:absolute;right:10px;bottom:10px;"><button class="btn btn-default" ng-click="vm.hideModal()">Cancel</button> <button class="btn btn-primary" ng-click="vm.filterModelEdge()">Continue</button></div></div></div></div><os-color-panel ng-if="vm.showPanelColor" close="vm.showPanelColor=false"></os-color-panel><div class="panel panel-default mdi" ng-if="vm.showPanelLayout"><div class="panel-heading"><h3 class="panel-title">Patient Layout</h3><span class="pull-right clickable" data-effect="fadeOut" ng-click="vm.showPanelLayout=false"><i class="fa fa-times"></i></span></div><div class="panel-body"><div class="row"><div class="col-sm-12"><h3>Select a layout</h3></div><a class="col-sm-4 markers-command hvr-sweep-to-right" style="padding-left:15px; padding-right:15px;" ng-repeat="item in vm.optPatientLayouts" ng-click="vm.optPatientLayout=item;vm.showPanelLayout=false;">{{item.name}}</a></div></div></div>'),e.put("app/components/pathways/pathways.html",'<os-tray content="tray-content-block" change="vm.resize($event)"><section class="tray-content"><div class="row"><br><br><div class="col-xs-12 form-item"><label>Search</label> <input type="text" class="form-control" ng-model="vm.search"></div><div class="col-xs-12 form-label"><h2>Legend</h2><span class="legend-bar" style="border-color: green">Activation</span> <span class="legend-bar" style="border-color: red">Inhibition</span> <span class="legend-bar" style="border-color: #38347B">Modification</span> <span class="legend-bar" style="border-color: #056ce1">Genes</span></div></div></section></os-tray><section class="tray-content-block" style="padding-right:0px;"><div id="pathways-chart" class="pathways-chart"></div><div style="position:absolute;top:10px;text-align:center;width:100%;"><h2 class="h2-tool">Pathways</h2><span class="h3-tool">{{vm.datasource.source}} {{vm.datasource.name}}</span></div></section><div class="modal fade pathways" id="gbm-webpage" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="myModalLabel">{{vm.tip}}</h4></div><iframe class="modal-iframe" ng-src="{{vm.frame}}"></iframe></div></div></div>'),e.put("app/components/pca/pca.html",'<os-tray content="tray-content-block"><section class="tray-content"><div class="row"><br><br><div class="col-xs-12 form-item"><label>Gene Set</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.geneSet.label}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li ng-repeat="item in vm.geneSets" ng-click="vm.geneSet=item">{{item.label}}</li></ul></div></div><div class="col-xs-12 form-item"><label>PCA Type</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.pcaType.label}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li ng-repeat="item in vm.pcaTypes" ng-click="vm.pcaType=item">{{item.label}}</li></ul></div></div><div ng-if="vm.legendCaption.length>0" class="col-xs-12 form-item"><label>Patient {{vm.legendCaption}}</label><div ng-repeat="item in vm.legendNodes" class="legend-bar" style="border-color:{{item.color}};position:relative;background-color:#FFF;padding:2px 10px;line-height:25px;">{{item.name}}</div></div><div class="col-xs-12 form-item"><label>Patient</label> <button class="btn btn-default btn-no-focus" type="button" style="width:100%;font-weight: 300;" ng-click="vm.showPanelColor = true">Color Options</button></div><div class="col-xs-12 form-label"><h3>Variance</h3>PC1: {{vm.pc1}}%<br>PC2: {{vm.pc2}}%</div></div></section></os-tray><section class="tray-content-block"><div style="position:absolute;top:10px;text-align:center;width:100%;"><h2 class="h2-tool">Principal Component Analysis</h2><span class="h3-tool">{{vm.datasource.source}} {{vm.datasource.name}}</span><div id="pca-chart" class="pca"></div></div></section><os-color-panel ng-if="vm.showPanelColor" close="vm.showPanelColor=false"></os-color-panel>'),e.put("app/components/sunburst/sunburst.html",'<os-tray content="tray-content-block" change="vm.resize($event)"><section class="tray-content"><div class="row"><br><br><div class="col-xs-12 form-item"><label>Patient</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.patient.patient_ID}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li ng-repeat="item in vm.patients">{{item.patient_ID}}</li></ul></div></div><div class="col-xs-12 form-item" ng-repeat="chart in vm.charts"><label>{{chart.name}}</label><div ng-repeat="group in chart.groups" class="legend-bar" style="border-color:#FFF;position:relative;background-color:#FFF;padding:2px 10px;line-height:25px;"><label class="switch" style="float:right"><input type="checkbox" class="switch-input" ng-model="group.show" ng-change="vm.draw()"> <span class="switch-label" data-on="On" data-off="Off"></span> <span class="switch-handle"></span></label> {{group.name}}<div ng-repeat="tag in group.tags" class="legend-bar" style="border-color:{{tag.color}}; position: relative; padding: 2px 10px; line-height: 25px; background-color: rgb(255, 255, 255);">{{tag.name}}</div></div></div></div></section></os-tray><section class="tray-content-block"><div style="position:absolute;top:10px;text-align:center;width:100%;"><h2 class="h2-tool">Sunburst</h2><span class="h3-tool">{{vm.datasource.source}} {{vm.datasource.name}}</span><div id="sunburst-chart"></div></div></section>'),e.put("app/components/plsr/plsr.html",'<os-tool-menu datasource="{{vm.datasource}}" change="vm.addCohortGene()"></os-tool-menu><os-tray content="tray-content-block" change="vm.resize($event)"><section class="tray-content"><div class="row"><div class="col-xs-12 form-label"><h2>Filters</h2></div><div class="col-xs-12 form-item"><label>Gene Set</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.geneSet}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li ng-repeat="item in vm.geneSets" ng-click="vm.geneSet=item">{{item}}</li></ul></div></div><div class="col-xs-12 form-item"><label>Age At Diagnosis</label><div range-slider="" min="vm.deathMinValue" model-min="vm.deathMinFilter" max="vm.deathMaxValue" model-max="vm.deathMaxFilter" prevent-equal-min-max="true" show-values="true" attach-handle-values="true" on-handle-up="vm.update()"></div></div><div class="col-xs-12 form-item"><label>Survival</label><div range-slider="" min="vm.survivalMinValue" model-min="vm.survivalMinFilter" max="vm.survivalMaxValue" model-max="vm.survivalMaxFilter" prevent-equal-min-max="" show-values="true" attach-handle-values="true" on-handle-up="vm.update()"></div></div><div class="col-xs-12 form-label"><h2>Legend</h2><span class="legend-bar" style="border-color: #1396de">Age At Diagnosis</span> <span class="legend-bar" style="border-color: #38347b">Survial</span> <span class="legend"><span class="legend-dot" style="background-color:#000"></span>Genes</span></div></div></section></os-tray><section class="tray-content-block"><div class="container-fluid"><h2 class="h2-tool">Partial Least Squares Regression</h2><h3 class="h3-datasource">{{vm.datasource}}</h3><div id="plsr-chart" class="plsr"></div></div></section><div class="modal fade plsr-webpage" id="plsr-webpage" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="myModalLabel">{{vm.tip}}</h4></div><iframe class="modal-iframe" ng-src="{{vm.frame}}"></iframe></div></div></div>'),e.put("app/components/survival/survival.html",'<os-tray content="tray-content-block" change="vm.resize($event)"><section class="tray-content"><div class="row"><div class="col-xs-12 form-item"><br><label>Cohorts</label><div class="legend-bar" style="border-color:#000;position:relative;background-color:#FFF;padding:2px 10px;line-height:25px;">All Patients <label class="switch {{item.class}}" style="float:right"><input type="checkbox" class="switch-input" ng-model="vm.all.show" ng-change="vm.toggle()"> <span class="switch-label" data-on="On" data-off="Off"></span> <span class="switch-handle"></span></label></div><div ng-repeat="cohort in vm.cohorts track by $index" class="legend-bar" style="border-color:{{cohort.color}};position:relative;background-color:#FFF;padding:2px 10px;line-height:25px;">{{cohort.name}} <label class="switch {{item.class}}" style="float:right"><input type="checkbox" class="switch-input" ng-model="cohort.show" ng-change="vm.toggle()"> <span class="switch-label" data-on="On" data-off="Off"></span> <span class="switch-handle"></span></label></div></div></div></section></os-tray><section class="tray-content-block"><div style="position:absolute;top:10px;text-align:center;width:100%;"><h2 class="h2-tool">Survival Curves</h2><span class="h3-tool">{{vm.datasource.source}} {{vm.datasource.name}}</span><div id="survival-chart"></div></div></section>'),e.put("app/components/timelines/timelines.html",'<os-tray content="tray-content-block" change="vm.resize($event)"><section class="tray-content"><div class="row"><br><div class="col-xs-6 form-item" style="padding-right:5px"><label>Align By</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.align.name}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1" style="width:100%"><li ng-repeat="item in vm.events" ng-click="vm.align=item; vm.update();">{{item.name}}</li></ul></div></div><div class="col-xs-6 form-item" style="padding-left:5px"><label>Order By</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.sort.name}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1" style="width:100%"><li ng-repeat="item in vm.events" ng-click="vm.sort=item; vm.update();">{{item.name}}</li></ul></div></div><div class="col-xs-6 form-item" style="padding-right:5px"><label>Patient Status</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.filter.name}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1" style="width:100%"><li ng-repeat="item in vm.filters" ng-click="vm.filter=item;vm.update();">{{item.name}}</li></ul></div></div><div class="col-xs-6 form-item" style="padding-left:5px"><label>Timescale</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.timescale.name}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1" style="width:100%"><li ng-repeat="item in vm.timescales" ng-click="vm.timescale=item;vm.update();">{{item.name}}</li></ul></div></div><div class="col-xs-12 form-item"><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" ng-click="vm.resetZoom()" style="text-align:center;">Clear Selection + Reset Zoom</button></div></div><div class="col-xs-12 form-item"><label>Events</label><div ng-repeat="item in vm.events track by $index" class="legend-bar" style="border-color:{{item.color}};position:relative;background-color:#FFF;padding:2px 10px;line-height:25px;">{{item.name}} <label class="switch {{item.class}}" style="float:right"><input type="checkbox" class="switch-input" ng-model="item.selected" ng-change="vm.update();"> <span class="switch-label" data-on="On" data-off="Off"></span> <span class="switch-handle"></span></label></div></div><div class="col-xs-12 form-item"><div id="timelines-tip" style="min-height:200px;"><b>Rollover Event For Details</b></div></div></div></section></os-tray><section class="tray-content-block"><div style="position:absolute;top:10px;text-align:center;width:100%;"><h2 class="h2-tool">Timelines</h2><span class="h3-tool">{{vm.datasource.source}} {{vm.datasource.name}}</span><div class="timelines-content" style="margin-top:20px;"></div></div></section><os-color-panel ng-if="vm.showPanelColor" close="vm.showPanelColor=false"></os-color-panel>'),e.put("app/components/tools/tools.html",'<section class="tools container-fluid"><div class="row"><div class="col-sm-12 col-md-6"><br><h1>Step 2: Select An Analysis Tool</h1><p>The list of tools depends upon the data source. If the requisite molecular or clinical data is not availbile for your disease please contact us at <a href="mailto:oncoscape@fredhuth.org">oncoscape@fredhutch.org</a>. Use the navigation in the top right to switch between tools.</p></div></div><div class="row"><ul><li ng-repeat="tool in vm.tools" class="col-xs-12 col-sm-6 col-md-4 col-lg-3" ng-click="vm.explore(tool.route)"><img class="tools-img" ng-src="/assets/images/{{tool.img}}"><div class="tools-copy"><h3 class="tools-lbl">{{tool.name}}</h3><a href="">Explore</a></div></li></ul></div></section>'),e.put("app/components/tray/tray.html",'<div><label class="tray-label tray-label-right"><i class="fa fa-chevron-left" aria-hidden="true"></i></label><div class="tray {{vm.trayClass}} tray-right" locked="true"><ng-transclude></ng-transclude><i class="fa fa-lock tray-sticky-icon {{vm.iconClass}}" ng-click="vm.toggle()"></i></div></div>')}]);
//# sourceMappingURL=../maps/scripts/app-d052ef60bf.js.map
