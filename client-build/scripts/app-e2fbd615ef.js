!function(){"use strict";angular.module("oncoscape",["ngAnimate","ngCookies","ngTouch","ngSanitize","ngMessages","ngAria","ngResource","ui.router","ui.bootstrap","ui.grid","ui.grid.selection","ui.grid.cellNav","ui.grid.resizeColumns","ui.grid.moveColumns","ui.grid.pinning","ui.grid.grouping","ui.grid.autoResize","toastr"])}(),function(){"use strict";function e(){function e(e,t){var n=this;n.trayClass=Math.random().toString(36).substring(3),n.iconClass=Math.random().toString(36).substring(3);var a=!0;n.toggle=function(){var s=angular.element("."+n.trayClass),i=angular.element("."+n.iconClass);a=!a,i.addClass(a?"fa-lock":"fa-unlock-alt").removeClass(a?"fa-unlock-alt":"fa-lock").attr("locked",a?"true":"false"),s.attr("locked",a?"true":"false"),a?(s.unbind("mouseover",o).unbind("mouseout",r).removeClass("tray-collapsed"),t(function(){n.change()})):(s.addClass("tray-collapsed").bind("mouseover",o).bind("mouseout",r),t(function(){n.change()})),e.onResize.dispatch()};var o=function(){angular.element("."+n.trayClass).removeClass("tray-collapsed")},r=function(){angular.element("."+n.trayClass).addClass("tray-collapsed")}}e.$inject=["osApi","$timeout"];var t={restrict:"E",templateUrl:"app/components/tray/tray.html",scope:{caption:"@",content:"@",change:"&"},controller:e,controllerAs:"vm",bindToController:!0,replace:!0,transclude:!0};return t}angular.module("oncoscape").directive("osTray",e)}(),function(){"use strict";function e(){function e(e,t){var n=this;e.query("lookup_oncoscape_tools").then(function(t){var a=e.getDataSource().tools;n.tools=t.data.filter(function(e){return-1!=a.indexOf(e.route)}).sort(function(e,t){return e.name<t.name?-1:e.name>t.name?1:0})}),n.explore=function(n){t.go(n,{datasource:e.getDataSource().disease})}}e.$inject=["osApi","$state"];var t={restrict:"E",templateUrl:"app/components/tools/tools.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osTools",e)}(),function(){"use strict";function e(){function e(e,t,n,a,o,r,s,i,c,l){function d(){l.debounce(S.update,300)}e.setBusy(!0);var u,p,m,g,h,v,f,b,y=[],w=20,x=1,A=1,S=this;S.datasource=e.getDataSource(),S.cohort=t.getCohort(),S.timescales=[{name:"Log",valFn:function(e){return(0>e?-1:1)*Math.log(Math.abs(1e3*e/864e5)+1)/Math.log(2)}},{name:"Linear",valFn:function(e){return i.duration(1e3*e).asDays()}}],S.filters=[{name:"Alive + Dead"},{name:"Only Alive"},{name:"Only Dead"}],S.modes=[{name:"Highlight"},{name:"Filter"}],S.displayModes=[{name:"All Patients"},{name:"Selected Patients"}],S.timescale=S.timescales[0],S.filter=S.filters[2],S.mode=S.modes[0],S.displayMode=S.displayModes[0],S.events=null,S.align=null,S.sort=null,S.resetZoom=function(){y=[],t.setCohort([],t.ALL,t.PATIENT),M.call(k.move,null),T.call(k.move,null),S.update()};var k=c.brushY().handleSize(3),C=c.brushX().handleSize(3),_=(c.brushY().handleSize(1),c.select(".timelines-content")),E=_.append("svg").attr("class","timeline-axis"),M=_.append("svg").attr("class","timeline-scroll-y"),T=_.append("svg").attr("class","timeline-scroll-x"),P=_.append("svg").attr("class","timeline-chart"),D=(P.append("g"),P.append("g"));_=angular.element(".timelines-content"),S.update=function(){console.log("vmupdate");var t=e.getLayout(),n=r.innerWidth-t.left-t.right-80,a=r.innerHeight-250;console.log(n),F(),O(n,a,t),R(n,a),H(n,a),$(n,a),L(n,a)};var F=function(){var e=S.align.name,t=S.sort.name,n=S.filter.name,a=S.events.filter(function(e){return e.selected}).map(function(e){return e.name.toLowerCase()});p=u,m=[1/0,-(1/0)],p.forEach(function(e){if(e.hash.hasOwnProperty(this.align)&&e.hash.hasOwnProperty(this.sort)&&e.hash.hasOwnProperty("Status")){var t=e.hash.Status.data.status;"Only Alive"==this.filter&&"Dead"==t||"Only Dead"==this.filter&&"Dead"!=t?e.visible=!1:("Selected Patients"==S.displayMode.name&&selectedIds.length>0?e.visible=-1!=selectedIds.indexOf(e.id):e.visible=!0,e.visible&&(this.offset=0-e.hash[this.align].tsStart,e.events.forEach(function(e){e.visible=-1!=this.events.indexOf(e.name.toLowerCase()),e.visible&&(e.tsStartAligned=S.timescale.valFn(e.tsStart+this.offset),e.tsEndAligned=S.timescale.valFn(e.tsEnd+this.offset),this.domain[0]=Math.min(this.domain[0],e.tsStartAligned),this.domain[1]=Math.max(this.domain[1],e.tsEndAligned))},this)))}else e.visible=!1},{align:e,sort:t,filter:n,events:a,domain:m,offset:0}),p=p.filter(function(e){return e.visible}),p.forEach(function(e){e.selected=-1!=y.indexOf(e.id)}),p=p.sort(function(e,n){if(e.status==n.status){var a=e.events.filter(function(e){return e.name==t&&1==e.order})[0].tsStartAligned,o=n.events.filter(function(e){return e.name==t&&1==e.order})[0].tsStartAligned;return a>o?1:o>a?-1:0}return"dead"==e.status?1:-1})},B=function(e){return 0==Math.abs(e)?e:Math.abs(e)<30?e+" Days":Math.abs(e)<360?Math.round(e/30.4*10)/10+" Months":Math.round(e/365*10)/10+" Years"},L=function(e,t){var n=c.axisBottom(b).ticks(7);"Linear"==S.timescale.name?n.tickFormat(function(e){return B(e)}):n.tickFormat(function(e){return B(Math.round((0>e?-1:1)*(Math.pow(2,Math.abs(e))-1)*100)/100)}),E.call(n)},O=function(e,t,n){_.css("background","#FAFAFA").css("margin-left",n.left+30).css("margin-right",n.right).css("width",e+20).css("height",t+20),M.attr("height",t),T.attr("width",e),P.attr("height",t).attr("width",e).attr("fill","blue").attr("transform","translate(20,20)"),D.attr("height",t).attr("width",e),E.style("top",t+20).attr("width","width")},$=function(e,t){A=t/(p.length*w),x=1,g=x,h=A,v=0,f=0,D.attr("transform","translate("+v+","+f+") scale("+g+","+h+")")},R=function(e,t){M.call(k.on("end",function(){if(null!==c.event.selection){var e=c.event.selection[0],n=c.event.selection[1],a=t,o=e/a,r=n/a,s=r-o;h=A/s,f=w*p.length*h*-o}else{if(h==A&&0==f)return;h=A,f=0,M.call(k.move,null)}D.transition().duration(750).attr("transform","translate("+v+","+f+") scale("+g+","+h+")")})),T.call(C.on("end",function(){if(null!==c.event.selection){var t=c.event.selection[0],n=c.event.selection[1],a=e-20,o=t/a,r=n/a,s=r-o;g=x/s,v=e*g*-o}else{if(g==x&&0==v)return;g=x,v=0,T.call(C.move,null)}D.transition().duration(750).attr("transform","translate("+v+","+f+") scale("+g+","+h+")")}))},z=function(e){e.exit().remove(),e.enter().append("rect").attr("class","event").attr("width",function(e){return Math.max(b(e.tsEndAligned)-b(e.tsStartAligned),2)}).attr("height",function(e){return"Radiation"==e.name||"Drug"==e.name?w/2:w}).attr("y",function(e){return"Radiation"==e.name?w/2:0}).attr("x",function(e){return b(e.tsStartAligned)}).style("fill",function(e){return e.color}),e.attr("width",function(e){return Math.max(b(e.tsEndAligned)-b(e.tsStartAligned),2)}).attr("height",function(e){return"Radiation"==e.name||"Drug"==e.name?w/2:w}).attr("y",function(e){return"Radiation"==e.name?w/2:0}).attr("x",function(e){return b(e.tsStartAligned)}).style("fill",function(e){return e.color})},H=function(e){b=c.scaleLinear().domain(m).range([0,e]).nice();var t=D.selectAll("g.patient").data(p);t.exit().transition().delay(200).duration(500).style("opacity",0).remove();var n=t.enter().append("g").attr("class","patient").attr("transform",function(e,t){return"translate(0,"+t*w+")"});z(t.selectAll(".event").data(function(e){return e.events.filter(function(e){return e.visible})})),z(n.selectAll(".event").data(function(e){return e.events.filter(function(e){return e.visible})}))},I=function(e){S.cohort=e};t.onCohortChange.add(I),e.query(e.getDataSource().clinical.events,{}).then(function(t){var n=function(e){return"Birth"==e?"#E91E63":"Diagnosis"==e?"#673AB7":"Pathology"==e?"#2196F3":"Progression"==e?"#00BCD4":"Absent"==e?"#CDDC39":"Status"==e?"#FFC107":"Radiation"==e?"#FF5722":"Procedure"==e?"#795548":"Encounter"==e?"#607D8B":"Drug"==e?"#03A9F4":"black"},a=t.data[0],o={};a=Object.keys(a).map(function(e){var t=this.data[e].filter(function(e){return null!=e.start}).map(function(e){return this.events[e.name]=null,e.tsStart=i(e.start,"MM/DD/YYYY").unix(),e.tsEnd=null==e.end?e.tsStart:i(e.end,"MM/DD/YYYY").unix(),e.tsStartAligned="",e.tsEndAligned="",e.end=null==e.end?e.start:e.end,e.color=this.colorFn(e.name),e.visible=!0,e.order=1,e},{events:this.events,colorFn:this.colorFn}),n=t.reduce(function(e,t){return e.hasOwnProperty(t.name)?e[t.name].tsStart>t.tsStart&&(e[t.name]=t):e[t.name]=t,e},{});return{id:e,events:t,hash:n}},{data:a,events:o,colorFn:n}),a.forEach(function(e){var t=l.groupBy(e.events,"name"),n=Object.keys(t).filter(function(e){return this[e].length>1},t);n.forEach(function(t){var n=1;e.events.filter(function(e){return e.name==t}).sort(function(e,t){return e.tsStart-t.tsStart}).forEach(function(e){e.order=n,n++})})}),u=a.filter(function(e){try{return e.status=e.hash.Status.data.status.toLowerCase(),!0}catch(t){return!1}return!1}),S.events=Object.keys(o).map(function(e){return{name:e,selected:-1==["Birth","Pathology","Absent","Procedure"].indexOf(e),color:this(e)}},n),S.align=S.events.filter(function(e){return"Diagnosis"==e.name?!0:void 0})[0],S.sort=S.events.filter(function(e){return"Status"==e.name?!0:void 0})[0],S.update(),e.setBusy(!1)}),e.onResize.add(S.update),angular.element(r).bind("resize",d),a.$on("$destroy",function(){t.onCohortChange.add(I),e.onResize.remove(S.update),angular.element(r).unbind("resize",d)})}e.$inject=["osApi","osCohortService","$state","$scope","$stateParams","$window","$document","moment","d3","_"];var t={restrict:"E",templateUrl:"app/components/timelines/timelines.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osTimelines",e)}(),function(){"use strict";function e(){function e(e,t,n,a,o,r,s,i,c){t.setBusy(!0);var l=this;l.datasource=t.getDataSource(),l.cohorts=n.getCohorts(),l.cohort=n.getCohort();var d=function(e){l.cohort=e,k()};n.onCohortChange.add(d),l.toggle=function(){k()};var u,p=function(e){return e+"%"},m=function(e){return 0==Math.abs(e)?e:Math.abs(e)<30?e+" Days":Math.abs(e)<360?Math.round(e/30.4*10)/10+" Months":Math.round(e/365*10)/10+" Years"},g=angular.element("#survival-chart"),h=e.select("#survival-chart").append("svg"),v=h.append("g").attr("class","brush"),f=h.append("g"),b=h.append("g").attr("class","axis"),y=h.append("g").attr("class","axis"),w={width:0,height:0,xScale:null,yScale:null,xAxis:e.axisBottom().ticks(5).tickFormat(m),yAxis:e.axisLeft().ticks(5).tickFormat(p)},x=function(){if(e.event.selection){var t=e.event.selection.sort(),a=[Math.max(Math.round(w.xScale.invert(t[0])),0),Math.round(w.xScale.invert(t[1]))],o=l.cohorts.filter(function(e){return e.show}),r=o.reduce(function(e,t){return"All Patients + Samples"==t.name&&(e=!0),e},!1),s=n.getData(),i=s.patientMap,c=r?Object.keys(s.patientMap):[].concat.apply([],o.map(function(e){return e.patientIds}));c=c.filter(function(e){try{var t=i[e].survival.time;return t>=a[0]&&t<=a[1]}catch(n){return!1}}),n.setCohort(c,"Survival",n.PATIENT),v.call(u.move,null)}},A=function(n){var a=t.getLayout();w.width=i.innerWidth-a.left-a.right-60,w.height=i.innerHeight-160,g.css("margin-left",a.left+20),h.attr("width","100%").attr("height",w.height),w.xScale=e.scaleLinear().domain(n).range([50,w.width]),w.yScale=e.scaleLinear().domain([0,100]).range([w.height-50,1]),w.xAxis.scale(w.xScale),w.yAxis.scale(w.yScale),y.attr("transform","translate(50, 10)").call(w.yAxis),b.attr("transform","translate(0, "+(w.yScale(0)+10)+")").call(w.xAxis),u=e.brushX().extent([[50,10],[w.width,w.height-40]]),u.on("end",x),v.call(u)},S=function(t){var n=t.survival.data,a=t.color,o=0;n.lines.forEach(function(t){f.append("line").attr("class","line").attr("stroke-width",.5).attr("stroke",a).attr("x1",w.xScale(t.time)).attr("x2",w.xScale(t.time)).attr("y1",w.yScale(t.survivalFrom)+10).attr("y2",w.yScale(t.survivalTo)+10).datum(t).on("mouseover",function(){e.select(this).attr("stroke-width",5)}).on("mouseout",function(){e.select(this).attr("stroke-width",.5)}),f.append("line").attr("class","line").attr("stroke-width",.5).attr("stroke",a).attr("x1",w.xScale(o)).attr("x2",w.xScale(t.time)).attr("y1",w.yScale(t.survivalFrom)+10).attr("y2",w.yScale(t.survivalFrom)+10),o=t.time}),n.ticks.forEach(function(t){f.append("line").attr("class","line").attr("stroke-width",.5).attr("stroke",a).attr("x1",w.xScale(t.time)).attr("x2",w.xScale(t.time)).attr("y1",w.yScale(t.survivalFrom)+12).attr("y2",w.yScale(t.survivalFrom)+8).datum(t).on("mouseover",function(){e.select(this).attr("stroke-width",5)}).on("mouseout",function(){e.select(this).attr("stroke-width",.5)})},this);var r=n.ticks[n.ticks.length-1],s=n.lines[n.lines.length-1];r.time>s.time&&f.append("line").attr("class","line").attr("stroke-width",.5).attr("stroke",a).attr("x1",w.xScale(s.time)).attr("x2",w.xScale(r.time)).attr("y1",w.yScale(r.survivalFrom)+10).attr("y2",w.yScale(r.survivalFrom)+10)},k=function(){t.setBusy(!0),f.selectAll(".line").remove(),f.selectAll(".tick").remove();var e=l.cohorts.filter(function(e){return e.show}),n=e.reduce(function(e,t){return e.min=Math.min(e.min,t.survival.min),e.max=Math.max(e.max,t.survival.max),e},{min:1/0,max:-(1/0)});n.min=Math.min(n.min,l.cohort.survival.min),n.max=Math.max(n.max,l.cohort.survival.max),A([n.min-1,n.max+1]);for(var a=0;a<e.length;a++)S(e[a]);-1==e.indexOf(l.cohort)&&S(l.cohort),t.setBusy(!1)};k(),t.onResize.add(k),angular.element(i).bind("resize",c.debounce(k,300)),r.$on("$destroy",function(){n.onCohortChange.add(d)})}e.$inject=["d3","osApi","osCohortService","$state","$timeout","$scope","$stateParams","$window","_"];var t={restrict:"E",templateUrl:"app/components/survival/survival.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osSurvival",e)}(),function(){"use strict";function e(){function e(e,t,n,a,o,r,s,i,c){var l,d=this;d.patients=[],d.patient=null,d.datasource=t.getDataSource(),d.charts=[];var u=function(e){var t=["#F44336","#E91E63","#9C27B0","#673AB7","#3F51B5","#2196F3","#0277BD","#00BCD4","#009688","#4CAF50","#8BC34A","#CDDC39","#FFEB3B","#FFC107","#FF9800","#FF5722","#795548","#C51162","#B388FF"],n=e.reduce(function(e,t){return n=t.groups.reduce(function(e,t){return c.union(e,t.tags)},[]),c.union(e,n)},[]);t.length=n.length;var a=c.object(n,t);return a.Tumor="#FEFEFE",a.Normal="#EAEAEA",a};t.setBusy(!0),t.query("biomarker_immune_tree").then(function(e){t.setBusy(!1),l=u(e.data[0].barcharts),e.data.forEach(function(e){e.barcharts.forEach(function(e){e.groups.forEach(function(e){e.show=!0,e.tags=e.tags.map(function(e){return{name:e,color:l[e]}})})})}),d.patients=e.data,d.patient=d.patients[0],d.draw()}),d.draw=function(){p.draw(d,l),m.draw(d,l)};var p=function(){var n,a,o,r,s,c,l,d,u,p,m=e.scaleOrdinal(e.schemeCategory20),g=e.select("#sunburst-chart").append("div").attr("class","tooltip").style("opacity",0),h=e.select(window),v=function(e){c=e,l=c.append("text").text("Tumor"),d=c.append("text").text("Normal"),u=c.append("g"),p=c.append("g")},f=function(){g.style("top",e.event.layerY+10+"px").style("left",e.event.layerX+10+"px")},b=function(t){g.html(t.data.name).style("opacity",1).style("top",e.event.layerY+10+"px").style("left",e.event.layerX+10+"px"),h.on("mousemove",f).on("mouseup",null)},y=function(e){g.html(e.data.Name).style("opacity",0)},w=function(t){for(var s=t;s.parent;)s=s.parent;var i="Normal"==s.data.name?u:p;i.transition().duration(750).tween("scale",function(){var n=e.interpolate(o.domain(),[t.x0,t.x1]),s=e.interpolate(r.domain(),[t.y0,1]),i=e.interpolate(r.range(),[t.y0?20:0,a]);return function(e){o.domain(n(e)),r.domain(s(e)).range(i(e))}}).selectAll("path").attrTween("d",function(e){return function(){return n(e)}})},x=function(t,a){var o=e.partition(),r=e.hierarchy(t);r.sum(function(e){return e.size});var s=o(r).descendants(),i=a.selectAll("path").data(s).enter().append("g");i.append("path").attr("d",n).style("fill",function(e){return m((e.children?e:e.parent).data.name)}).style("stroke","#FFF").style("stroke-width","2").on("click",w).on("mouseover",b).on("mouseout",y)},A=function(m){s=m.patient;var g=t.getLayout(),h=i.innerHeight-180,v=i.innerWidth-g.left-g.right;a=Math.min(.5*v,h-200)/2-10,o=e.scaleLinear().range([0,2*Math.PI]),r=e.scaleSqrt().range([0,a]),n=e.arc().startAngle(function(e){return Math.max(0,Math.min(2*Math.PI,o(e.x0)))}).endAngle(function(e){return Math.max(0,Math.min(2*Math.PI,o(e.x1)))}).innerRadius(function(e){return Math.max(0,r(e.y0))}).outerRadius(function(e){return Math.max(0,r(e.y1))}),c.attr("width",v).attr("height",h),d.attr("transform","translate("+(a+10)+",20)"),l.attr("transform","translate("+(v-a-10)+",20)"),u.attr("transform","translate("+(a+10)+","+a+")"),p.attr("transform","translate("+(v-a-10)+","+a+")"),x(s.tumor,p,o,r),x(s.normal,u,o,r)};return{init:v,draw:A}}(),m=function(){var n,a,o,r,s,l=function(e,t){n=e,a=n.append("g"),s=t},d=function(e){var n=t.getLayout(),a=i.innerWidth-n.left-n.right-40,o=Math.floor(a/e.length),r=200,s=Math.min(.5*(i.innerWidth-n.left-n.right),i.innerHeight-50-200)-10,c=20;return{layout:n,widthTotal:a,widthChart:o,heightChart:r,yChart:s,xChart:c,numCharts:e.length}},u=function(e,t){function n(){return c.reduce(arguments,function(e,t){return c.flatten(c.map(e,function(e){return c.map(t,function(t){return e.concat([t])})}),!0)},[[]])}return e.map(function(e){var a=n.apply(this,e.groups.filter(function(e){return e.show}).map(function(e){return e.tags.map(function(e){return e.name})})).map(function(e){return{value:0,tags:e}});a.sort(function(e,t){for(var n=e.tags.length-1;n>=0;n--){if(e.tags[n]>t.tags[n])return 1;if(e.tags[n]<t.tags[n])return-1}return 0}),a.forEach(function(t){e.values.forEach(function(e){0==c.difference(t.tags,e.tags).length&&(t.value+=e.data)})});var o=a.reduce(function(e,n){var a=e;return n.tags.reverse().forEach(function(e){var n=a.children.map(function(e){return e.name}).indexOf(e.name);-1==n?(a.children.push({name:e,children:[],value:1,color:t[e]}),a=a.children[a.children.length-1]):(a=a.children[n],a.value+=1)}),n.tags.reverse(),e},{name:e.name,children:[],value:a.length,color:"#DDD"});return{bars:a,tree:o}})},p=function(t){var n=e.select(this);n.append("rect").style("fill","#EEE").attr("width",o.widthChart-5).attr("height",o.heightChart),n.append("text").text(t.tree.name).attr("y",20).attr("x",Math.round((o.widthChart-5)/2)).attr("text-anchor","middle");var a=n.selectAll(".cat-bar").data(t.bars),r=c.max(t.bars,function(e){return e.value}).value,s=c.min(t.bars,function(e){return e.value}).value,i=e.scaleLinear();i.range([0,110]),i.domain([s,r]);var l=o.widthChart/t.bars.length;a.enter().append("rect").attr("x",function(e,t){return l*t}).attr("y",function(e){return 140-i(e.value)}).attr("width",l).attr("height",function(e){return i(e.value)}).attr("fill",function(e){return"Normal"==e.tags[0].name?"#1476b6":"#adc7ea"});var d=e.hierarchy(t.tree,function(e){return e.children}),u=60*(1/d.height+1),p=e.partition().size([o.widthChart-5,u]),m=p(d).descendants(),g=n.selectAll(".cat-node").data(m);g.enter().append("rect").attr("class","cat-node").attr("x",function(e){return e.x0}).attr("y",function(e){return 200-u-(e.y0-u)}).attr("width",function(e){return e.x1-e.x0}).attr("height",function(e){return e.y1-e.y0}).attr("fill",function(e){return e.data.color}).style("visibility",function(e){return"chart"==e.data.name?"hidden":"visible"})},m=function(e,t){s.charts=e=s.patient.barcharts,o=d(e),r=u(e,t);var n=a.selectAll(".sunburst-barchart").data(r);n.enter().append("g").attr("class","sun-chart-g").attr("transform",function(e,t){return"translate("+(t*o.widthChart+o.xChart)+","+(i.innerHeight-380)+")"}),a.selectAll(".sun-chart-g").each(p)};return{init:l,draw:m}}(),g=e.select("#sunburst-chart").append("svg");p.init(g),m.init(g,d)}e.$inject=["d3","osApi","osCohortService","$state","$timeout","$scope","$stateParams","$window","_"];var t={restrict:"E",templateUrl:"app/components/sunburst/sunburst.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osSunburst",e)}(),function(){"use strict";function e(){function e(e,t,n,a,o,r,s,i,c,l,d){function u(){v.setData(p,m),i.setData(p,m)}var p,m,g=i.select("#pca-chart").append("svg"),h=(g.append("g"),g.append("g"),g.append("g"),g.append("g"),{data:[],dataset:t.getDataSource().disease,name:"None",type:"color"},function(e,t){return e.datasource=t.getDataSource(),e.geneSets=[],e.geneSet=null,e.search="",t.query("render_pca",{disease:e.datasource.disease,$fields:["type","geneset","source"]}).then(function(t){var n=t.data.map(function(e){return{a:e.geneset,b:e.source,c:e.type}}),a=d.reduce(n,function(e,t){var n=e;return d.each(t,function(e){d.has(n,e)||(n[e]={}),n=n[e]}),e},{});e.geneSets=Object.keys(a).map(function(e){return{name:e,sources:Object.keys(a[e]).map(function(t){return{name:t,types:Object.keys(a[e][t]).map(function(e){return{name:e}})}})}}),e.geneSet=e.geneSets[0]}),e}(this,t));s.$watch("vm.geneSet",function(){null!=h.geneSet&&(h.sources=h.geneSet.sources,h.source=h.sources[0])}),s.$watch("vm.source",function(){null!=h.geneSet&&(h.pcaTypes=h.source.types,h.pcaType=h.pcaTypes[0])}),s.$watch("vm.pcaType",function(e){null!=e&&t.query("brain_pcascores_cbio_prcomp-allgenes-cnv").then(function(e){h.pc1=e.data[0].pc1,h.pc2=e.data[0].pc2,h.pc3=e.data[0].pc3;var t=Object.keys(e.data[0].data);p=t.map(function(e){return this.data[e].id=e,this.data[e]},{data:e.data[0].data}),m=p.reduce(function(e,t){return e.xMin=Math.min(e.xMin,t[0]),e.xMax=Math.max(e.xMax,t[0]),e.yMin=Math.min(e.yMin,t[1]),e.yMax=Math.max(e.yMax,t[1]),e.zMin=Math.min(e.zMin,t[2]),e.zMax=Math.max(e.zMax,t[2]),e},{xMin:1/0,yMin:1/0,zMin:1/0,xMax:-(1/0),yMax:-(1/0),zMax:-(1/0)}),m.xMax=Math.max(Math.abs(m.xMin),m.xMax),m.xMin=-m.xMax,m.yMax=Math.max(Math.abs(m.yMin),m.yMax),m.yMin=-m.yMax,m.zMax=Math.max(Math.abs(m.zMin),m.zMax),m.zMin=-m.zMax,u()})});var v=function(){function e(){requestAnimationFrame(e),a()}function t(e){l.x=e.clientX/window.innerWidth*2-1,l.y=2*-(e.clientY/window.innerHeight)+1}function n(){g.aspect=window.innerWidth/window.innerHeight,g.updateProjectionMatrix(),o.setSize(window.innerWidth,window.innerHeight)}function a(){var e=i.geometry,t=e.attributes;c.setFromCamera(l,g),r=c.intersectObject(i),r.length>0?s!=r[0].index&&(t.size.array[s]=d,s=r[0].index,t.size.array[s]=1.25*d,t.size.needsUpdate=!0):null!==s&&(t.size.array[s]=d,t.size.needsUpdate=!0,s=null),o.render(m,g)}var o=new THREE.WebGLRenderer({antialias:!0});o.setPixelRatio(window.devicePixelRatio),o.setSize(500,560),o.setClearColor(16777215,1),o.clear(),$("#scatter-chart").append(o.domElement);var r,s,i,c=new THREE.Raycaster,l=new THREE.Vector2,d=3,u=new THREE.ShaderMaterial({uniforms:{color:{value:new THREE.Color(16777215)},texture:{value:(new THREE.TextureLoader).load("assets/images/disc.png")}},vertexShader:document.getElementById("vertexshader").textContent,fragmentShader:document.getElementById("fragmentshader").textContent,alphaTest:.3}),p=new THREE.BufferGeometry,m=new THREE.Scene,g=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,1e4);g.position.z=250;var h=new THREE.OrbitControls(g,o.domElement);h.enableDamping=!0,h.dampingFactor=.25,h.enableZoom=!0,window.addEventListener("mousemove",t,!1),window.addEventListener("resize",n,!1);var v=function(t,n){for(var a=new Float32Array(3*t.length),o=new Float32Array(3*t.length),r=new Float32Array(t.length),s=new THREE.Color,c=0,l=t.length;l>c;c++){var g=3*c;a[g]=t[c][0],a[g+1]=t[c][1],a[g+2]=t[c][2],s.setRGB(.5,.5,.5),s.toArray(o,3*c),r[c]=d}p.addAttribute("position",new THREE.BufferAttribute(a,3)),p.addAttribute("customColor",new THREE.BufferAttribute(o,3)),p.addAttribute("size",new THREE.BufferAttribute(r,1)),i=new THREE.Points(p,u),m.add(i),e()},f=function(e){};new THREE.Color(16711680);return{setData:v,setSelected:f}}(),i=function(){var e=function(e,t){},t=function(e){};return{setData:e,setSelected:t}}()}e.$inject=["$q","osApi","osCohortService","$state","$stateParams","$timeout","$scope","d3","moment","$window","_"];var t={restrict:"E",templateUrl:"app/components/scatter/scatter.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osScatter",e)}(),function(){"use strict";function e(){function e(e,t,n,a,o,r,s,i,c,l,d){function u(){var e=w.selectAll(".plsr-node-selected")[0];0!=e.length&&t.addGeneSelection("PLSR","Manual Selection",w.selectAll(".plsr-node-selected")[0].map(function(e){return e.__data__.name.toUpperCase()}))}function p(){0==S.length?w.selectAll(".plsr-node-selected").classed("plsr-node-selected",!1):w.selectAll("circle").classed("plsr-node-selected",function(){return S.indexOf(this.__data__.name)>=0})}if(angular.isUndefined(a.datasource))return void n.go("datasource");var m,g,h,v,f,b,y,w=s.select("#plsr-chart").append("svg").attr("id","chart"),x=s.select("body").append("div").attr("class","tooltip plsr-tooltip"),A=this;A.datasource=a.datasource,A.deathMinFilter=A.deathMinValue=45,A.deathMaxFilter=A.deathMaxValue=66,A.survivalMinFilter=A.survivalMinValue=3,A.survivalMaxFilter=A.survivalMaxValue=7,A.geneSets=[],A.geneSet=null,A.frame,A.tip=null;var S=null==t.getGeneSelection()?[]:t.getGeneSelection().ids;e.setBusy(!0)("Loading Dataset"),e.setDataset(A.datasource).then(function(n){var a=n.payload.rownames.filter(function(e){return e.indexOf("mtx.mrna")>=0});a=a[a.length-1].replace(".RData",""),e.getPLSR(A.datasource,a).then(function(){e.getGeneSetNames().then(function(n){A.geneSets=n.payload,A.geneSet=A.geneSets[0],e.getSummarizedPLSRPatientAttributes().then(function(e){var n=e.payload;A.deathMinValue=Math.floor(n.AgeDx[0]/365.24),A.deathMaxValue=Math.floor(n.AgeDx[4]/365.24),A.survivalMinValue=Math.floor(n.Survival[0]/365.24),A.survivalMaxValue=Math.floor(n.Survival[4]/365.24),r.$watch("vm.geneSet",function(){A.update()}),t.onGeneSelectionChange.add(function(e){S=e.ids,p()})})})})}),A.update=function(){function t(){m=l.innerWidth-400,"false"==angular.element(".tray-right").attr("locked")&&(m+=300),g=l.innerHeight-190,"true"==angular.element(".tray").attr("locked")&&(m-=300),w.attr("width","100%").attr("height",g),h=s.scale.linear().domain([-f,f]).range([0,m]).nice(),v=s.scale.linear().domain([-b,b]).range([g,0]).nice()}function n(e,n,a){f=.9*e,b=.9*e,t(),y=s.svg.brush().x(h).y(v).on("brushend",function(){var e=y.extent();w.selectAll("circle").classed("plsr-node-selected",function(t){return t[0]>e[0][0]&&t[0]<e[1][0]&&t[1]>e[0][1]&&t[1]<e[1][1]}),s.select(this).transition().duration(300).call(y.extent([[0,0],[0,0]])),u()}),w.call(y);var o=w.selectAll("circle").data(a,function(e){return e});o.enter().append("circle").attr({"class":"plsr-node",cx:.5*m,cy:.5*g,r:3}).style("fill-opacity","0").on("mouseover",function(e){x.transition().duration(200).style("opacity",1),x.html(e.name).style("left",s.event.pageX+15+"px").style("top",s.event.pageY-15+"px")}).on("mouseout",function(){x.transition().duration(500).style("opacity",0)}).on("click",function(e){angular.element("#plsr-webpage").modal();var t="https://www.genecards.org/cgi-bin/carddisp.pl?gene="+e.name;r.$apply(function(){A.frame=c.trustAsResourceUrl(t)})}),o.transition().duration(750).delay(function(e,t){return t/300*500}).attr("cx",function(e){return h(e[0])}).attr("cy",function(e){return v(e[1])}).style("fill-opacity",1),o.exit().transition().duration(600).delay(function(e,t){return t/300*500}).attr("cx",.5*m).attr("cy",.5*g).style("fill-opacity","0").remove();var i=w.selectAll("line").data(n);i.enter().append("line").attr({"class":"line","stroke-width":3,x1:h(0),y1:v(0),x2:h(0),y2:v(0)}).style("stroke",function(e){return e.name.indexOf("Age")?"#1396de":"#38347b"}),i.transition().duration(900).attr({x1:h(0),y1:v(0),x2:function(e){return h(e[0])},y2:function(e){return v(e[1])}}),i.exit().remove();var l=w.selectAll("text").data(n);l.enter().append("text").attr({"class":"text",x:.5*m,y:.5*g,"text-anchor":function(e){return e[0]>0?"start":"end"}}).text(function(e){return e.name}).style({fill:"black","text-anchor":"middle"}),l.transition().duration(900).attr({x:function(e){return h(e[0])},y:function(e){return v(e[1])}}),l.exit().remove(),p()}var a=[{name:"Survival",low:365.24*Number(A.survivalMinFilter),high:365.24*Number(A.survivalMaxFilter)},{name:"AgeDx",low:365.24*Number(A.deathMinFilter),high:365.24*Number(A.deathMaxFilter)}];e.getCalculatedPLSR(A.geneSet,a).then(function(t){var a=t.payload,o=a.loadings.map(function(e,t){return e.name=this[t],e},a.loadingNames),r=a.vectors.map(function(e,t){return e.name=this[t],e},a.vectorNames),s=1.2*a.maxValue;n(s,r,o),e.setBusy(!1)}),A.resize=function(){t(),w.selectAll("circle").attr({cx:function(e){return h(e[0])},cy:function(e){return v(e[1])}}),w.selectAll("text").attr({x:function(e){return h(e[0])},y:function(e){return v(e[1])}}),w.selectAll("line").attr({x1:h(0),y1:v(0),x2:function(e){return h(e[0])},y2:function(e){return v(e[1])}})},angular.element(l).bind("resize",d.debounce(A.resize,300))}}e.$inject=["osApi","osHistory","$state","$stateParams","$timeout","$scope","d3","moment","$sce","$window","_"];var t={restrict:"E",templateUrl:"app/components/plsr/plsr.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osPlsr",e)}(),function(){"use strict";function e(){function e(e,t,n,a,o,r,s,i,c,l,d){function u(){var e=D.sampleIds;k.selectAll("circle").classed("pca-node-selected",function(){return e.indexOf(this.__data__.id)>=0})}function p(){if(T.legendCaption=M.name,T.legendNodes=M.data,"None"==M.name)T.legendCaption="",y.forEach(function(e){e.color="#0096d5"});else{var e=M.data.reduce(function(e,t){for(var n=0;n<t.values.length;n++)e[t.values[n]]=t.color;return e},{});y=y.map(function(e){return e.color=angular.isDefined(this[e.id])?this[e.id]:"#DDD",e},e)}}function m(){p();var e=t.getLayout();x=l.innerWidth-e.left-e.right,A=l.innerHeight-120,angular.element("#pca-chart").css({width:x+"px","padding-left":e.left+"px"}),S.attr("width",x).attr("height",A),E.attr("width",x).attr("height",A),k.attr("width",x).attr("height",A),h=i.scaleLinear().domain([w.xMin,w.xMax]).range([50,x-50]).nice(),v=i.scaleLinear().domain([w.yMin,w.yMax]).range([50,A-50]).nice();var a=k.selectAll("circle").data(y);a.enter().append("svg:circle").attr("class","pca-node").attr("cx",function(e){return h(e[0])}).attr("cy",function(e){return v(e[1])}).attr("r",3).style("fill",function(e){return e.color}),a.exit().transition().duration(200).delay(function(e,t){return t/300*100}).style("fill-opacity","0").remove(),a.style("fill",function(e){return e.color}).transition().duration(750).delay(function(e,t){return t/300*100}).attr("r",3).attr("cx",function(e){return h(e[0])}).attr("cy",function(e){return v(e[1])}).style("fill",function(e){return e.color}).style("fill-opacity",.8),f=i.axisTop().scale(h).ticks(5),b=i.axisLeft().scale(v).ticks(5),C.attr("class","axis").attr("transform","translate(0, "+v(0)+")").call(f).append("text").attr("x",50).attr("y",15).text("PC1"),_.attr("class","axis").attr("transform","translate("+h(0)+", 0)").call(b).append("text").attr("y",55).attr("x",25).text("PC2"),g=i.brush().on("end",function(){if(!i.event.selection)return void n.setCohort([],n.ALL,n.SAMPLE);var e=i.event.selection,t=e[0][0],a=e[1][0],o=e[0][1],r=e[1][1],s=k.selectAll("circle").data().filter(function(e){var n=h(e[0]),s=v(e[1]);return n>t&&a>n&&s>o&&r>s}).map(function(e){return e.id});n.setCohort(s,"PCA",n.SAMPLE)}),E.attr("class","brush").call(g),F(n.getCohort()),t.setBusy(!1)}t.setBusy(!0);var g,h,v,f,b,y,w,x,A,S=i.select("#pca-chart").append("svg"),k=S.append("g"),C=S.append("g"),_=S.append("g"),E=S.append("g"),M={data:[],dataset:t.getDataSource().disease,name:"None",type:"color"},T=function(e,t){return e.datasource=t.getDataSource(),e.geneSets=[],e.geneSet=null,e.search="",e.selectColor=function(e){var t=e.values,a=[];i.selectAll("circle").each(function(e){-1!=t.indexOf(e.id)?(i.select(this).classed("pca-node-selected",!0),a.push(e.id)):i.select(this).classed("pca-node-selected")&&a.push(e.id)}),n.setCohort(a,"PCA",n.SAMPLE)},e.deselectColor=function(e){var t=e.values,a=[];i.selectAll("circle").each(function(e){
-1!=t.indexOf(e.id)?i.select(this).classed("pca-node-selected",!1):i.select(this).classed("pca-node-selected")&&a.push(e.id)}),n.setCohort(a,"PCA",n.SAMPLE)},e}(this,t);s.$watch("vm.geneSet",function(){null!==T.geneSet&&(T.sources=T.geneSet.sources,T.source=T.sources[0])}),s.$watch("vm.source",function(){null!==T.geneSet&&(T.pcaTypes=T.source.types,T.pcaType=T.pcaTypes[0])}),s.$watch("vm.pcaType",function(e){angular.isUndefined(e)||t.query("render_pca",{disease:T.datasource.disease,geneset:T.geneSet.name,type:T.pcaType.name,source:T.source.name}).then(function(e){T.pc1=e.data[0].pc1,T.pc2=e.data[0].pc2;var t=Object.keys(e.data[0].data);y=t.map(function(e){return this.data[e].id=e,this.data[e]},{data:e.data[0].data}),w=y.reduce(function(e,t){return e.xMin=Math.min(e.xMin,t[0]),e.xMax=Math.max(e.xMax,t[0]),e.yMin=Math.min(e.yMin,t[1]),e.yMax=Math.max(e.yMax,t[1]),e},{xMin:1/0,yMin:1/0,xMax:-(1/0),yMax:-(1/0)}),w.xMax=Math.max(Math.abs(w.xMin),w.xMax),w.xMin=-w.xMax,w.yMax=Math.max(Math.abs(w.yMin),w.yMax),w.yMin=-w.yMax,m()})}),t.onResize.add(m),angular.element(l).bind("resize",d.debounce(m,300));var P=function(e){M=e,T.showPanelColor=!1,m()};n.onPatientColorChange.add(P);var D=n.getCohorts(),F=function(e){D=e,u()};n.onCohortChange.add(F),t.query("render_pca",{disease:T.datasource.disease,$fields:["type","geneset","source"]}).then(function(e){var t=e.data.map(function(e){return{a:e.geneset,b:e.source,c:e.type}}),n=d.reduce(t,function(e,t){var n=e;return d.each(t,function(e){d.has(n,e)||(n[e]={}),n=n[e]}),e},{});T.geneSets=Object.keys(n).map(function(e){return{name:e,sources:Object.keys(n[e]).map(function(t){return{name:t,types:Object.keys(n[e][t]).map(function(e){return{name:e}})}})}}),T.geneSet=T.geneSets[0]}),s.$on("$destroy",function(){t.onResize.remove(m),n.onPatientColorChange.remove(P),n.onCohortChange.remove(F)})}e.$inject=["$q","osApi","osCohortService","$state","$stateParams","$timeout","$scope","d3","moment","$window","_"];var t={restrict:"E",templateUrl:"app/components/pca/pca.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osPca",e)}(),function(){"use strict";function e(){function e(e,t,n,a,o,r,s,i,c,l){function d(){var e="rgb(5, 108, 225)",t="red",n="rgb(56, 52,123)",a="green";return[{selector:"node",style:{content:"data(label)","text-valign":"center","text-halign":"center",shape:"ellipse",width:"60px",height:"50px",color:e,"background-color":"rgb(250, 250, 250)","border-width":"2px","border-color":e}},{selector:"edge",style:{width:"2px","line-color":e,"line-style":"solid"}},{selector:'node[nodeType="class"], node[nodeType="family"], node[nodeType="complex"]',style:{content:"","background-color":"white",shape:"roundrectangle"}},{selector:'edge[edgeType="activates"], edge[edgeType="indirectly activates"]',style:{"line-color":a,"target-arrow-shape":"triangle","target-arrow-color":a}},{selector:'edge[edgeType="inhibits"], edge[edgeType="ubiquitinylates"]',style:{"line-color":t,"target-arrow-shape":"tee","target-arrow-color":t}},{selector:'edge[edgeType="fusion"]',style:{"line-color":a}},{selector:'edge[edgeType="contains"]',style:{display:"none"}},{selector:'node[nodeType="process"]',style:{}},{selector:'node[nodeType="gene"]:selected',style:{"overlay-opacity":"0.5","overlay-color":"red"}},{selector:'node[nodeType="rtk"]',style:{content:"data(label)","background-color":"rgb(224, 209, 178)","border-color":"black","border-width":"0px","font-size":"48px",shape:"roundrectangle",width:"40px",height:"160px"}},{selector:'node[nodeType="kinase"]',style:{content:"data(label)","background-color":"rgb(255, 206, 194)",shape:"ellipse",width:"160px",height:"120px","font-size":"48px","border-color":"black","border-width":"1px"}},{selector:'node[nodeType="dimer"]',style:{content:"","background-color":"rgb(234, 219, 188)",shape:"ellipse",width:"160px",height:"120px","font-size":"48px","border-color":"black","border-width":"0px"}},{selector:'node[nodeType="loop"]',style:{content:"","background-color":"rgb(255, 255, 255)",shape:"ellipse",width:"160px",height:"120px","font-size":"48px","border-color":"black","border-width":"1px","border-style":"dotted"}},{selector:'node[nodeType="gtpase"]',style:{content:"data(label)","background-color":"rgb(194, 194, 255)",shape:"ellipse",width:"160px",height:"120px","font-size":"48px","border-color":"black","border-width":"1px"}},{selector:'node[nodeType="adaptor"]',style:{content:"data(label)","background-color":"rgb(77, 184, 255)",shape:"ellipse",width:"60px",height:"120px","font-size":"48px","border-color":"black","border-width":"1px"}},{selector:'node[nodeType="GEF"]',style:{content:"data(label)","background-color":"rgb(77, 184, 255)",shape:"ellipse",width:"60px",height:"60px","font-size":"48px","border-color":"black","border-width":"1px"}},{selector:'node[nodeType="process"]',style:{content:"data(label)","background-color":"rgb(255, 255, 255)",shape:"roundrectangle",width:"100px",height:"40px","font-size":"24px","border-color":"black","border-width":"0px"}},{selector:'node[nodeType="TF"]',style:{content:"data(label)","background-color":"rgb(255, 206, 94)",shape:"diamond",width:"160px",height:"60px","font-size":"48px","border-color":"black","border-width":"1px"}},{selector:'node[nodeType="gene fusion"]',style:{content:"data(label)",shape:"roundrectangle","font-size":"24px","border-color":"red","border-width":"3px"}},{selector:"edge:selected",style:{"overlay-color":"grey","overlay-opacity":"0.3"}},{selector:'edge[edgeType="recruits"]',style:{width:"2px"}},{selector:'edge[edgeType="fusion"]',style:{"line-color":n}},{selector:'edge[edgeType="recruits"]',style:{"line-color":"red",width:"1px","line-style":"dashed","target-arrow-shape":"triangle","target-arrow-color":"black"}},{selector:'edge[edgeType="cycles"]',style:{"line-color":"black",width:"1px","line-style":"dashed","target-arrow-shape":"triangle","source-arrow-shape":"triangle","target-arrow-color":"green","source-arrow-color":"red"}},{selector:'edge[edgeType="associates"]',style:{"line-color":"black",width:"1px","line-style":"solid"}},{selector:'edge[edgeType="activation"]',style:{"line-color":"green",width:"1px"}},{selector:'edge[edgeType="inhibition"]',style:{"line-color":"red",width:"1px"}}]}var u,p,m=this,g=angular.element("#pathways-chart");m.datasource=e.getDataSource(),m.search="",m.frame,m.tip=null,m.linkTitle="",m.links=[],m.resize=function(){g.width("100%"),g.height(s.innerHeight-90),p&&(p.resize(),p.center())},o.$watch("vm.search",function(){if(!angular.isUndefined(p)){var e=m.search.toUpperCase(),t=e.length;p.startBatch(),p.nodes().map(function(n){0==t?n.unselect():n.attr("name").substr(0,t)===e?n.select():n.unselect()}),p.endBatch()}}),e.setBusy(!0),e.query("render_pathways").then(function(t){u=t.data[0],p=c({container:g,elements:u.elements,style:d(),minZoom:.1,maxZoom:5,zoom:.2,wheelSensitivity:.5,layout:{name:"preset",fit:!0}}).on("click","node",function(e){"gene"==e.cyTarget.data().nodeType&&(angular.element("#gbm-webpage").modal(),o.$apply(function(){m.frame=r.trustAsResourceUrl("https://www.genecards.org/cgi-bin/carddisp.pl?gene="+e.cyTarget.data().id)}))}).on("click","edge",function(e){angular.element("#gbm-webpage").modal(),o.$apply(function(){m.frame=r.trustAsResourceUrl("https://www.ncbi.nlm.nih.gov/pubmed/?term="+e.cyTarget.data().pmid)})}).on("mouseover","edge",function(e){o.$apply(function(){m.tip=e.cyTarget.data().source+" Extract"}),e.cyTarget.style({width:"4px"})}).on("mouseout","edge",function(e){o.$apply(function(){m.tip=null}),e.cyTarget.style({width:"2px"})}).on("mouseover","node",function(e){o.$apply(function(){m.tip=e.cyTarget.data().name+" Gene Card"})}).on("mouseout","node",function(){o.$apply(function(){m.tip=null})}),m.resize(),e.setBusy(!1)}),e.onResize.add(m.resize),angular.element(s).bind("resize",l.debounce(m.resize,300))}e.$inject=["osApi","osCohortService","$state","$stateParams","$scope","$sce","$window","moment","cytoscape","_"];var t={restrict:"E",templateUrl:"app/components/pathways/pathways.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osPathways",e)}(),function(){"use strict";function e(){function e(){t.play()}var t=new Audio("data:audio/wav;base64,//uQRAAAAWMSLwUIYAAsYkXgoQwAEaYLWfkWgAI0wWs/ItAAAGDgYtAgAyN+QWaAAihwMWm4G8QQRDiMcCBcH3Cc+CDv/7xA4Tvh9Rz/y8QADBwMWgQAZG/ILNAARQ4GLTcDeIIIhxGOBAuD7hOfBB3/94gcJ3w+o5/5eIAIAAAVwWgQAVQ2ORaIQwEMAJiDg95G4nQL7mQVWI6GwRcfsZAcsKkJvxgxEjzFUgfHoSQ9Qq7KNwqHwuB13MA4a1q/DmBrHgPcmjiGoh//EwC5nGPEmS4RcfkVKOhJf+WOgoxJclFz3kgn//dBA+ya1GhurNn8zb//9NNutNuhz31f////9vt///z+IdAEAAAK4LQIAKobHItEIYCGAExBwe8jcToF9zIKrEdDYIuP2MgOWFSE34wYiR5iqQPj0JIeoVdlG4VD4XA67mAcNa1fhzA1jwHuTRxDUQ//iYBczjHiTJcIuPyKlHQkv/LHQUYkuSi57yQT//uggfZNajQ3Vmz+Zt//+mm3Wm3Q576v////+32///5/EOgAAADVghQAAAAA//uQZAUAB1WI0PZugAAAAAoQwAAAEk3nRd2qAAAAACiDgAAAAAAABCqEEQRLCgwpBGMlJkIz8jKhGvj4k6jzRnqasNKIeoh5gI7BJaC1A1AoNBjJgbyApVS4IDlZgDU5WUAxEKDNmmALHzZp0Fkz1FMTmGFl1FMEyodIavcCAUHDWrKAIA4aa2oCgILEBupZgHvAhEBcZ6joQBxS76AgccrFlczBvKLC0QI2cBoCFvfTDAo7eoOQInqDPBtvrDEZBNYN5xwNwxQRfw8ZQ5wQVLvO8OYU+mHvFLlDh05Mdg7BT6YrRPpCBznMB2r//xKJjyyOh+cImr2/4doscwD6neZjuZR4AgAABYAAAABy1xcdQtxYBYYZdifkUDgzzXaXn98Z0oi9ILU5mBjFANmRwlVJ3/6jYDAmxaiDG3/6xjQQCCKkRb/6kg/wW+kSJ5//rLobkLSiKmqP/0ikJuDaSaSf/6JiLYLEYnW/+kXg1WRVJL/9EmQ1YZIsv/6Qzwy5qk7/+tEU0nkls3/zIUMPKNX/6yZLf+kFgAfgGyLFAUwY//uQZAUABcd5UiNPVXAAAApAAAAAE0VZQKw9ISAAACgAAAAAVQIygIElVrFkBS+Jhi+EAuu+lKAkYUEIsmEAEoMeDmCETMvfSHTGkF5RWH7kz/ESHWPAq/kcCRhqBtMdokPdM7vil7RG98A2sc7zO6ZvTdM7pmOUAZTnJW+NXxqmd41dqJ6mLTXxrPpnV8avaIf5SvL7pndPvPpndJR9Kuu8fePvuiuhorgWjp7Mf/PRjxcFCPDkW31srioCExivv9lcwKEaHsf/7ow2Fl1T/9RkXgEhYElAoCLFtMArxwivDJJ+bR1HTKJdlEoTELCIqgEwVGSQ+hIm0NbK8WXcTEI0UPoa2NbG4y2K00JEWbZavJXkYaqo9CRHS55FcZTjKEk3NKoCYUnSQ0rWxrZbFKbKIhOKPZe1cJKzZSaQrIyULHDZmV5K4xySsDRKWOruanGtjLJXFEmwaIbDLX0hIPBUQPVFVkQkDoUNfSoDgQGKPekoxeGzA4DUvnn4bxzcZrtJyipKfPNy5w+9lnXwgqsiyHNeSVpemw4bWb9psYeq//uQZBoABQt4yMVxYAIAAAkQoAAAHvYpL5m6AAgAACXDAAAAD59jblTirQe9upFsmZbpMudy7Lz1X1DYsxOOSWpfPqNX2WqktK0DMvuGwlbNj44TleLPQ+Gsfb+GOWOKJoIrWb3cIMeeON6lz2umTqMXV8Mj30yWPpjoSa9ujK8SyeJP5y5mOW1D6hvLepeveEAEDo0mgCRClOEgANv3B9a6fikgUSu/DmAMATrGx7nng5p5iimPNZsfQLYB2sDLIkzRKZOHGAaUyDcpFBSLG9MCQALgAIgQs2YunOszLSAyQYPVC2YdGGeHD2dTdJk1pAHGAWDjnkcLKFymS3RQZTInzySoBwMG0QueC3gMsCEYxUqlrcxK6k1LQQcsmyYeQPdC2YfuGPASCBkcVMQQqpVJshui1tkXQJQV0OXGAZMXSOEEBRirXbVRQW7ugq7IM7rPWSZyDlM3IuNEkxzCOJ0ny2ThNkyRai1b6ev//3dzNGzNb//4uAvHT5sURcZCFcuKLhOFs8mLAAEAt4UWAAIABAAAAAB4qbHo0tIjVkUU//uQZAwABfSFz3ZqQAAAAAngwAAAE1HjMp2qAAAAACZDgAAAD5UkTE1UgZEUExqYynN1qZvqIOREEFmBcJQkwdxiFtw0qEOkGYfRDifBui9MQg4QAHAqWtAWHoCxu1Yf4VfWLPIM2mHDFsbQEVGwyqQoQcwnfHeIkNt9YnkiaS1oizycqJrx4KOQjahZxWbcZgztj2c49nKmkId44S71j0c8eV9yDK6uPRzx5X18eDvjvQ6yKo9ZSS6l//8elePK/Lf//IInrOF/FvDoADYAGBMGb7FtErm5MXMlmPAJQVgWta7Zx2go+8xJ0UiCb8LHHdftWyLJE0QIAIsI+UbXu67dZMjmgDGCGl1H+vpF4NSDckSIkk7Vd+sxEhBQMRU8j/12UIRhzSaUdQ+rQU5kGeFxm+hb1oh6pWWmv3uvmReDl0UnvtapVaIzo1jZbf/pD6ElLqSX+rUmOQNpJFa/r+sa4e/pBlAABoAAAAA3CUgShLdGIxsY7AUABPRrgCABdDuQ5GC7DqPQCgbbJUAoRSUj+NIEig0YfyWUho1VBBBA//uQZB4ABZx5zfMakeAAAAmwAAAAF5F3P0w9GtAAACfAAAAAwLhMDmAYWMgVEG1U0FIGCBgXBXAtfMH10000EEEEEECUBYln03TTTdNBDZopopYvrTTdNa325mImNg3TTPV9q3pmY0xoO6bv3r00y+IDGid/9aaaZTGMuj9mpu9Mpio1dXrr5HERTZSmqU36A3CumzN/9Robv/Xx4v9ijkSRSNLQhAWumap82WRSBUqXStV/YcS+XVLnSS+WLDroqArFkMEsAS+eWmrUzrO0oEmE40RlMZ5+ODIkAyKAGUwZ3mVKmcamcJnMW26MRPgUw6j+LkhyHGVGYjSUUKNpuJUQoOIAyDvEyG8S5yfK6dhZc0Tx1KI/gviKL6qvvFs1+bWtaz58uUNnryq6kt5RzOCkPWlVqVX2a/EEBUdU1KrXLf40GoiiFXK///qpoiDXrOgqDR38JB0bw7SoL+ZB9o1RCkQjQ2CBYZKd/+VJxZRRZlqSkKiws0WFxUyCwsKiMy7hUVFhIaCrNQsKkTIsLivwKKigsj8XYlwt/WKi2N4d//uQRCSAAjURNIHpMZBGYiaQPSYyAAABLAAAAAAAACWAAAAApUF/Mg+0aohSIRobBAsMlO//Kk4soosy1JSFRYWaLC4qZBYWFRGZdwqKiwkNBVmoWFSJkWFxX4FFRQWR+LsS4W/rFRb/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////VEFHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAU291bmRib3kuZGUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMjAwNGh0dHA6Ly93d3cuc291bmRib3kuZGUAAAAAAAAAACU=");return{beep:e}}angular.module("oncoscape").service("osSound",e)}(),function(){"use strict";function e(e,t){var n=t.protocol()+"://"+t.host()+"/api/";n="https://oncoscape-test.fhcrc.org/api/";var a=function(e){var t=n+e.table;return angular.isDefined(e.query)&&(t+="/"+encodeURIComponent(angular.toJson(e.query))),t},o=function(t){return e({method:"GET",url:a(t),headers:{apikey:"password"}})};return{queryString:a,query:o}}e.$inject=["$http","$location"],angular.module("oncoscape").factory("osHttp",e)}(),function(){"use strict"}(),function(){"use strict";function e(e,t,n,a,o,r,s){var i,c=new n.Signal,l=new n.Signal,d=new n.Signal,u=function(){return i},p=function(e){i=e,d.dispatch(e)},m=null,g=null,h=null,v=null,f=function(){return h},b=function(){return v},y=function(){return g},w=function(e){function t(e,t){return e.time>t.time?1:e.time<t.time?-1:e.censor>t.censor?1:e.censor<t.censor?-1:0}function n(t,n){var a=t.length,o=2>a?1:6>a?2:9>a?3:18>a?6:36>a?8:10,r=t.map(function(e){return e[n]}),s={type:"numeric",min:e.min(r),max:e.max(r),range:e.range(r),sd:e.stdev(r),hist:e.histogram(r,o),histRange:[],bins:o};return s.histRange=[e.min(s.hist),e.max(s.hist)],o=Math.round(s.range/o),s.hist=s.hist.map(function(e){var t={label:this.start+"-"+(this.start+this.bin),value:e};return this.start+=this.bin,t},{bin:o,start:s.min}),s}function a(t,n){var a=t.map(function(e){return e[n]}),o=a.reduce(function(e,t){return e[t]=e.hasOwnProperty(t)?e[t]+1:1,e},{});o=Object.keys(o).map(function(e){return{label:e,value:this.factors[e]}},{factors:o});var r=o.map(function(e){return e.value}),s={type:"factor",min:e.min(r),max:e.max(r),range:e.range(r),ds:e.stdev(r),hist:o,histRange:[],bins:o.length};return s.histRange=[s.min,s.max],s}var o=function(e,t){var o=e.map(function(e){var t=this[e];return null===t?null:t.clinical},t.patientMap).filter(function(e){return null!=e});return{total:Object.keys(t.patientMap).length,selected:o.length,features:[{label:"Age At Diagnosis",data:n(o,"age_at_diagnosis"),prop:"age_at_diagnosis",type:"numeric"},{label:"Gender",data:a(o,"gender"),prop:"gender",type:"factor"},{label:"Race",data:a(o,"race"),prop:"race",type:"factor"},{label:"Ethnicity",data:a(o,"ethnicity"),prop:"ethnicity",type:"factor"},{label:"Vital",data:a(o,"status_vital"),prop:"status_vital",type:"factor"},{label:"Tumor",data:a(o,"status_tumor"),prop:"Status_tumor",type:"factor"}]}},r=function(e,n){var a=e.map(function(e){var t=this[e];return null===t?null:t.survival},n.patientMap).filter(function(e){return void 0!==e}).sort(t),o={total:a.length,alive:a.reduce(function(e,t){return e+t.censor},0),dead:a.reduce(function(e,t){return e+Math.abs(t.censor-1)},0),min:a.reduce(function(e,t){return Math.min(e,t.time)},1/0),max:a.reduce(function(e,t){return Math.max(e,t.time)},-(1/0)),data:a},r=o.data.reduce(function(e,t){var n=0===t.censor;n&&(e.dead+=1);var a=e.hasOwnProperty(t.time)?e[t.time]:{survivalFrom:e.survival,time:0,dead:[],alive:[]};return a.time=t.time,a.survivalTo=Math.round(100*(1-e.dead/e.total)),a[n?"dead":"alive"].push(t.pid),e[a.time]=a,e.survival=a.survivalTo,e},{dead:0,total:o.total,survival:100});return delete r.survival,delete r.total,delete r.dead,o.data=Object.keys(r).map(function(e){return this[e]},r).reduce(function(e,t){return t.dead.length>0&&e.lines.push(t),t.alive.length>0&&e.ticks.push(t),e},{ticks:[],lines:[]}),o};return{createHistogram:o,createSurvival:r}}(o),x=function(e,t,n){var a=null,o=null,r=function(e){a=e,o={color:"#0b97d3",patientIds:[],sampleIds:[],name:"All Patients + Samples",histogram:t.createHistogram(Object.keys(e.patientMap),e),survival:t.createSurvival(Object.keys(e.patientMap),e),show:!0,type:"ALL"}},s=function(e,t,n){if(0===t.length)return o;var a=t.map(function(e){return this.hasOwnProperty(e)?this[e]:null},n.sampleMap).filter(function(e){return null!==e}).filter(function(e,t,n){return n.indexOf(e)===t});return c(e,a,t)},i=function(e,t,n){if(0===t.length)return o;var a=[].concat.apply([],t.map(function(e){return this.hasOwnProperty(e)?this[e].samples:null},n.patientMap)).filter(function(e,t,n){return n.indexOf(e)===t});return c(e,t,a)},c=function(e,n,o){return{uuid:Math.random().toString().substr(2),color:"#000",patientIds:n,sampleIds:o,name:e,histogram:t.createHistogram(n,a),survival:t.createSurvival(n,a),show:!0,type:"UNSAVED"}};return{setData:r,createWithSampleIds:s,createWithPatientIds:i}}(e,w,g),A=function(e,t,n){angular.isArray(e)&&(e=x["PATIENT"==n?"createWithPatientIds":"createWithSampleIds"](t,e,g),e.type="UNSAVED"),v=e,c.dispatch(v)},S=function(){return new Promise(function(t){null!==g&&t(g),m=e.getDataSource(),a.all([e.query(m.clinical.samplemap),e.query(m.clinical.patient)]).then(function(e){var n={};n.sampleMap=e[0].data[0],n.patientMap=Object.keys(n.sampleMap).reduce(function(e,t){var a=n.sampleMap[t],o=t;return e.hasOwnProperty(a)?e[a].samples.push(o):e[a]={samples:[o]},e},{}),e[1].data.reduce(function(e,t){return e.hasOwnProperty(t.patient_ID)?e[t.patient_ID].clinical=t:e[t.patient_ID]={clinical:t,samples:[]},e},n.patientMap),e[1].data.map(function(e){if(!e.hasOwnProperty("status_vital"))return null;if(null===e.status_vital)return null;var t,n=e.status_vital.toString().trim().toUpperCase();return"ALIVE"==n?e.hasOwnProperty("days_to_last_follow_up")?(t=parseInt(e.days_to_last_follow_up),0>t&&(t=0),isNaN(t)?null:{pid:e.patient_ID,censor:1,time:t}):null:"DEAD"==n&&e.hasOwnProperty("days_to_death")?(t=parseInt(e.days_to_death),0>t&&(t=0),isNaN(t)?null:{pid:e.patient_ID,censor:0,time:t}):null}).reduce(function(e,t){return null!==t&&(e[t.pid].survival=t),e},n.patientMap),x.setData(n),g=n,t(g)})})},k=function(){return new Promise(function(t){S().then(function(){h=s.getItem(e.getDataSource().disease+"Cohorts"),null!==h?(h=angular.fromJson(h),v=h[0]):(h=[x.createWithPatientIds("ALL",[],g)],v=h[0],v.type="ALL"),l.dispatch(h),c.dispatch(v),t(h)})})},C=["#E91E63","#673AB7","#4CAF50","#CDDC39","#FFC107","#FF5722","#795548","#607D8B","#03A9F4","#03A9F4","#004358","#800080","#BEDB39","#FD7400","#1F8A70"],_=function(){var t=h.map(function(e){return e.color}),n=C.filter(function(e){return-1==t.indexOf(e)});v.color=n[0],v.type="SAVED",h.push(v),s.setItem(e.getDataSource().disease+"Cohorts",angular.toJson(h))},E=function(e){},M={ALL:"All Patients",SAMPLE:"SAMPLE",PATIENT:"PATIENT",onPatientColorChange:d,setPatientColor:p,getPatientColor:u,onCohortChange:c,onCohortsChange:l,loadCohorts:k,getData:y,getCohorts:f,getCohort:b,setCohort:A,saveCohort:_,deleteCohort:E};return M}e.$inject=["osApi","moment","signals","$q","jStat","_","localStorage"],angular.module("oncoscape").service("osCohortService",e)}(),function(){"use strict";function e(e,t,n,a,o,r){var s=new n.Signal,i=new n.Signal,c=null,l=function(){return c},d=function(){return null!=c},u=null,p=[{id:"guest",name:"Guest",icon:"fa fa-user"},{id:"google",name:"Google",icon:"fa fa-google-plus",key:"428912153446-7c82srcvu1bk1nramiqqctne005epl6s.apps.googleusercontent.com",mode:"implicit"},{id:"linkedin",name:"LinkedIn",icon:"fa fa-linkedin",key:"7869gkuwwnacez",mode:"explicit"}],m=function(){return p},g=function(){c={network:"guest",id:"x",name:"Guest",thumb:"Guest.png"},r.init().then(function(){s.dispatch()})},h=function(e){return"guest"==e.id?(c={network:"guest",id:"x",name:"Guest",thumb:"Guest.png"},void r.init().then(function(){s.dispatch()})):void o().login(e.id,{response_type:"code",display:"page",force:!1,scope:"email"})},v=function(){o().logout(u,{force:!1},i.dispatch)};return o.init(p.reduce(function(e,t){return e[t.id]=t.key,e},{}),{oauth_proxy:"/api/auth",redirect_uri:"https://dev.oncoscape.sttrcancer.io/"}),o.on("auth.login",function(e){r.setBusy(),u=e.network,o(u).api("/me","get",null,function(e){c={network:u,id:e.id,name:e.name,thumb:e.thumbnail},r.init().then(function(){s.dispatch()})})}),{isAuthenticated:d,loginGuest:g,getUser:l,getAuthSources:m,login:h,logout:v,onLogin:s,onLogout:i}}e.$inject=["osHttp","$http","signals","$location","auth","osApi"],angular.module("oncoscape").service("osAuth",e)}(),function(){"use strict";function e(e,t,n,a,o,r){function s(){return o(function(e,t){b("lookup_oncoscape_datasources",{beta:!1}).then(function(t){i=t.data.filter(function(e){return angular.isDefined(e.img)}).map(function(e){return e.name=e.name.trim(),e}).sort(function(e,t){return e.name<t.name?-1:e.name>t.name?1:0}),e(i)},t)})}var i,c,l,d=new n.Signal,u=new n.Signal,p=function(){var e=angular.element(".tray-right").attr("locked");return angular.isUndefined(e)&&(e="true"),{left:"true"==angular.element("#cohortmenu-lock").attr("locked")?300:0,right:"true"===e?300:0}},m=function(e){e?angular.element(".loader-modal").show():angular.element(".loader-modal").hide()},g=function(){return i},h=function(){return c},v=function(e){angular.isObject(e)?c!=e&&(c=e,d.dispatch(c)):angular.isString(e)&&c.disease!=e&&c!=e&&(c=i.filter(function(e){return e.disease==this.key},{key:e})[0],d.dispatch(c))},f=function(t,n){return e.queryString({table:t,query:n})},b=function(t,n){return e.query({table:t,query:n})};(function(e){var t=e.substring(0,e.replace("//","--").indexOf("/")),n=function(n,a){var o="get"+a.charAt(0).toUpperCase()+a.slice(1).toLowerCase();n[o]=function(n){return new Promise(function(o){r.ajax({url:e+"/"+a,type:"POST",data:angular.toJson(n),contentType:"application/json; charset=utf-8",dataType:"text",beforeSend:function(e,t){t.xhrFields=t.xhrFields||{},t.xhrFields.withCredentials=!1,t.crossDomain=!0}}).done(function(e){e=e.split("\n");var n=t+e[0];r.ajax({url:n,type:"GET",crossDomain:!0,beforeSend:function(e,t){t.xhrFields=t.xhrFields||{},t.xhrFields.withCredentials=!1,t.crossDomain=!0}}).done(function(e){o(e)})})})}};return new Promise(function(t){r.get(e).then(function(a){var o=a.split("\n").reduce(function(e,t){return""!=t&&n(e,t),e},{});o.getEndpoint=function(){return e},t(o)})})})("https://oncoscape-test.fhcrc.org/ocpu/library/oncoscape/R").then(function(e){l=e});var y=function(){return l};return{init:s,query:b,getCpuApi:y,queryString:f,setDataSource:v,getDataSource:h,getDataSources:g,getLayout:p,onDataSource:d,onResize:u,setBusy:m}}e.$inject=["osHttp","$http","signals","$location","$q","$"],angular.module("oncoscape").service("osApi",e)}(),function(){"use strict";function e(){function e(e,t,n,a,o,r,s,i,c,l,d,u,p){function m(e){e.sampleIds.length!=O&&(O=e.sampleIds.length,x.startBatch(),x.$('node[nodeType="patient"]:selected').deselect(),x.$('node[nodeType="patient"]').forEach(function(t){-1!=e.sampleIds.indexOf(t.id())&&t.select()}),x.endBatch())}function g(){var e=x.$('node[nodeType="patient"]:selected');e.length!=O&&(O=e.length,n.setCohort(e.map(function(e){return e.data().id}),"Markers + Patients",n.SAMPLE))}function h(){}e.setBusy(!0);var v,f,b=function(){return{patients:{select:new c.Signal,unselect:new c.Signal,over:new c.Signal,out:new c.Signal},genes:{select:new c.Signal,unselect:new c.Signal,over:new c.Signal,out:new c.Signal},edges:{select:new c.Signal,unselect:new c.Signal,over:new c.Signal,out:new c.Signal},clear:function(){this.edges.select.removeAll(),this.edges.unselect.removeAll(),this.edges.over.removeAll(),this.edges.out.removeAll(),this.patients.select.removeAll(),this.patients.unselect.removeAll(),this.patients.over.removeAll(),this.patients.out.removeAll(),this.genes.select.removeAll(),this.genes.unselect.removeAll(),this.genes.over.removeAll(),this.genes.out.removeAll()}}}(),y=function(e,t){var n=localStorage.getItem("MP-"+e.getDataSource().disease),a=null!==n;a&&(n=angular.fromJson(n));var o=null,r=function(e){o=e},s=function(e,o){a&&(t.onPatientColorChange.dispatch(n.optColors),requestAnimationFrame(function(){o.startBatch(),o.add(n.edges),o.endBatch()}))},i=function(){return a?n.optEdgeColors:[{name:"mutation",abv:"m",show:!0,color:"#9C27B0","class":"switch-mutation",count:"",id:0},{name:"cnGain.1",abv:"cnG1",show:!0,color:"#03A9F4","class":"switch-cnG1",count:"",id:1},{name:"cnGain.2",abv:"cnG2",show:!0,color:"#3F51B5","class":"switch-cnG2",count:"",id:2},{name:"cnLoss.1",abv:"cnL1",show:!0,color:"#FF9800","class":"switch-cnL1",count:"",id:-1},{name:"cnLoss.2",abv:"cnL2",show:!0,color:"#F44336","class":"switch-cnL2",count:"",id:-2}]},c=function(t){return a?t.filter(function(e){return e.name==n.optGeneSet.name},n.optGeneSet.name)[0]:"brain"==e.getDataSource().disease?t.filter(function(e){return"Marker genes 545"==e.name})[0]:t.filter(function(e){return"TCGA pancan mutated"==e.name})[0]},l=function(e){return a?e.filter(function(e){return e.name==n.optPatientLayout.name},n.optPatientLayout.name)[0]:e[0]},d=function(t,n){var a={};a.optEdgeColors=t.optEdgeColors,a.optGeneSet=t.optGeneSet,a.optPatientLayout=t.optPatientLayout,a.optColors=o,a.edges=n.$('edge[edgeType="cn"]').jsons(),localStorage.setItem("MP-"+e.getDataSource().disease,angular.toJson(a))};return{applyState:s,getOptEdgeColors:i,getGeneSet:c,getPatientLayout:l,setColors:r,save:d}}(e,n),w=angular.element("#markers-chart"),x=function(e){return i({container:e,style:[{selector:"core",style:{"selection-box-color":"#3993fa","selection-box-border-color":"#3993fa","selection-box-border-width":"1px","selection-box-opacity":".2"}},{selector:"node",style:{"background-color":"#3993fa",display:"data(display)",width:"data(sizeEle)",height:"data(sizeEle)","border-width":"data(sizeBdr)","font-size":"data(sizeLbl)","text-valign":"center"}},{selector:'node[nodeType="telomere"]',style:{"background-color":"#3993fa"}},{selector:'node[nodeType="patient"]',style:{"background-color":"data(color)","text-halign":"center","border-color":"#FFFFFF"}},{selector:'node[nodeType="patient"]:selected',style:{"background-color":"data(color)","border-color":"#000","border-width":5}},{selector:'node[nodeType="gene"]',style:{"background-color":"data(color)","border-color":"data(colorBdr)","text-halign":"right","text-margin-x":5,color:"#000",label:"data(id)","border-width":"data(sizeBdr)"}},{selector:'node[nodeType="gene"]:selected',style:{"background-color":"#000000","border-color":"#000"}},{selector:'node[nodeType="centromere"]',style:{"font-size":"20px","text-halign":"center","background-color":"#3993fa",color:"#FFFFFF","border-color":"rgb(19, 150, 222)",height:"40px",width:"40px",shape:"round",label:"  data(id)"}},{selector:"edge",style:{display:"data(display)","line-color":"data(color)",width:"data(sizeEle)"}},{selector:'node[nodeType="annotation-text"]',style:{"font-size":"400px","text-halign":"right","text-valign":"bottom","background-color":"#FFF",color:"#000","border-color":"#FFF",height:"0px",width:"0px",shape:"round",label:"data(label)","text-transform":"uppercase"}}],hideEdgesOnViewport:!1,hideLabelsOnViewport:!0,textureOnViewport:!1,wheelSensitivity:.5,zoom:.08,pan:{x:650,y:160},minZoom:.05,maxZoom:20,layout:{name:"preset",fit:!0}})}(w);!function(){e.query("render_chromosome",{type:"chromosome"}).then(function(e){var t=e.data[0].data,n=[];Object.keys(t).forEach(function(e){var t=this.chromosomes[e];this.elements.push({group:"edges",grabbable:!1,locked:!0,selectable:!1,data:{color:"#3993fa",id:"ce"+e,display:"element",edgeType:"chromosome",sizeBdr:0,sizeEle:3,source:"cp"+e,target:"cq"+e}}),this.elements.push({group:"nodes",grabbable:!1,locked:!0,selectable:!1,position:{x:t.x,y:t.p},data:{id:"cp"+e,display:"element",nodeType:"telomere",degree:1,sizeBdr:1,sizeEle:1,sizeLbl:1,subType:"unassigned"}}),this.elements.push({group:"nodes",grabbable:!1,locked:!0,selectable:!1,position:{x:t.x,y:t.q},data:{id:"cq"+e,display:"element",nodeType:"telomere",degree:1,sizeBdr:5,sizeEle:5,sizeLbl:5,subType:"unassigned"}}),this.elements.push({group:"nodes",grabbable:!1,locked:!0,selectable:!1,position:{x:t.x,y:t.c},data:{id:e,display:"element",sizeBdr:1,sizeEle:10,sizeLbl:10,nodeType:"centromere",degree:1}})},{chromosomes:t,elements:n}),x.add(n)})}();var A=function(e,t,n){return e.showPopupSelection=!1,e.datasource=t.getDataSource(),e.detail={show:!1,html:"",title:""},e.optGeneSets=[],e.optGeneSet=null,e.optPatientLayouts=[],e.optPatientLayout=null,e.showPanelLayout=!1,e.showPanelColor=!1,e.showPanelColorRna=!1,e.search="",e.optCommandModes=[{name:"Sequential"},{name:"Set"},{name:"Ad Hoc"}],e.optCommandMode=e.optCommandModes[0],e.hideModal=function(){angular.element("#modalEdge").modal("hide")},e.filterModelEdge=function(){angular.element("#modalEdge").modal("hide");var t=e.optEdgeColors.filter(function(e){return e.show}).map(function(e){return e.id}),n=v.edges.filter(function(e){return-1!=t.indexOf(e.data.cn)},{vals:t});x.startBatch(),x.add(n),x.endBatch(),v=null},e.edgeToggle=function(){e.cmd("ShowSelectedEdges")},e.selectColor=function(e){var t=e.color,n=x.$('node[nodeType="patient"]');x.startBatch(),n.forEach(function(e){e.data().color==this&&e.select()},t),x.endBatch()},e.deselectColor=function(e){var t=e.color,n=x.$('node[nodeType="patient"]:selected');x.startBatch(),n.forEach(function(e){e.data().color==this&&e.unselect()},t),x.endBatch()},e.lockPatients=!1,e.lockGenes=!1,e.lock=function(t){switch(t){case"patient":e.lockPatients=!e.lockPatients,x.startBatch(),x.$('node[nodeType="patient"]').forEach(function(t){e.lockPatients?t.unselectify():t.selectify()}),x.endBatch();break;case"gene":e.lockGenes=!e.lockGenes,x.startBatch(),x.$('node[nodeType="cn"]').forEach(function(t){e.lockGenes?t.unselectify():t.selectify()}),x.endBatch()}},e.optEdgeColors=n.getOptEdgeColors(),p.all([t.query("render_chromosome",{type:"geneset",$fields:["name"]}),t.query("render_patient",{type:"cluster",dataset:t.getDataSource().disease,$fields:["name"]}),t.query("render_patient",{type:"color",dataset:t.getDataSource().disease,$fields:["name"]})]).then(function(t){e.optGeneSets=t[0].data,e.optGeneSet=n.getGeneSet(e.optGeneSets),e.optPatientLayouts=t[1].data,e.optPatientLayout=n.getPatientLayout(e.optPatientLayouts)}),e.resize=function(){var e=d.innerWidth;w.width(e),w.height(d.innerHeight-90),x.resize()},angular.element(d).bind("resize",u.debounce(e.resize,300)),e}(this,e,y),S=function(e,t){var n=function(){e.fit(),e.center()},a=function(){e.fit(e.$(":selected"),50)};return t.zoom={reset:n,fit:a},e.on("pan",u.debounce(function(){e.startBatch(),M(),e.endBatch()},50)),t.zoom}(x,A),k=t.scaleLog().domain([.005,20]).range([5,1]),C=t.scaleLog().domain([.005,20]).range([80,1]),_=t.scaleLog().domain([.005,20]).range([50,1]),E=t.scalePow().range([.01,2]),M=function(){E.domain(x.$('node[nodeType="patient"],node[nodeType="gene"]').toArray().reduce(function(e,t){var n=t.data().weight;return e[0]=Math.min(e[0],n),e[1]=Math.max(e[1],n),e},[1/0,-(1/0)]));var e=x.zoom(),t=C(e),n=.375>e?0:_(e),a=k(e);x.$('node[nodeType="patient"],node[nodeType="gene"]').forEach(function(e){e.data({sizeEle:Math.round(this.sizeNode*E(e.data().weight)),sizeLbl:this.sizeLbl,sizeBdr:this.sizeBdr})},{sizeNode:t,sizeBdr:a,sizeLbl:n,scale:E})},T=function(e,t,a,o,s,i,c){var l={};f=new Worker("app/components/markers/markers.worker.js"),f.addEventListener("message",function(e){l[e.data.cmd](e.data.data)},!1);var d=function(t,n){if(angular.isUndefined(n))return void e.remove(t);if(0!=n.length){var a=n.map(function(e){return this.getElementById(e)},e);try{e.collection(a).remove()}catch(o){}}};return l.patients_html=function(){},l.patients_resize=function(){},l.patients_delete=function(e){d('node[nodeType="patient"]',e)},l.patients_insert=function(a){e.startBatch();var o=e.add(a.patients);o.on("select",i.debounce(c.patients.select.dispatch,300)),o.on("unselect",i.debounce(c.patients.unselect.dispatch,300)),o.on("mouseover",c.patients.over.dispatch),o.on("mouseout",c.patients.out.dispatch),o.forEach(function(e){try{e.data({weight:a.degrees[e.id()].weight})}catch(t){e.data({weight:100})}}),M(),e.endBatch(),t.resize();var r=n.getCohort();e.startBatch(),e.nodes('node[nodeType="patient"]').forEach(function(e){
-1!=this.indexOf(e.id())&&e.select()},r.sampleIds),e.endBatch(),t.zoom.reset(),e.center(),e.fit(e.nodes(),400),y.applyState($,e)},l.patients_layout=function(t){e.startBatch(),e.$("node[nodeType='annotation-text'],edge[nodeType='annotation-line'],node[nodeType='annotation-point']").remove(),t.annotation&&e.add(t.annotation),e.nodes('node[nodeType="patient"]').forEach(function(e){try{var n=t.data[e.id()];n.x-=4e3,e.position(n)}catch(a){}}),M(),e.endBatch()},l.genes_html=function(){},l.genes_delete=function(e){d('node[nodeType="gene"]',e)},l.genes_insert=function(t){e.startBatch();var n=e.add(t.genes);n.on("select",i.debounce(c.genes.select.dispatch,300)),n.on("unselect",i.debounce(c.genes.unselect.dispatch,300)),n.on("mouseover",c.genes.over.dispatch),n.on("mouseout",c.genes.out.dispatch),n.forEach(function(e){try{e.data({weight:t.degrees[e.id()].weight})}catch(n){e.data({weight:500})}}),e.endBatch(),M(),a.setBusy(!1)},l.edges_delete=function(e){d('edge[edgeType="cn"]',e)},l.edges_insert=function(n){if(v=n,n.counts.total>5e3)return angular.element("#modalEdge").modal(),void r.$apply(function(){t.edgeCounts=n.counts});if("Ad Hoc"==t.optCommandMode.name){e.startBatch(),e.$('edge[edgeType="cn"]').remove();var a=e.add(n.edges);if("patient"==D){var o=a.map(function(e){return[e.data().source,e.data().color]}).reduce(function(e,t){return e[t[0]]=t[1],e},{});e.$('node[nodeType="gene"]').forEach(function(e){var t=e.id(),n=this.hasOwnProperty(t);e.data("sizeBdr",n?10:1),e.data("colorBdr",n?this[t]:"#FFFFFF"),e.data("color",n?this[t]:"#0096d5")},o)}e.endBatch()}else{e.startBatch();try{e.add(n.edges)}catch(s){}t.edgeCounts=n.counts,e.endBatch()}},function(e){f.postMessage({cmd:"setOptions",data:e})}}(x,A,e,p,S,u,b),P=function(t,n){return function(a){a=a||"";var o=n.optGeneSet.name,r=e.getDataSource().edges.filter(function(e){return e.name==this.geneset},{geneset:o})[0],s={mode:n.optCommandMode.name,cmd:a,dataset:e.getDataSource().disease,patients:{data:n.datasource.clinical.patient,layout:n.optPatientLayout.name,selected:t.$('node[nodeType="patient"]:selected').map(function(e){return e.data().id})},genes:{layout:n.optGeneSet.name,selected:t.$('node[nodeType="gene"]:selected').map(function(e){return e.data().id})},edges:{patientWeights:r.patientWeights,geneWeights:r.genesWeights,layout:n.datasource.edges.filter(function(e){return e.name==this},o)[0],colors:n.optEdgeColors.filter(function(e){return e.show}).map(function(e){return{id:e.id,color:e.color}})}};return s}}(x,A);A.cmd=function(){},function(t,n){var a=1,o=function(){T(P())};a+=0,n.$watch("vm.optGeneSet",function(){return a>0?void(a-=1):void(angular.isUndefined(t.optGeneSet)||angular.isUndefined(t.optPatientLayout)||(e.setBusy(!0),x.$('edge[edgeType="cn"]').remove(),o()))}),a+=1,n.$watch("vm.optPatientLayout",function(){return a>0?void(a-=1):void o()}),a+=1,n.$watch("vm.search",u.debounce(function(){if(a>0)return void(a-=1);var e=t.search.toUpperCase().trim();e.length>0&&x.$("node").filter(function(t,n){return 0==n.id().toUpperCase().indexOf(e)}).select()},600)),a+=1,n.$watch("vm.optEdgeColors.color",function(){return a>0?void(a-=1):(o(),void t.resize())})}(A,r);var D="",F=function(){angular.element(".legend-count").text("");var e=x.$('node[nodeType="patient"]:selected').toArray();0==e.length&&(e=x.$('node[nodeType="patient"]').toArray());var t=e.reduce(function(e,t){var n=t.data().color;return e.hasOwnProperty(n)||(e[n]=0),e[n]+=1,e},{});Object.keys(t).forEach(function(e){angular.element("#legend-"+e.substr(1)).text(" ("+this[e]+")")},t)},B=function(e){r.$apply(function(){"mouseout"==e.type||(D="patient")})},L=function(e){r.$apply(function(){"mouseout"==e.type?angular.element("#cohortmenu-legand").html(""):(D="gene",angular.element("#cohortmenu-legand").html(e.cyTarget.id()))})},O=0;n.onCohortChange.add(m),r.$watch("vm.optCommandMode",function(){switch(b.clear(),x.$("node").unselect(),x.$('edge[edgeType="cn"]').remove(),A.optCommandMode.name){case"Sequential":A.cmd=function(e){var t;switch(e){case"ShowSelectedEdges":var n=x.$('node[nodeType="patient"]:selected, node[nodeType="gene"]:selected');if(0==n.length)return;n.neighborhood("edge").remove(),t=P(e),T(t);break;case"HideAllEdges":x.$('edge[edgeType="cn"]').remove();break;case"HideSelectedEdges":x.$('node[nodeType="patient"]:selected, node[nodeType="gene"]:selected').neighborhood("edge").remove();break;case"HideUnselectedEdges":x.$('node[nodeType="patient"]:unselected').neighborhood("edge").remove();break;case"SelectConnected":x.startBatch(),x.$("node:selected").neighborhood("node").forEach(function(e){e.select()}),x.endBatch();break;case"SelectInverse":x.startBatch(),x.$("node").forEach(function(e){e[e._private.selected?"deselect":"select"]()}),x.endBatch();break;case"HideUnselectedNodes":x.startBatch(),x.$('node[nodeType="patient"]:unselected').forEach(function(e){e.style({display:"none"})}),x.endBatch();break;case"ShowAllNodes":x.startBatch(),x.$('node[nodeType="patient"]:hidden').forEach(function(e){e.style({display:"element"})}),x.endBatch();break;default:t=P(e),T(t)}},b.patients.select.add(F),b.patients.unselect.add(F),b.genes.over.add(L),b.genes.out.add(L),b.genes.select.add(h),b.genes.unselect.add(h),b.patients.over.add(B),b.patients.out.add(B),b.patients.select.add(g),b.patients.unselect.add(g);break;case"Set":var e=function(){x.$('edge[edgeType="cn"]').remove();var e=P();(e.patients.selected.length>0||e.genes.selected.length>0)&&T(e),g(e)},t=function(){x.$('edge[edgeType="cn"]').remove();var e=P();T(e),g(e)},n=function(){x.$('edge[edgeType="cn"]').remove();var e=P();(e.patients.selected.length>0||e.genes.selected.length>0)&&T(e),h(e)},a=function(){x.$('edge[edgeType="cn"]').remove();var e=P();T(e),h(e)};b.patients.select.add(F),b.patients.unselect.add(F),b.genes.over.add(L),b.genes.out.add(L),b.patients.over.add(B),b.patients.out.add(B),b.patients.select.add(t),b.patients.unselect.add(e),b.genes.select.add(a),b.genes.unselect.add(n);break;case"Ad Hoc":var o=function(e){x.nodes().unselect(),e.cyTarget.select(),T(P())},r=function(e){e.cyTarget.unselect(),x.startBatch(),x.$('edge[edgeType="cn"]').remove(),x.$('node[nodeType="gene"]').forEach(function(e){e.data("color","#0096d5"),e.data("sizeBdr",1),e.data("colorBdr","#FFFFFF")}),x.endBatch()};b.genes.over.add(L),b.genes.out.add(L),b.patients.over.add(B),b.patients.out.add(B),b.patients.over.add(o),b.patients.out.add(r),b.genes.over.add(o),b.genes.out.add(r)}});var $=function(e){if(null!==e){if(y.setColors(e),A.showPanelColor=!1,A.legendCaption=e.name,A.legendNodes=e.data,"None"==e.name)return A.legendCaption="",x.startBatch(),x.nodes('node[nodeType="patient"]').forEach(function(e){e.data("color","#0096d5")}),void x.endBatch();var t=e.data.reduce(function(e,t){for(var n=0;n<t.values.length;n++)e[t.values[n]]=t.color;return e},{});x.startBatch(),x.nodes('node[nodeType="patient"]').forEach(function(e){t.hasOwnProperty(e.id())?e.data("color",t[e.id()]):e.data("color","#DDD")}),x.endBatch(),o(F)}};n.onPatientColorChange.add($),r.$on("$destroy",function(){y.save(A,x),n.onPatientColorChange.remove($),f.terminate(),b.clear()})}e.$inject=["osApi","d3","osCohortService","$state","$timeout","$scope","$stateParams","cytoscape","signals","moment","$window","_","$q"];var t={restrict:"E",templateUrl:"app/components/markers/markers.html",scope:{},controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osMarkers",e)}(),function(){"use strict";function e(){function e(e,t,n,a){var o=this;o.networks=a.getAuthSources(),o.login=a.login;var r=function(){t.go("datasource")};a.onLogin.add(r),n.$on("$destroy",function(){a.onLogin.remove(r)})}e.$inject=["osApi","$state","$scope","osAuth"];var t={restrict:"E",templateUrl:"app/components/login/login.html",replace:!0,controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osLogin",e)}(),function(){"use strict";function e(){var e={restrict:"E",templateUrl:"app/components/loader/loader.html",replace:!0};return e}angular.module("oncoscape").directive("osLoader",e)}(),function(){"use strict";function e(){function e(e,t,n,a){angular.element(".marquee-bg").marquee({particlesNumber:49,color:"#1396de",particle:{speed:40}});var o=this;o.login=function(){e.go("login")},o.getStarted=function(){n.init().then(function(){a.loginGuest()})};var r=function(){e.go("datasource")};a.onLogin.add(r),t.$on("$destroy",function(){a.onLogin.remove(r)})}e.$inject=["$state","$scope","osApi","osAuth"];var t={restrict:"E",templateUrl:"app/components/landing/landing.html",replace:!0,controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osLanding",e)}(),function(){"use strict";function e(){function e(e,t,n,a,o,r,s,i,c,l,d){e.setBusy(!0);var u=this;u.setSize=function(){var t=angular.element("#history-grid")[0],n=e.getLayout();t.style["margin-left"]=n.left+"px",t.style["margin-right"]=n.right+"px",t.style.height=d.innerHeight-200+"px",u.gridApi.core.handleWindowResize()},u.collections=Object.keys(e.getDataSource().clinical).map(function(e){var t=this.data[e];return{name:e,collection:t}},{data:e.getDataSource().clinical}).filter(function(e){return"events"!=e.name&&"samplemap"!=e.name}),u.collection=u.collections[0],u.options={treeRowHeaderAlwaysVisible:!1,enableGridMenu:!0,enableSelectAll:!0,onRegisterApi:function(e){u.gridApi=e,e.selection.on.rowSelectionChanged(o,p),e.selection.on.rowSelectionChangedBatch(o,p)}},u.exportCsv=function(){var e=u.options.columnDefs.filter(function(e){return e.visible}).map(function(e){return e.field}),t='data:text/csv;charset=utf-8,"'+e.join('","')+'"\n';u.options.data.forEach(function(n){var a=e.map(function(e){return this[e]},n);t+='"'+a.join('","')+'"\n'}),d.open(encodeURI(t))};var p=function(e,n){angular.isUndefined(n)||t.setCohort(u.gridApi.grid.api.selection.getSelectedRows().map(function(e){return e.patient_ID}),"Spreadsheet",t.PATIENT)};u.datasource=e.getDataSource(),e.onResize.add(u.setSize);var m=function(){u.setSize(!0)};angular.element(d).bind("resize",m);var g=function(e){u.gridApi.grid.api.selection.clearSelectedRows();var t=e.patientIds,n=u.options.data.filter(function(e){return-1!=t.indexOf(e.patient_ID)});n.forEach(function(e){u.gridApi.grid.api.selection.selectRow(e)})};t.onCohortChange.add(g),o.$watch("vm.collection",function(){u.setSize(),e.setBusy(!0),e.query(u.collection.collection).then(function(n){angular.element(".ui-grid-icon-menu").text("Columns");var o=Object.keys(n.data[0]).map(function(e){return{field:e,name:e.replace(/_/gi," "),width:250,visible:!0}});u.options.columnDefs=o,u.options.data=n.data.map(function(e){return e.color="#F0DDC0",e.selected=!1,e}),a(function(){g(t.getCohort())},1),u.setSize(),e.setBusy(!1)})}),o.$on("$destroy",function(){e.onResize.remove(u.setSize),t.onCohortChange.remove(g),angular.element(d).unbind("resize",m)})}e.$inject=["osApi","osCohortService","$state","$timeout","$scope","moment","$stateParams","_","$","$q","$window"];var t={restrict:"E",templateUrl:"app/components/history/history.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osHistory",e)}(),function(){"use strict";function e(){function e(e,t,n,a,o,r,s,i,c){function l(t,n,a,o,r,s,i){if(t.select("g").remove(),i?m.colLabels:m.rowLabels){t.attr("width",a).attr("height",o).style("position","absolute").style("left",r).style("top",s);var c=t.append("g"),l=e.scaleLinear().domain([0,n.length]).range([0,i?a:o]),d="start",u=i?20:10,p=c.selectAll("label").data(n);p.enter().append("text").attr(i?"x":"y",function(e,t){return l(t+.8)}).attr(i?"y":"x",u).attr("text-anchor",d).attr("font-size","12px").text(function(e){return e})}}function d(t,n,a,o,r,s,i){if(t.select("g").remove(),i?m.colDendrogram:m.rowDendrogram){var c=e.hierarchy(n),l=e.cluster().separation(function(){return 1}).size(i?[a,o]:[o,a]),d=e.scaleLinear().domain([0,i?o:a]).range([0,i?o:a]),u=e.scaleLinear().domain([0,n.height]).range([i?o:a,0]),p=l(c),g=p.links().map(function(e){return{source:{x:e.source.x,y:e.source.data.height},target:{x:e.target.x,y:e.target.data.height},edgePar:e.target.data.edgePar}}),h=t.attr("width",a).attr("height",o).style("position","absolute").style("left",r).style("top",s).append("g");if(h.append("rect").attr("width",i?o:a).attr("height",i?a:o).style("fill","#FFF"),i){var v="rotate(90,"+o/2+","+o/2+") translate(0,"+(-a+o)+")";h.attr("transform",v)}var f=h.selectAll("polyline").data(g);return f.enter().append("polyline").attr("class","denolink").attr("points",function(e){return u(e.source.y)+","+e.source.x+" "+u(e.source.y)+","+e.target.x+" "+u(e.target.y)+","+e.target.x}).style("stroke",function(e){return e.edgePar.col}),{g:h,scaleY:u,scaleX:d,rotated:i,data:g}}}function u(t,n,a,o,r,s){function i(){if(e.event.sourceEvent&&e.event.selection){e.event.selection.map(function(e){return this.invert(e[0],e[1])},v).map(Math.round);var t=e.event.selection;t[0][1]=0,t[1][1]=o,e.select(this).transition().call(e.event.target.move,t)}}t.select("g").remove(),t.attr("width",a).attr("height",o).style("left",r).style("top",s).style("position","absolute");var c=t.append("g").attr("width",a).attr("height",o),l=t.append("g").attr("width",a).attr("height",o).attr("class","brush"),d=Math.max.apply(null,n.data),u=Math.min.apply(null,n.data),p=e.scaleLinear().domain([u,d]).range(m.colorScheme.value),g=n.dim[0],h=n.dim[1],v=e.scaleLinear().domain([0,g]).range([0,a]),f=e.scaleLinear().domain([0,h]).range([0,o]),b=m.gridlines?1:-1;l.call(e.brush().on("end",i));var y=v(1)-b,w=f(1)-b,x=c.selectAll("rect").data(n.data);return x.enter().append("rect").attr("class","box").attr("colIndex",function(e,t){return t%g}).attr("rowIndex",function(e,t){return Math.floor(t/g)}).attr("x",function(e,t){return v(t%g)}).attr("y",function(e,t){return f(t%h)}).attr("width",y).attr("height",w).attr("fill",function(e){return p(e)}),{g:c,scaleY:f,scaleX:v,data:n.data,cols:g,rows:h,boxW:y,boxH:w}}function p(){}var m=this;m.datasource=t.getDataSource(),m.rowLabels=m.colLabels=m.gridlines=!1,m.rowDendrogram=m.colDendrogram=!0,m.colorSchemes=[{name:"Blues",value:["#303f9f","#03a9f4"]},{name:"Black / Blue",value:["#000000","#1d85cb"]},{name:"Black / Red",value:["#000000","#D32F2F"]},{name:"Red / Yellow",value:["#D32F2F","#FFEB3B"]}],m.colorScheme=m.colorSchemes[0],m.scales=[{name:"None"},{name:"Row"},{name:"Column"}],m.scale=m.scales[2],m.dendrogramClusters=[{name:"One",value:1},{name:"Two",value:2},{name:"Three",value:3},{name:"Four",value:4},{name:"Five",value:5},{name:"Six",value:6},{name:"Seven",value:7},{name:"Eight",value:8},{name:"Nine",value:9},{name:"Ten",value:10}],m.dendrogramCluster=m.dendrogramClusters[6];var g,h,v=e.select("#heatmap-chart"),f=v.append("svg").classed("dendrogram colDend",!0),b=v.append("svg").classed("dendrogram rowDend",!0),y=v.append("svg").classed("colormap",!0),w=v.append("svg").classed("axis xaxis",!0),x=v.append("svg").classed("axis yaxis",!0);t.setBusy(!0),m.loadData=function(){t.query("brca_psi_bradleylab_miso",{$limit:100}).then(function(e){g={data:e.data.map(function(e){return Object.keys(e.patients).forEach(function(e){null==this[e]&&(this[e]=0)},e.patients),e.patients})},m.loadHeatmap()})},m.loadHeatmap=function(){t.setBusy(!0),b.select("g").remove(),f.select("g").remove(),y.select("g").remove(),g.scale=m.scale.name.toLowerCase(),g.kcol=g.krow=m.dendrogramCluster.value,t.getCpuApi().getHeatmap(g).then(function(e){h=angular.fromJson(e),m.draw(),t.setBusy(!1)})},m.draw=function(){var e=t.getLayout(),n=i.innerWidth-e.left-e.right-40,a=i.innerHeight-160,o=n-(m.rowLabels?160:0)-(m.rowDendrogram?80:0),r=a-(m.colLabels?160:0)-(m.colDendrogram?80:0);u(y,h.matrix,o,r,(m.rowDendrogram?80:0)+e.left+20,m.colDendrogram?80:0),d(b,h.rows,80,r,e.left+20,m.colDendrogram?80:0,!1),d(f,h.cols,o,80,(m.rowDendrogram?80:0)+e.left+20,0,!0),l(w,h.matrix.rows,160,r,o+(m.rowDendrogram?80:0)+e.left+20,m.colDendrogram?80:0,!1),l(x,h.matrix.cols,o,160,(m.rowDendrogram?80:0)+e.left+20,r+(m.colDendrogram?80:0),!0),p()},m.loadData(),t.onResize.add(m.draw),angular.element(i).bind("resize",c.debounce(m.draw,300))}e.$inject=["d3","osApi","osCohortService","$state","$timeout","$scope","$stateParams","$window","_"];var t={restrict:"E",templateUrl:"app/components/heatmap/heatmap.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osHeatmap",e)}(),function(){"use strict";function e(){function e(e,t,n,a,o,r,s){e.onDataSource.add(function(){r(function(){i.datasets=e.getDataSources()}),e.query("lookup_oncoscape_tools").then(function(t){var n=e.getDataSource().tools;i.tools=t.data.filter(function(e){return-1!=n.indexOf(e.route)}).sort(function(e,t){return e.name<t.name?-1:e.name>t.name?1:0})})});var i=this;i.show=!1,i.cohorts=[],i.addPatientCohort=t.addPatientCohort,i.setPatientCohort=t.setPatientCohort,t.onCohortsChange.add(function(e){i.cohorts=e}),i.importPatientIds="",i.importPatientCohort=function(){var e=i.importPatientIds.split(",").map(function(e){return e.trim()});t.setPatientCohort(e,"Import",t.PATIENT)},i.showImport=!1,i.showTools=!1,i.showDatasets=!1,i.showCohorts=!1,i.showHelp=!1,i.showLogout=!1;var c,l=$("#main"),d=s.$on("$stateChangeStart",function(e,t){switch(c=t.name,t.name){case"landing":i.showTools=!1,i.showDatasets=!1,i.showLogout=!1,i.showCohorts=!1,i.showHelp=!1,i.show=!1,l.addClass("container-main-full");break;case"tools":i.showCohorts=!1,i.showTools=!1,i.show=!0,l.removeClass("container-main-full");break;case"datasource":i.showHelp=!0,i.showDatasets=!1,i.showCohorts=!1,i.showLogout=!0,i.showTools=!1,i.show=!0,l.removeClass("container-main-full");break;default:i.showCohorts=!0,i.showDatasets=!0,i.showTools=!0,i.show=!0,l.removeClass("container-main-full")}});s.$on("$destroy",d),i.loadDataset=function(n){e.setBusy(!0),t.loadCohorts().then(function(){o.go(c,{datasource:n}),e.setBusy(!1)}),angular.element(".navbar-collapse").collapse("hide")},i.loadTool=function(t){o.go(t,{datasource:e.getDataSource().disease}),angular.element(".navbar-collapse").collapse("hide")},i.logoutClick=function(){n.logout(),o.transitionTo("landing")}}e.$inject=["osApi","osCohortService","osAuth","$stateParams","$state","$timeout","$rootScope"];var t={restrict:"E",templateUrl:"app/components/header/header.html",scope:{},controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osHeader",e)}(),function(){"use strict";function e(){function e(e,t,n){var a=this;a.datasets=e.getDataSources(),a.explore=function(a,o){e.setBusy(!0),e.setDataSource(o),t.loadCohorts().then(function(){n.go(a,{datasource:o.disease}),e.setBusy(!1)})}}e.$inject=["osApi","osCohortService","$state"];var t={restrict:"E",templateUrl:"app/components/datasource/datasource.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osDatasource",e)}(),function(){"use strict";function e(){function e(e,t,n,a,o,r,s,i,c,l,d,u){function p(){0==v.length?S.selectAll(".point").classed("point-unselected",!1):S.selectAll(".point").classed("point-unselected",function(){return-1==v.indexOf(this.__data__.id)})}function m(e){var t=n.select(this);t.append("svg:rect").attr("class","cell").attr("x",0).attr("y",0).attr("width",w.w).attr("height",w.h);var a=n.scaleLinear().domain(e.xDomain).range([0,w.w]),o=n.scaleLinear().domain(e.yDomain).range([0,w.h]);t.selectAll("circle").data(e.data).enter().append("svg:circle").attr("class","point").attr("cx",function(e){return a(e.x)}).attr("cy",function(e){return o(e.y)}).attr("r",1),C.create(t)}function g(){var t=e.getLayout(),n=u.innerHeight-180,a=u.innerWidth-t.left-t.right-40;w.w=Math.floor(a/y),w.h=Math.floor(n/Math.ceil(k.length/y)),A.css("margin-left",t.left+20).css("margin-right",t.right+20).css("width",a).css("height",n+70),S.attr("width",a).attr("height",n),S.selectAll("g.graph").data(k).enter().append("svg:g").attr("class","graph").attr("transform",function(e){return"translate("+e.col*w.w+","+e.row*w.h+")"}).each(m)}var h=t.getCohort();null==h&&t.setCohort([],t.ALL,t.SAMPLE);var v=null==h?[]:h.ids,f=function(e){v=e.sampleIds,p()};t.onCohortChange.add(f);var b=this,y=3,w={w:0,h:0},x={disease:"brain",source:"TCGA",beta:!1,name:"Brain",img:"DSbrain.png",category:[{source:"tcga",type:"color",collection:"brain_color_tcga_import"}],molecular:[{source:"ucsc",type:"cnv",collection:"brain_cnv_ucsc_gistic"},{source:"ucsc",type:"mut01",collection:"brain_mut01_ucsc_import"},{source:"cBio",type:"cnv",collection:"brain_cnv_cbio_gistic"},{source:"cBio",type:"mut",collection:"brain_mut_cbio_wxs"},{source:"cBio",type:"mut01",collection:"brain_mut01_cbio_import"},{source:"cBio",type:"methylation",collection:"brain_methylation_cbio_hm27"},{source:"cBio",type:"rna",collection:"brain_rna_cbio_rnaseq-bc"},{source:"cBio",type:"protein",collection:"brain_protein_cbio_rppa-zscore"}],clinical:{patient:"brain_patient_tcga_clinical","followUp-v1p0":"brain_followup-v1p0_tcga_clinical",drug:"brain_drug_tcga_clinical",newTumor:"brain_newtumor_tcga_clinical","otherMalignancy-v4p0":"brain_othermalignancy-v4p0_tcga_clinical",events:"brain_events_tcga_clinical"},calculated:[{source:"ucsc",type:"mds",collection:"brain_mds_ucsc_mds-allgenes-cnv-mut01"},{source:"ucsc",type:"mds",collection:"brain_mds_ucsc_mds-allgenes-cnv-mut01-10000"},{source:"ucsc",type:"mds",collection:"brain_mds_ucsc_mds-tcgagbmclassifiers-cnv-mut01"},{source:"ucsc",type:"mds",collection:"brain_mds_ucsc_mds-tcgagbmclassifiers-cnv-mut01-10000"},{source:"ucsc",type:"mds",collection:"brain_mds_ucsc_mds-markergenes545-cnv-mut01"},{source:"ucsc",type:"mds",collection:"brain_mds_ucsc_mds-markergenes545-cnv-mut01-10000"},{source:"ucsc",type:"mds",collection:"brain_mds_ucsc_mds-tcgapancanmutated-cnv-mut01"},{source:"ucsc",type:"mds",collection:"brain_mds_ucsc_mds-tcgapancanmutated-cnv-mut01-10000"},{source:"ucsc",type:"mds",collection:"brain_mds_ucsc_mds-oncovogel274-cnv-mut01"},{source:"ucsc",type:"mds",collection:"brain_mds_ucsc_mds-oncovogel274-cnv-mut01-10000"},{source:"ucsc",type:"pcaScores",collection:"brain_pcascores_ucsc_prcomp-allgenes-cnv"},{source:"ucsc",type:"pcaScores",collection:"brain_pcascores_ucsc_prcomp-allgenes-cnv-10000"},{source:"ucsc",type:"pcaScores",collection:"brain_pcascores_ucsc_prcomp-tcgagbmclassifiers-cnv"},{source:"ucsc",type:"pcaScores",collection:"brain_pcascores_ucsc_prcomp-tcgagbmclassifiers-cnv-10000"},{source:"ucsc",type:"pcaScores",collection:"brain_pcascores_ucsc_prcomp-markergenes545-cnv"},{source:"ucsc",type:"pcaScores",collection:"brain_pcascores_ucsc_prcomp-markergenes545-cnv-10000"},{source:"ucsc",type:"pcaScores",collection:"brain_pcascores_ucsc_prcomp-tcgapancanmutated-cnv"},{source:"ucsc",type:"pcaScores",collection:"brain_pcascores_ucsc_prcomp-tcgapancanmutated-cnv-10000"},{source:"ucsc",type:"pcaScores",collection:"brain_pcascores_ucsc_prcomp-oncovogel274-cnv"},{source:"ucsc",type:"pcaScores",collection:"brain_pcascores_ucsc_prcomp-oncovogel274-cnv-10000"},{source:"ucsc",type:"pcaScores",collection:"brain_pcascores_ucsc_prcomp-tcgagbmclassifiers-mut01"},{source:"ucsc",type:"pcaScores",collection:"brain_pcascores_ucsc_prcomp-tcgagbmclassifiers-mut01-10000"},{source:"ucsc",type:"pcaScores",collection:"brain_pcascores_ucsc_prcomp-tcgapancanmutated-mut01"},{source:"ucsc",type:"pcaScores",collection:"brain_pcascores_ucsc_prcomp-tcgapancanmutated-mut01-10000"},{source:"ucsc",type:"pcaScores",collection:"brain_pcascores_ucsc_prcomp-oncovogel274-mut01"},{source:"ucsc",type:"pcaScores",collection:"brain_pcascores_ucsc_prcomp-oncovogel274-mut01-10000"},{source:"cBio",type:"mds",collection:"brain_mds_cbio_mds-allgenes-cnv-mut01-cbio"},{source:"cBio",type:"mds",collection:"brain_mds_cbio_mds-allgenes-cnv-mut01-10000"},{source:"cBio",type:"mds",collection:"brain_mds_cbio_mds-tcgagbmclassifiers-cnv-mut01-cbio"},{source:"cBio",type:"mds",collection:"brain_mds_cbio_mds-tcgagbmclassifiers-cnv-mut01-10000"},{source:"cBio",type:"mds",collection:"brain_mds_cbio_mds-markergenes545-cnv-mut01-cbio"},{source:"cBio",type:"mds",collection:"brain_mds_cbio_mds-markergenes545-cnv-mut01-10000"},{source:"cBio",type:"mds",collection:"brain_mds_cbio_mds-tcgapancanmutated-cnv-mut01-cbio"},{source:"cBio",type:"mds",collection:"brain_mds_cbio_mds-tcgapancanmutated-cnv-mut01-10000"},{source:"cBio",type:"mds",collection:"brain_mds_cbio_mds-oncovogel274-cnv-mut01-cbio"},{source:"cBio",type:"mds",collection:"brain_mds_cbio_mds-oncovogel274-cnv-mut01-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-allgenes-cnv"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-allgenes-cnv-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-tcgagbmclassifiers-cnv"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-tcgagbmclassifiers-cnv-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-markergenes545-cnv"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-markergenes545-cnv-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-tcgapancanmutated-cnv"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-tcgapancanmutated-cnv-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-oncovogel274-cnv"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-oncovogel274-cnv-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-allgenes-mut01"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-allgenes-mut01-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-tcgagbmclassifiers-mut01"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-tcgagbmclassifiers-mut01-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-markergenes545-mut01"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-markergenes545-mut01-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-tcgapancanmutated-mut01"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-tcgapancanmutated-mut01-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-oncovogel274-mut01"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-oncovogel274-mut01-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-allgenes-methylation"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-allgenes-methylation-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-tcgagbmclassifiers-methylation"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-tcgagbmclassifiers-methylation-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-markergenes545-methylation"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-markergenes545-methylation"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-markergenes545-methylation-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-tcgapancanmutated-methylation"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-tcgapancanmutated-methylation-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-oncovogel274-methylation"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-oncovogel274-methylation-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-allgenes-rna"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-allgenes-rna-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-tcgagbmclassifiers-rna"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-tcgagbmclassifiers-rna-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-markergenes545-rna"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-markergenes545-rna-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-tcgapancanmutated-rna"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-tcgapancanmutated-rna-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-oncovogel274-rna"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-oncovogel274-rna-10000"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-allgenes-protein"},{source:"cBio",type:"pcaScores",collection:"brain_pcascores_cbio_prcomp-allgenes-protein-10000"}],edges:[{name:"TCGA GBM classifiers",source:"ucsc",edges:"brain_edges_ucsc_tcgagbmclassifiers-mut01-cnv",patientWeights:"brain_ptdegree_ucsc_tcgagbmclassifiers-mut01-cnv",genesWeights:"brain_genedegree_ucsc_tcgagbmclassifiers-mut01-cnv"},{name:"Marker genes 545",source:"ucsc",edges:"brain_edges_ucsc_markergenes545-mut01-cnv",patientWeights:"brain_ptdegree_ucsc_markergenes545-mut01-cnv",genesWeights:"brain_genedegree_ucsc_markergenes545-mut01-cnv"},{name:"TCGA pancan mutated",source:"ucsc",edges:"brain_edges_ucsc_tcgapancanmutated-mut01-cnv",patientWeights:"brain_ptdegree_ucsc_tcgapancanmutated-mut01-cnv",genesWeights:"brain_genedegree_ucsc_tcgapancanmutated-mut01-cnv"},{name:"oncoVogel274",source:"ucsc",edges:"brain_edges_ucsc_oncovogel274-mut01-cnv",patientWeights:"brain_ptdegree_ucsc_oncovogel274-mut01-cnv",genesWeights:"brain_genedegree_ucsc_oncovogel274-mut01-cnv"},{name:"TCGA GBM classifiers",source:"cbio",edges:"brain_edges_cbio_tcgagbmclassifiers-mut01-cnv",patientWeights:"brain_ptdegree_cbio_tcgagbmclassifiers-mut01-cnv",genesWeights:"brain_genedegree_cbio_tcgagbmclassifiers-mut01-cnv"},{name:"Marker genes 545",source:"cbio",edges:"brain_edges_cbio_markergenes545-mut01-cnv",patientWeights:"brain_ptdegree_cbio_markergenes545-mut01-cnv",genesWeights:"brain_genedegree_cbio_markergenes545-mut01-cnv"},{name:"TCGA pancan mutated",source:"cbio",edges:"brain_edges_cbio_tcgapancanmutated-mut01-cnv",patientWeights:"brain_ptdegree_cbio_tcgapancanmutated-mut01-cnv",genesWeights:"brain_genedegree_cbio_tcgapancanmutated-mut01-cnv"},{name:"oncoVogel274",source:"cbio",edges:"brain_edges_cbio_oncovogel274-mut01-cnv",patientWeights:"brain_ptdegree_cbio_oncovogel274-mut01-cnv",genesWeights:"brain_genedegree_cbio_oncovogel274-mut01-cnv"}]},A=angular.element("#compareclusterChart"),S=n.select("#compareclusterChart").append("svg:svg");b.allClusters=x.calculated.map(function(e){return e.selected=!0,e});var k=b.allClusters.filter(function(e){return-1!=e.collection.indexOf("ucsc")}).filter(function(e){return"mds"==e.type});k.pop();var C=function(e,t,n){var a=[],o=function(){null!==e.event.selection&&(a.filter(function(t){return t.brush!==e.event.target}).forEach(function(e){e.rect.call(e.brush.move,null)}),a.filter(function(t){return t.brush===e.event.target}).forEach(function(e){e.brush.on("end",r)}))},r=function(){if(null===e.event.selection)return void n.setCohort([],"Clusters",n.SAMPLE);var o=e.event.selection,r=o[0][0],s=o[1][0],i=o[0][1],c=o[1][1],l=a.filter(function(t){return t.brush===e.event.target})[0];l.brush.on("end",null);var d=l.rect.data()[0],u=e.scaleLinear().domain(d.xDomain).range([0,t.w]),p=e.scaleLinear().domain(d.yDomain).range([0,t.h]),m=d.data.filter(function(e){var t=u(e.x),n=p(e.y);return t>r&&s>t&&n>i&&c>n}).map(function(e){return e.id});n.setCohort(m,"Clusters",n.SAMPLE)},s=function(t){var n=e.brush().on("start",o);t.call(n),a.push({brush:n,rect:t})},i=function(){},c=function(){};return{create:s,clear:i,destory:c}}(n,w,t);d.all(k.map(function(t){return e.query(t.collection)})).then(function(e){k=k.map(function(e,t){var a=this.data[t].data[0].data,o={name:e,data:Object.keys(a).reduce(function(e,t){var n=e.data[t];return e.value.push({id:t,x:n.x,y:n.y}),e},{data:a,value:[]}).value,xDomain:null,yDomain:null,col:t%this.rows,
row:parseInt(t/this.rows)},r=function(e){return e.x},s=function(e){return e.x};return o.xDomain=[n.min(o.data,r),n.max(o.data,r)],o.yDomain=[n.min(o.data,s),n.max(o.data,s)],o},{data:e,rows:y}),g()});var _=function(){var t=e.getLayout(),a=u.innerHeight-180,o=u.innerWidth-t.left-t.right-40;w.w=Math.floor(o/y),w.h=Math.floor(a/Math.ceil(k.length/y)),A.css("margin-left",t.left+20).css("margin-right",t.right+20).css("width",o).css("height",a+70),S.attr("width",o).attr("height",a),S.selectAll("g.graph").attr("transform",function(e){return"translate("+e.col*w.w+","+e.row*w.h+")"}).each(function(e){var t=n.scaleLinear().domain(e.xDomain).range([0,w.w]),a=n.scaleLinear().domain(e.yDomain).range([0,w.h]),o=n.select(this);o.select(".cell").attr("width",w.w).attr("height",w.h),o.selectAll(".point").attr("cx",function(e){return t(e.x)}).attr("cy",function(e){return a(e.y)}).attr("r",1)})};e.onResize.add(_),angular.element(u).bind("resize",c.debounce(_,300))}e.$inject=["osApi","osCohortService","d3","$state","$timeout","$scope","moment","$stateParams","_","$","$q","$window"];var t={restrict:"E",templateUrl:"app/components/compareclusters/compareclusters.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osCompareCluster",e)}(),function(){"use strict";function e(){function e(e,t,n,a){var o=this;o.showPanelColorRna=!1,o.colorScales=[{name:"Quantile"},{name:"Quantize"}],o.colorScale=o.colorScales[0],o.colorBins=[2,3,4,5,6,7,8].map(function(e){return{name:e+" Bins",value:e}}),o.colorBin=o.colorBins[2],o.colorOptions=e.getDataSource().colors,angular.isDefined(o.colorOptions)&&0!=o.colorOptions.length&&(o.colorOption=o.colorOptions[0]);var r=e.getDataSource().category.filter(function(e){return"color"==e.type})[0].collection;e.query(r,{type:"color",dataset:e.getDataSource().disease,$fields:["name","subtype"]}).then(function(e){var t=e.data.reduce(function(e,t){return e.hasOwnProperty(t.subtype)||(e[t.subtype]=[]),e[t.subtype].push(t),e},{});o.optPatientColors=Object.keys(t).map(function(e){return{name:e,values:this[e].sort(function(e,t){return e.name>t.name?1:e.name<t.name?-1:0})}},t)}),o.setColor=function(n){return e.setBusy(!0),o.close(),"None"==n.name?void t.setPatientColor({dataset:e.getDataSource().disease,type:"color",name:"None",data:[],show:!0}):void e.query(r,{type:"color",dataset:e.getDataSource().disease,name:n.name}).then(function(n){var a=n.data[0];a.data=a.data.map(function(e){var t=e.name.toLowerCase().trim();return(""==t||"null"==t||"undefined"==t)&&(e.name="Null",e.color="#DDDDDD"),e.id="legend-"+e.color.substr(1),e}).sort(function(e,t){var n=isNaN(e.name)?e.name:parseInt(e.name),a=isNaN(t.name)?t.name:parseInt(t.name);return a>n?-1:n>a?1:"Null"==e.name?1:"Null"==t.name?-1:0}),t.setPatientColor(n.data[0]),e.setBusy(!1),o.close()})},o.doClose=function(){alert("HI")},o.setGeneColor=function(){var r=("+"+o.geneColor.replace(/\s/g,"").toUpperCase()).match(/[-+]\w*/gi).map(function(e){return{op:e.substr(0,1),gene:e.substr(1).toLowerCase(),message:"",status:""}});e.setBusy(!0),e.query("lookup-genes",{symbols:{$in:r.map(function(e){return e.gene})}}).then(function(s){o.close(),r.map(function(e){var t=this.filter(function(e){return-1!=e.symbols.indexOf(this)},e.gene);0==t.length?(e.message=e.gene.toUpperCase(),e.status="Removed"):t.length>1?(e.message=e.gene.toUpperCase()+" -> "+t[0].hugo.toUpperCase(),e.status="Converted"):1==t.length&&e.gene!=t[0].hugo&&(e.message=e.gene.toUpperCase()+" -> "+t[0].hugo.toUpperCase(),e.status="Converted")},s.data);var i=a.sortBy(r.filter(function(e){return""!=e.status}),"length"),c=a.groupBy(i,function(e){return e.status}),l="";void 0!=c.Removed&&c.Removed.length>0&&(l+="Removed: "+c.Removed.map(function(e){return e.message+" - "})),l.length>0&&(l=l.substr(0,l.length-2)+"\r\n"),void 0!=c.Converted&&c.Converted.length>0&&(l+="Converted: "+c.Converted.map(function(e){return e.message+"\r\n"})),l.trim().length>0&&alert(l);var d=r.filter(function(e){return"Removed"!=e.status}).map(function(e){return e.gene.toUpperCase()});e.query(o.colorOption.collection,{gene:{$in:d}}).then(function(s){if(s.data.length>0){var i;if(1==s.data.length)i=s.data[0];else{i={},i.patients=s.data.reduce(function(e,t){for(var n=e.lookup[t.gene],a=0;a<e.pids.length;a++){var o=e.pids[a],r=e.output.hasOwnProperty(o)?e.output[o]:0;"+"===n&&(e.output[o]=r+t.patients[o]),"-"===n&&(e.output[o]=r-t.patients[o])}return e},{pids:Object.keys(s.data[0].patients),lookup:r.reduce(function(e,t){return e[t.gene]=t.op,e},{}),output:{}}).output;var c=Object.keys(i.patients).reduce(function(e,t){return e.min=Math.min(e.min,e.values[t]),e.max=Math.max(e.min,e.values[t]),e},{values:i.patients,min:1/0,max:-(1/0)});i.min=c.min,i.max=c.max}var l,d=["#9d1cb2","#00a7f7","#3d4eb8","#ff9900","#f7412d","#795548","#E91E63","#673AB7"],u=d.splice(0,o.colorBin.value),p="Quantile"==o.colorScale.name?n.scaleQuantile():n.scaleQuantize();"Quantile"==o.colorScale.name?(p.domain(Object.keys(i).map(function(e){return i[e]},{data:i})).range(u),l=p.quantiles().map(function(e){return parseFloat(e).toFixed(3)}),l.unshift(""),l=l.map(function(e,t,n){return 0==t?"-  "+n[1]:t==n.length-1?n[t]+"  +":n[t]+"  "+n[t+1]}),u=a.zip(u,l).map(function(e){return{color:e[0],name:e[1]}})):(p.domain([i.min,i.max]).range(u),l=p.ticks(u.length).map(function(e){return"~"+parseFloat(e).toFixed(2)}),u=a.zip(u,l).map(function(e){return{color:e[0],name:e[1]}})),i=Object.keys(i.patients).map(function(e){return{id:e,color:this.scale(this.patients[e]),value:this.patients[e]}},{patients:i.patients,scale:p}).reduce(function(e,t){return e.hasOwnProperty(t.color)||(e[t.color]=[]),e[t.color].push(t.id),e},{}),i=Object.keys(i).map(function(e){return{color:e,name:this.names.filter(function(e){return e.color==this.color},{color:e})[0].name,values:this.data[e]}},{data:i,names:u}),i=i.sort(function(e,t){return-1!=e.name.indexOf("-")?-1:-1!=t.name.indexOf("-")?1:-1!=e.name.indexOf("+")?1:-1!=t.name.indexOf("+")?-1:e.name<t.name?-1:e.name>t.name?1:0}),i.push({color:"#DDD",name:"Null",values:[]}),d={dataset:e.getDataSource().disease,type:"color",name:r.reduce(function(e,t){return e+=t.op+t.gene+" "},""),data:i},t.setPatientColor(d)}e.setBusy(!1)})})}}e.$inject=["osApi","osCohortService","d3","_"];var t={restrict:"E",templateUrl:"app/components/colorpanel/colorpanel.html",controller:e,controllerAs:"vm",bindToController:!0,scope:{close:"&"}};return t}angular.module("oncoscape").directive("osColorPanel",e)}(),function(){"use strict";function e(){function e(e,t,n,a,o,r,s){var i=this;i.edit=!1,i.editItem=null,i.cohorts=[],i.cohort=null,i.cohortFeatures=[],i.cohortFeature=null,angular.element("#cohortMenu").css({display:"none"}),t.onCohortsChange.add(function(e){i.cohorts=e}),t.onCohortChange.add(function(e){angular.isUndefined(e)||(o(function(){var t=null!==i.cohortFeature?i.cohortFeatures.indexOf(i.cohortFeature):0;i.cohort=e,i.cohortFeatures=e.histogram.features,i.cohortFeature=e.histogram.features[t]}),x(i.cohorts.concat([e])))}),i.addCohort=function(){t.saveCohort(i.cohort)},i.editCohort=function(e){i.edit=!0,i.editCohort=e},i.setCohort=function(e){angular.isString(e)?t.setCohort([],t.ALL,t.SAMPLE):t.setCohort(e)},i.show=!1,r.$on("$destroy",function(){i.show=!1}),r.$on("$stateChangeStart",function(e,t){switch(t.name){case"landing":case"tools":case"datasource":i.show=!1,angular.element("#cohortMenu").css({display:"none"});break;default:i.show=!0,angular.element("#cohortMenu").css({display:"block"})}});var c=angular.element(".cohort-menu"),l=!0,d=function(){c.removeClass("tray-collapsed-left")},u=function(){c.addClass("tray-collapsed-left")};i.toggle=function(){l=!l,angular.element("#cohortmenu-lock").addClass(l?"fa-lock":"fa-unlock-alt").removeClass(l?"fa-unlock-alt":"fa-lock").attr("locked",l?"true":"false"),l?c.unbind("mouseover",d).unbind("mouseout",u).removeClass("tray-collapsed-left"):c.addClass("tray-collapsed-left").bind("mouseover",d).bind("mouseout",u),e.onResize.dispatch()};var p=s.select("#cohortmenu-chart").append("svg").attr("width",238).attr("height",150).append("g"),m=angular.element("#cohortmenu-single-value");a.$watch("vm.cohortFeature",function(){if(null!==i.cohortFeature){var e=i.cohortFeature.data;if("factor"==e.type){if(1==e.hist.length)return m.text(e.hist[0].label).css("display","block").removeClass("cohortmenu-single-value-numeric"),void p.classed("cohort-chart-hide",!0)}else if(e.min==e.max)return m.text(e.min).css("display","block").addClass("cohortmenu-single-value-numeric"),void p.classed("cohort-chart-hide",!0);m.text("").css("display","none"),p.classed("cohort-chart-hide",!1);var t=Math.floor(238/e.bins);e.histRange[0]>0&&(e.histRange[0]-=2);var n=s.scaleLinear().domain([0,e.histRange[1]]).range([0,135]),a=p.selectAll(".cohort-menu-chart-bar").data(e.hist);a.enter().append("rect").attr("class","cohort-menu-chart-bar").attr("x",function(e,n){return(t+1)*n}).attr("y",function(e){return 150-n(e.value)}).attr("height",function(e){return n(e.value)}).attr("width",t),a.transition().duration(300).attr("x",function(e,n){return(t+1)*n}).attr("y",function(e){return 150-n(e.value)}).attr("height",function(e){return n(e.value)}).attr("width",t),a.exit().transition().duration(300).attr("y",150).attr("height",0).style("fill-opacity",1e-6).remove();var o=p.selectAll("text").data(e.hist);o.enter().append("text").attr("x",function(e,n){return(t+1)*n+.5*t}).attr("y",function(e){return 145-n(e.value)}).attr("fill","#000").attr("height",function(e){return n(e.value)}).attr("width",t).attr("font-size","8px").attr("text-anchor","middle").text(function(e){return e.label}),o.transition().duration(300).attr("x",function(e,n){return(t+1)*n+.5*t}).attr("y",function(e){var t=145-n(e.value);return 0>t&&(t=20),t}).text(function(e){return e.label}),o.exit().transition().duration(300).attr("y",150).attr("height",0).style("fill-opacity",1e-6).remove()}});var g=function(e){return 100==e?e:e+"%"},h=function(e){return Math.abs(e)<30?e+" Days":Math.abs(e)<360?Math.round(e/30.4*10)/10+" Mos":Math.round(e/365*10)/10+" Yrs"},v=s.select("#cohortmenu-survival").append("svg"),f=v.append("g").attr("class","axis"),b=v.append("g").attr("class","axis"),y={width:238,height:170,xScale:null,yScale:null,xAxis:s.axisBottom().ticks(4).tickFormat(h),yAxis:s.axisLeft().ticks(3).tickFormat(g)};v.attr("width","100%").attr("height",y.height);var w=function(e,t){var n=e.data,a=0;if(n.lines.forEach(function(e){v.append("line").attr("class","line").attr("stroke-width",.5).attr("stroke",t).attr("x1",y.xScale(e.time)).attr("x2",y.xScale(e.time)).attr("y1",y.yScale(e.survivalFrom)).attr("y2",y.yScale(e.survivalTo)),v.append("line").attr("class","line").attr("stroke-width",.5).attr("stroke",t).attr("x1",y.xScale(a)).attr("x2",y.xScale(e.time)).attr("y1",y.yScale(e.survivalFrom)).attr("y2",y.yScale(e.survivalFrom)),a=e.time}),n.ticks.forEach(function(e){v.append("line").attr("class","line").attr("stroke-width",.5).attr("stroke",t).attr("x1",y.xScale(e.time)).attr("x2",y.xScale(e.time)).attr("y1",y.yScale(e.survivalFrom)).attr("y2",y.yScale(e.survivalFrom)-2)},this),0!==n.ticks.length&&0!==n.lines.length){var o=n.ticks[n.ticks.length-1],r=n.lines[n.lines.length-1];o.time>r.time&&v.append("line").attr("class","line").attr("stroke-width",.5).attr("stroke",t).attr("x1",y.xScale(r.time)).attr("x2",y.xScale(o.time)).attr("y1",y.yScale(o.survivalFrom)).attr("y2",y.yScale(o.survivalFrom))}},x=function(e){var t=e.reduce(function(e,t){return e.max=Math.max(e.max,t.survival.max),e.min=Math.min(e.min,t.survival.min),e},{max:-(1/0),min:1/0});y.xScale=s.scaleLinear().domain([t.min,t.max]).range([30,y.width-1]),y.yScale=s.scaleLinear().domain([0,100]).range([y.height-20,10]),y.xAxis.scale(y.xScale),y.yAxis.scale(y.yScale),b.attr("transform","translate(30, 0)").call(y.yAxis),f.attr("transform","translate(0, "+y.yScale(0)+")").call(y.xAxis),v.selectAll(".line").remove();for(var n=0;n<e.length;n++)w(e[n].survival,e[n].color)}}e.$inject=["osApi","osCohortService","$state","$scope","$timeout","$rootScope","d3"];var t={restrict:"E",templateUrl:"app/components/cohortmenu/cohortmenu.html",controller:e,controllerAs:"vm",scope:{},bindToController:!0};return t}angular.module("oncoscape").directive("osCohortMenu",e)}(),function(){"use strict";function e(){function e(e,t,n,a,o){function r(){clearTimeout(_),"grouped"===this.value?s():i()}function s(){w.domain([0,g]),C.transition().duration(500).delay(function(e,t){return 10*t}).attr("x",function(e,t,n){return y(e.x)+y.rangeBand()/d*n}).attr("width",y.rangeBand()/d).transition().attr("y",function(e){return w(e.y)}).attr("height",function(e){return b-w(e.y)})}function i(){w.domain([0,h]),C.transition().duration(500).delay(function(e,t){return 10*t}).attr("y",function(e){return w(e.y0+e.y)}).attr("height",function(e){return w(e.y0)-w(e.y0+e.y)}).transition().attr("x",function(e){return y(e.x)}).attr("width",y.rangeBand())}function c(e,t){function n(t){for(var n=1/(.1+Math.random()),a=2*Math.random()-.5,o=10/(.1+Math.random()),r=0;e>r;r++){var s=(r/e-a)*o;t[r]+=n*Math.exp(-s*s)}}var a,o=[];for(a=0;e>a;++a)o[a]=t+t*Math.random();for(a=0;5>a;++a)n(o);return o.map(function(e,t){return{x:t,y:Math.max(0,e)}})}var l=this;l.datasource=t.getDataSource();var d=5,u=58,p=e.layout.stack(),m=p(e.range(d).map(function(){return c(u,.1)})),g=e.max(m,function(t){return e.max(t,function(e){return e.y})}),h=e.max(m,function(t){return e.max(t,function(e){return e.y0+e.y})}),v={top:40,right:10,bottom:20,left:10},f=960-v.left-v.right,b=500-v.top-v.bottom,y=e.scaleOrdinal().domain(e.range(u)).rangeRoundBands([0,f],.08),w=e.scaleLinear().domain([0,h]).range([b,0]),x=e.scaleLinear().domain([0,d-1]).range(["#aad","#556"]),A=e.svg.axis().scale(y).tickSize(0).tickPadding(6).orient("bottom"),S=e.select("body").append("svg").attr("width",f+v.left+v.right).attr("height",b+v.top+v.bottom).append("g").attr("transform","translate("+v.left+","+v.top+")"),k=S.selectAll(".layer").data(m).enter().append("g").attr("class","layer").style("fill",function(e,t){return x(t)}),C=k.selectAll("rect").data(function(e){return e}).enter().append("rect").attr("x",function(e){return y(e.x)}).attr("y",b).attr("width",y.rangeBand()).attr("height",0);C.transition().delay(function(e,t){return 10*t}).attr("y",function(e){return w(e.y0+e.y)}).attr("height",function(e){return w(e.y0)-w(e.y0+e.y)}),S.append("g").attr("class","x axis").attr("transform","translate(0,"+b+")").call(A),e.selectAll("input").on("change",r);var _=o(function(){e.select('input[value="grouped"]').property("checked",!0).each(r)},2e3)}e.$inject=["d3","osApi","osCohortService","$state","$timeout"];var t={restrict:"E",templateUrl:"app/components/barchart/barchart.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("oncoscape").directive("osBarchart",e)}(),function(){"use strict";function e(e,t,n,a,o,r){n.onerror=function(e,t,n,o,r){r||(r=new Error(e),r.fileName=t,r.lineNumber=n,r.columnNumber=o||0),a(r)};var s=e.$on("$stateChangeStart",function(e,n,a){return o.setBusy(!1),n.authenticate&&!r.isAuthenticated()?(t.transitionTo("landing"),void e.preventDefault()):n.datasource&&(angular.isUndefined(a.datasource)||""===a.datasource)?(t.transitionTo("datasource"),void e.preventDefault()):void o.setDataSource(a.datasource)});e.$on("$destroy",s)}e.$inject=["$rootScope","$state","$window","$exceptionHandler","osApi","osAuth"],angular.module("oncoscape").run(e)}(),function(){"use strict";function e(e,t){e.state("landing",{url:"/",template:"<os-landing>",authenticate:!1,datasource:!1}).state("datasource",{url:"/datasource",template:"<os-datasource>",authenticate:!0,datasource:!1}).state("tools",{url:"/tools/{datasource}",template:"<os-tools>",authenticate:!0,datasource:!0}).state("scatter",{url:"/scatter",template:"<os-pca>",authenticate:!0,datasource:!1}).state("history",{url:"/history/{datasource}",template:"<os-history>",authenticate:!0,datasource:!0}).state("plsr",{url:"/plsr/{datasource}",template:"<os-plsr>",authenticate:!0,datasource:!0}).state("pca",{url:"/pca/{datasource}",template:"<os-pca>",authenticate:!0,datasource:!0}).state("comparecluster",{url:"/comparecluster/{datasource}",template:"<os-compare-cluster>",authenticate:!0,datasource:!0}).state("markers",{url:"/markers/{datasource}",template:"<os-markers>",authenticate:!0,datasource:!0}).state("pathways",{url:"/pathways/{datasource}",template:"<os-pathways>",authenticate:!0,datasource:!0}).state("timelines",{url:"/timelines/{datasource}",template:"<os-timelines>",authenticate:!0,datasource:!0}).state("survival",{url:"/survival/{datasource}",template:"<os-survival>",authenticate:!0,datasource:!0}).state("sunburst",{url:"/sunburst/{datasource}",template:"<os-sunburst>",authenticate:!0,datasource:!0}).state("heatmap",{url:"/heatmap/{datasource}",template:"<os-heatmap>",authenticate:!0,datasource:!1}).state("barcharts",{url:"/barchart/{datasource}",template:"<os-barchart>",authenticate:!0,datasource:!0}),t.otherwise("/")}e.$inject=["$stateProvider","$urlRouterProvider"],angular.module("oncoscape").config(e)}(),function(){"use strict";angular.module("oncoscape").constant("THREE",THREE).constant("moment",moment).constant("d3",d3).constant("cytoscape",cytoscape).constant("signals",signals).constant("$",$).constant("auth",hello).constant("jStat",jStat).constant("localStorage",localStorage).constant("_",_)}(),THREE.OrbitControls=function(e,t){function n(){return 2*Math.PI/60/60*B.autoRotateSpeed}function a(){return Math.pow(.95,B.zoomSpeed)}function o(e){j.theta-=e}function r(e){j.phi-=e}function s(e){B.object instanceof THREE.PerspectiveCamera?U/=e:B.object instanceof THREE.OrthographicCamera?(B.object.zoom=Math.max(B.minZoom,Math.min(B.maxZoom,B.object.zoom*e)),B.object.updateProjectionMatrix(),G=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),B.enableZoom=!1)}function i(e){B.object instanceof THREE.PerspectiveCamera?U*=e:B.object instanceof THREE.OrthographicCamera?(B.object.zoom=Math.max(B.minZoom,Math.min(B.maxZoom,B.object.zoom/e)),B.object.updateProjectionMatrix(),G=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),B.enableZoom=!1)}function c(e){q.set(e.clientX,e.clientY)}function l(e){K.set(e.clientX,e.clientY)}function d(e){Q.set(e.clientX,e.clientY)}function u(e){W.set(e.clientX,e.clientY),V.subVectors(W,q);var t=B.domElement===document?B.domElement.body:B.domElement;o(2*Math.PI*V.x/t.clientWidth*B.rotateSpeed),r(2*Math.PI*V.y/t.clientHeight*B.rotateSpeed),q.copy(W),B.update()}function p(e){X.set(e.clientX,e.clientY),J.subVectors(X,K),J.y>0?s(a()):J.y<0&&i(a()),K.copy(X),B.update()}function m(e){Z.set(e.clientX,e.clientY),Y.subVectors(Z,Q),ne(Y.x,Y.y),Q.copy(Z),B.update()}function g(e){}function h(e){e.deltaY<0?i(a()):e.deltaY>0&&s(a()),B.update()}function v(e){switch(e.keyCode){case B.keys.UP:ne(0,B.keyPanSpeed),B.update();break;case B.keys.BOTTOM:ne(0,-B.keyPanSpeed),B.update();break;case B.keys.LEFT:ne(B.keyPanSpeed,0),B.update();break;case B.keys.RIGHT:ne(-B.keyPanSpeed,0),B.update()}}function f(e){q.set(e.touches[0].pageX,e.touches[0].pageY)}function b(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,a=Math.sqrt(t*t+n*n);K.set(0,a)}function y(e){Q.set(e.touches[0].pageX,e.touches[0].pageY)}function w(e){W.set(e.touches[0].pageX,e.touches[0].pageY),V.subVectors(W,q);var t=B.domElement===document?B.domElement.body:B.domElement;o(2*Math.PI*V.x/t.clientWidth*B.rotateSpeed),r(2*Math.PI*V.y/t.clientHeight*B.rotateSpeed),q.copy(W),B.update()}function x(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,o=Math.sqrt(t*t+n*n);X.set(0,o),J.subVectors(X,K),J.y>0?i(a()):J.y<0&&s(a()),K.copy(X),B.update()}function A(e){Z.set(e.touches[0].pageX,e.touches[0].pageY),Y.subVectors(Z,Q),ne(Y.x,Y.y),Q.copy(Z),B.update()}function S(e){}function k(e){if(B.enabled!==!1){if(e.preventDefault(),e.button===B.mouseButtons.ORBIT){if(B.enableRotate===!1)return;c(e),z=R.ROTATE}else if(e.button===B.mouseButtons.ZOOM){if(B.enableZoom===!1)return;l(e),z=R.DOLLY}else if(e.button===B.mouseButtons.PAN){if(B.enablePan===!1)return;d(e),z=R.PAN}z!==R.NONE&&(document.addEventListener("mousemove",C,!1),document.addEventListener("mouseup",_,!1),B.dispatchEvent(O))}}function C(e){if(B.enabled!==!1)if(e.preventDefault(),z===R.ROTATE){if(B.enableRotate===!1)return;u(e)}else if(z===R.DOLLY){if(B.enableZoom===!1)return;p(e)}else if(z===R.PAN){if(B.enablePan===!1)return;m(e)}}function _(e){B.enabled!==!1&&(g(e),document.removeEventListener("mousemove",C,!1),document.removeEventListener("mouseup",_,!1),B.dispatchEvent($),z=R.NONE)}function E(e){B.enabled===!1||B.enableZoom===!1||z!==R.NONE&&z!==R.ROTATE||(e.preventDefault(),e.stopPropagation(),h(e),B.dispatchEvent(O),B.dispatchEvent($))}function M(e){B.enabled!==!1&&B.enableKeys!==!1&&B.enablePan!==!1&&v(e)}function T(e){if(B.enabled!==!1){switch(e.touches.length){case 1:if(B.enableRotate===!1)return;f(e),z=R.TOUCH_ROTATE;break;case 2:if(B.enableZoom===!1)return;b(e),z=R.TOUCH_DOLLY;break;case 3:if(B.enablePan===!1)return;y(e),z=R.TOUCH_PAN;break;default:z=R.NONE}z!==R.NONE&&B.dispatchEvent(O)}}function P(e){if(B.enabled!==!1)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:if(B.enableRotate===!1)return;if(z!==R.TOUCH_ROTATE)return;w(e);break;case 2:if(B.enableZoom===!1)return;if(z!==R.TOUCH_DOLLY)return;x(e);break;case 3:if(B.enablePan===!1)return;if(z!==R.TOUCH_PAN)return;A(e);break;default:z=R.NONE}}function D(e){B.enabled!==!1&&(S(e),B.dispatchEvent($),z=R.NONE)}function F(e){e.preventDefault()}this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.target=new THREE.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-(1/0),this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return I.phi},this.getAzimuthalAngle=function(){return I.theta},this.reset=function(){B.target.copy(B.target0),B.object.position.copy(B.position0),B.object.zoom=B.zoom0,B.object.updateProjectionMatrix(),B.dispatchEvent(L),B.update(),z=R.NONE},this.update=function(){var t=new THREE.Vector3,a=(new THREE.Quaternion).setFromUnitVectors(e.up,new THREE.Vector3(0,1,0)),r=a.clone().inverse(),s=new THREE.Vector3,i=new THREE.Quaternion;return function(){var e=B.object.position;return t.copy(e).sub(B.target),t.applyQuaternion(a),I.setFromVector3(t),B.autoRotate&&z===R.NONE&&o(n()),I.theta+=j.theta,I.phi+=j.phi,I.theta=Math.max(B.minAzimuthAngle,Math.min(B.maxAzimuthAngle,I.theta)),I.phi=Math.max(B.minPolarAngle,Math.min(B.maxPolarAngle,I.phi)),I.makeSafe(),I.radius*=U,I.radius=Math.max(B.minDistance,Math.min(B.maxDistance,I.radius)),B.target.add(N),t.setFromSpherical(I),t.applyQuaternion(r),e.copy(B.target).add(t),B.object.lookAt(B.target),B.enableDamping===!0?(j.theta*=1-B.dampingFactor,j.phi*=1-B.dampingFactor):j.set(0,0,0),U=1,N.set(0,0,0),G||s.distanceToSquared(B.object.position)>H||8*(1-i.dot(B.object.quaternion))>H?(B.dispatchEvent(L),s.copy(B.object.position),i.copy(B.object.quaternion),G=!1,!0):!1}}(),this.dispose=function(){B.domElement.removeEventListener("contextmenu",F,!1),B.domElement.removeEventListener("mousedown",k,!1),B.domElement.removeEventListener("wheel",E,!1),B.domElement.removeEventListener("touchstart",T,!1),B.domElement.removeEventListener("touchend",D,!1),B.domElement.removeEventListener("touchmove",P,!1),document.removeEventListener("mousemove",C,!1),document.removeEventListener("mouseup",_,!1),window.removeEventListener("keydown",M,!1)};var B=this,L={type:"change"},O={type:"start"},$={type:"end"},R={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},z=R.NONE,H=1e-6,I=new THREE.Spherical,j=new THREE.Spherical,U=1,N=new THREE.Vector3,G=!1,q=new THREE.Vector2,W=new THREE.Vector2,V=new THREE.Vector2,Q=new THREE.Vector2,Z=new THREE.Vector2,Y=new THREE.Vector2,K=new THREE.Vector2,X=new THREE.Vector2,J=new THREE.Vector2,ee=function(){var e=new THREE.Vector3;return function(t,n){e.setFromMatrixColumn(n,0),e.multiplyScalar(-t),N.add(e)}}(),te=function(){var e=new THREE.Vector3;return function(t,n){e.setFromMatrixColumn(n,1),e.multiplyScalar(t),N.add(e)}}(),ne=function(){var e=new THREE.Vector3;return function(t,n){var a=B.domElement===document?B.domElement.body:B.domElement;if(B.object instanceof THREE.PerspectiveCamera){var o=B.object.position;e.copy(o).sub(B.target);var r=e.length();r*=Math.tan(B.object.fov/2*Math.PI/180),ee(2*t*r/a.clientHeight,B.object.matrix),te(2*n*r/a.clientHeight,B.object.matrix)}else B.object instanceof THREE.OrthographicCamera?(ee(t*(B.object.right-B.object.left)/B.object.zoom/a.clientWidth,B.object.matrix),te(n*(B.object.top-B.object.bottom)/B.object.zoom/a.clientHeight,B.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),B.enablePan=!1)}}();B.domElement.addEventListener("contextmenu",F,!1),B.domElement.addEventListener("mousedown",k,!1),B.domElement.addEventListener("wheel",E,!1),B.domElement.addEventListener("touchstart",T,!1),B.domElement.addEventListener("touchend",D,!1),B.domElement.addEventListener("touchmove",P,!1),window.addEventListener("keydown",M,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls,Object.defineProperties(THREE.OrbitControls.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(e){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!e}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(e){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!e}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(e){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!e}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(e){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!e}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(e){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!e}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(e){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=e}}}),function(){"use strict";function e(e){e.debugEnabled(!1)}e.$inject=["$logProvider"],angular.module("oncoscape").config(e)}(),angular.module("oncoscape").run(["$templateCache",function(e){e.put("app/components/barchart/barchart.html",'<os-tray content="tray-content-block" change="vm.resize($event)"><section class="tray-content"><div class="row"><div class="col-xs-12 form-item"><br><label></label></div></div></section></os-tray><section class="tray-content-block"><div style="position:absolute;top:10px;text-align:center;width:100%;"><h2 class="h2-tool">Heatmap</h2><span class="h3-tool">{{vm.datasource.source}} {{vm.datasource.name}}</span><div id="barchart-chart"></div></div></section>'),e.put("app/components/cohortmenu/cohortmenu.html",'<div ng-show="vm.show" id="cohortMenu" style="display:none;"><label class="tray-label tray-label-left"><i class="fa fa-chevron-right" aria-hidden="true"></i></label><div class="cohort-menu tray tray-left"><section><div class="row"><div class="col-xs-12 form-item"><ul class="nav nav-tabs"><li id="cohort-tab-patients" role="presentation" style="width:50%;text-align:center;" ng-click="vm.showPatientHistory()" class="active"><a>Cohorts</a></li></ul><div style="background-color:#ffffff;border:#dddddd 1px solid;border-top-width:0px;padding:10px;"><br><div id="cohortmenu-chart" style="width:100%;height:150px;"><div id="cohortmenu-single-value" class="cohortmenu-single-value"></div></div><div class="dropdown" style="width:100%"><button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown" style="width:100%;">{{vm.cohortFeature.label}} <span class="caret"></span></button><ul class="dropdown-menu"><li style="padding:0px 5px;" ng-repeat="item in vm.cohortFeatures" ng-click="vm.cohortFeature=item">{{item.label}}</li></ul></div><br><div id="cohortmenu-survival" style="border:0px solid #DDD;width:100%;height:180px;"></div><br><div class="legend-bar ng-binding ng-scope" style="border-color:{{vm.cohort.color}}; position: relative; padding: 2px 10px; line-height: 25px; background-color: rgb(255, 255, 255);"><button class="btn-xs btn btn-default" style="float:right;" ng-click="vm.addCohort()" tooltip="Save Cohort"><i style="color:#0b97d3" class="glyphicon glyphicon-plus"></i></button> <label>Current Selection</label></div><div ng-if="vm.cohorts.length>0 && !vm.edit"><div ng-repeat="cohort in vm.cohorts track by $index" class="legend-bar ng-binding ng-scope" style="border-color:{{cohort.color}}; position: relative; padding: 2px 10px; line-height: 25px; background-color: rgb(255, 255, 255);"><button class="btn-xs btn btn-default" style="float:right;" ng-click="vm.editCohort(cohort)"><i style="color:#0b97d3" class="glyphicon glyphicon-edit"></i></button> <a class="markers-command hvr-sweep-to-right" style="margin-right:25px;" ng-click="vm.setCohort(cohort)">{{cohort.name}}</a></div></div><br><div ng-if="vm.edit"><hr><div class="legend-bar ng-binding ng-scope" style="border-color:{{vm.editItem.color}}; position: relative; padding: 2px 10px; line-height: 25px; background-color: rgb(255, 255, 255);"><label>Edit Cohort</label></div><div class="row"><div class="col-xs-12 form-group" style="margin-top:10px;"><input type="text" class="form-control" ng-model="vm.editItem.name"></div><div class="col-xs-12 form-group" style="text-align:right"><button class="btn btn-sm btn-default" style="width:80px" ng-click="vm.removeCohort(vm.editItem);vm.edit=false;">Remove</button> <button class="btn btn-sm btn-primary" style="width:80px" ng-click="vm.edit=false">Done</button></div></div></div></div></div></div><div id="cohortmenu-legand"></div><i id="cohortmenu-lock" class="fa fa-lock tray-sticky-icon" ng-click="vm.toggle()" locked="true"></i></section></div></div>'),e.put("app/components/colorpanel/colorpanel.html",'<div class="panel panel-default mdi" style="padding-bottom:30px;"><div class="panel-heading"><h3 class="panel-title">Patient Color Options</h3><span class="pull-right clickable" data-effect="fadeOut" ng-click="vm.close()" role="button" tabindex="0"><i class="fa fa-times"></i></span></div><div class="panel-body"><div class="row" ng-if="vm.colorOptions.length>0"><div class="col-xs-12 col-sm-9"><h3>Enter Hugo Gene(s) Seperated By + And - Operators. (eg BRCA1 + BRCA2 - p53)</h3><div class="input-group"><div class="input-group-btn"><button style="width:150px;" type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">{{vm.colorOption.name}}&nbsp;<span class="caret"></span></button><ul class="dropdown-menu"><li ng-click="vm.colorOption=item;" ng-repeat="item in vm.colorOptions">{{item.name}}</li></ul></div><div class="input-group-btn"><button style="width:100px;" type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">{{vm.colorScale.name}}&nbsp;<span class="caret"></span></button><ul class="dropdown-menu"><li ng-click="vm.colorScale=item;" ng-repeat="item in vm.colorScales">{{item.name}}</li></ul></div><div class="input-group-btn"><button style="width:100px;border-radius:0px;" type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">{{vm.colorBin.name}}&nbsp;<span class="caret"></span></button><ul class="dropdown-menu"><li ng-click="vm.colorBin=item;" ng-repeat="item in vm.colorBins">{{item.name}}</li></ul></div><input ng-model="vm.geneColor" type="text" class="form-control" placeholder="Hugo Gene Symbol" style="border-right-width: 0px; border-left-width: 0px; height:33px;"> <span class="input-group-btn"><button class="btn btn-default" type="button" ng-click="vm.setGeneColor()">Submit</button></span></div></div></div><div class="row"><h3 class="col-sm-3" ng-repeat="item in vm.optPatientColors">{{item.name}}<br><div ng-repeat="color in item.values"><a href="" style="font-size:12px;" class="hvr-sweep-to-right markers-command" ng-click="vm.setColor(color)">{{color.name}}</a></div></h3></div></div><div style="position:absolute;bottom:0px;width:100%;padding:10px;font-size:10px;text-align:center;">Percentages Indicate Data Availibility</div></div>'),
e.put("app/components/compareclusters/compareclusters.html",'<os-tray caption="Patients" content="tray-content-block"><section class="tray-content"><div class="row"><br><br><div ng-if="vm.legendCaption.length>0" class="col-xs-12 form-item"><label>Patient {{vm.legendCaption}}</label><div ng-repeat="item in vm.legendNodes" class="legend-bar" style="border-color:{{item.color}};position:relative;background-color:#FFF;padding:2px 10px;line-height:25px;">{{item.name}}</div></div><div class="col-xs-12 form-item"><label>Patient</label> <button class="btn btn-default btn-no-focus" type="button" style="width:100%;font-weight: 300;" ng-click="vm.showPanelColor = true">Color Options</button></div><div class="col-xs-12 form-item"><label>Grid</label> <button class="btn btn-default btn-no-focus" type="button" style="width:100%;font-weight: 300;" ng-click="vm.showPanelColor = true">Layout Options</button></div></div></section></os-tray><section class="tray-content-block"><div style="position:absolute;top:10px;text-align:center;width:100%;"><h2 class="h2-tool">Compare Clusters</h2><span class="h3-tool">{{vm.datasource.source}} {{vm.datasource.name}}</span><br><div id="compareclusterChart" class="pca"></div></div></section>'),e.put("app/components/datasource/datasource.html",'<section class="datasource container-fluid"><div class="row"><div class="col-sm-12 col-md-8"><br><h1>Disease Datasets</h1></div></div><div class="row"><ul><li ng-repeat="dataset in vm.datasets" class="col-xs-12 col-sm-6 col-md-4 col-lg-3" ng-click="vm.explore(\'tools\',dataset)"><div class="datasource-btn"><img class="datasource-img" ng-src="/assets/images/{{dataset.img}}"><p class="datasource-h1">{{dataset.name}}</p><p class="datasource-h2">{{dataset.source}} | 11-17-2016</p></div></li></ul></div></section>'),e.put("app/components/header/header.html",'<div class="header" ng-if="vm.show"><nav class="navbar navbar-inverse navbar-fixed-top"><div class="container-fluid"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button> <a class="navbar-brand" href="#"><img alt="Brand" src="/assets/images/logo.png" style="max-height:50px;"></a></div><div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1"><ul class="nav navbar-nav navbar-right"><li class="dropdown" ng-show="vm.showTools"><a href="" class="dropdown-toggle header-link" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><span class="glyphicon glyphicon-stats"></span>Analysis Tools</a><ul class="dropdown-menu row" style="max-height:80vh;overflow:scroll;"><li ng-repeat="item in vm.tools" style="padding-bottom:10px" class="col-xs-12 col-sm-6 col-lg-4" ng-click="vm.loadTool(item.route)"><div class="datasource-btn" style="color:#000"><img class="datasource-img" ng-src="/assets/images/{{item.img}}" style="border-right: 1px solid #DDD"><p class="datasource-h1">{{item.name}}</p><p class="datasource-h2">{{item.desc}}</p></div></li></ul></li><li class="dropdown" ng-show="vm.showDatasets"><a href="" class="dropdown-toggle header-link" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><span class="glyphicon glyphicon-th"></span>Disease Datasets</a><ul class="dropdown-menu row" style="max-height:80vh;overflow:scroll;"><li ng-repeat="item in vm.datasets" style="padding-bottom:10px" class="col-xs-12 col-sm-6 col-lg-4" ng-click="vm.loadDataset(item.disease)"><div class="datasource-btn" style="color:#000"><img class="datasource-img" ng-src="/assets/images/{{item.img}}"><p class="datasource-h1">{{item.name}}</p><p class="datasource-h2">{{item.source}} | 11-17-2016</p></div></li></ul></li><li class="dropdown" ng-show="vm.showCohorts"><a href="" class="dropdown-toggle header-link" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><span class="fa fa-users"></span>My Cohorts</a><div class="dropdown-menu container-fluid"><div class="row"><div ng-if="!vm.showImport" class="col-xs-12 col-sm-4" style="border:0px solid #DDD; border-right-width:1px;"><h2 style="margin-top:0px;">Create A Cohort</h2>Oncoscape allows you to pass cohorts of patients from one tool to the next. To create a cohort out of your current selection click<br><button class="btn btn-primary" style="margin-top:15px;" ng-click="vm.addPatientCohort(); $event.stopPropagation();">Create Cohort</button> <button class="btn btn-primary" style="margin-top:15px;" ng-click="vm.showImport=true; $event.stopPropagation();">Import Cohort</button></div><div ng-if="vm.showImport" class="col-xs-12 col-sm-4" style="border:0px solid #DDD; border-right-width:1px;"><h2 style="margin-top:0px;">Import A Cohort</h2>Enter a comma seperated list of patient IDs below and click save<br><input ng-model="vm.importPatientIds" type="text" class="form-control" style="margin-top:5px;" placeholder="eg. TCGA-01-0110, TCGA-02-0220"> <button class="btn btn-primary" style="margin-top:15px;" ng-click="vm.importPatientCohort(); $event.stopPropagation();">Save</button> <button class="btn btn-primary" style="margin-top:15px;" ng-click="vm.showImport=false; $event.stopPropagation();">Cancel</button></div><div class="col-xs-12 col-sm-8"><h2 style="margin-top:0px;">Your Cohorts</h2><div class="markers-command hvr-sweep-to-right" style="max-width:200px;" ng-repeat="item in vm.cohorts" ng-click="vm.setPatientCohort(item)">{{item.name}} ({{item.ids.length}})</div></div></div></div></li><li ng-show="vm.showHelp"><a href="http://resources.sttrcancer.org/oncoscape" target="_blank" class="header-link"><span class="glyphicon glyphicon-question-sign"></span>Help</a></li><li ng-show="vm.showLogout"><a href="" ng-click="vm.logoutClick()" class="header-link"><span class="glyphicon glyphicon-user"></span>Logout</a></li></ul></div></div><div class="nav-divider"></div></nav></div>'),e.put("app/components/heatmap/heatmap.html",'<os-tray content="tray-content-block" change="vm.resize($event)"><section class="tray-content"><div class="row"><div class="col-xs-12 form-item"><br><label></label></div><div class="col-xs-12 form-item"><label>Display Options</label><div class="legend-bar" style="border-color:#000;position:relative;background-color:#FFF;padding:2px 10px;line-height:25px;">Row Dendrograms <label class="switch {{item.class}}" style="float:right"><input type="checkbox" class="switch-input" ng-model="vm.rowDendrogram" ng-change="vm.draw()"> <span class="switch-label" data-on="On" data-off="Off"></span> <span class="switch-handle"></span></label></div><div class="legend-bar" style="border-color:#000;position:relative;background-color:#FFF;padding:2px 10px;line-height:25px;">Row Labels <label class="switch {{item.class}}" style="float:right"><input type="checkbox" class="switch-input" ng-model="vm.rowLabels" ng-change="vm.draw()"> <span class="switch-label" data-on="On" data-off="Off"></span> <span class="switch-handle"></span></label></div><div class="legend-bar" style="border-color:#000;position:relative;background-color:#FFF;padding:2px 10px;line-height:25px;">Column Dendrograms <label class="switch {{item.class}}" style="float:right"><input type="checkbox" class="switch-input" ng-model="vm.colDendrogram" ng-change="vm.draw()"> <span class="switch-label" data-on="On" data-off="Off"></span> <span class="switch-handle"></span></label></div><div class="legend-bar" style="border-color:#000;position:relative;background-color:#FFF;padding:2px 10px;line-height:25px;">Column Labels <label class="switch {{item.class}}" style="float:right"><input type="checkbox" class="switch-input" ng-model="vm.colLabels" ng-change="vm.draw()"> <span class="switch-label" data-on="On" data-off="Off"></span> <span class="switch-handle"></span></label></div><div class="legend-bar" style="border-color:#000;position:relative;background-color:#FFF;padding:2px 10px;line-height:25px;">Grid Lines <label class="switch {{item.class}}" style="float:right"><input type="checkbox" class="switch-input" ng-model="vm.gridlines" ng-change="vm.draw()"> <span class="switch-label" data-on="On" data-off="Off"></span> <span class="switch-handle"></span></label></div></div><div class="col-xs-12 form-item"><label>Color Scheme</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.colorScheme.name}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li ng-repeat="item in vm.colorSchemes" ng-click="vm.colorScheme=item;vm.draw()">{{item.name}}</li></ul></div></div><div class="col-xs-12 form-item"><label>Scale</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.scale.name}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li ng-repeat="item in vm.scales" ng-click="vm.scale=item;vm.loadHeatmap()">{{item.name}}</li></ul></div></div><div class="col-xs-12 form-item"><label>Dendrogram Clusters</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.dendrogramCluster.name}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li ng-repeat="item in vm.dendrogramClusters" ng-click="vm.dendrogramCluster=item;vm.loadHeatmap()">{{item.name}}</li></ul></div></div></div></section></os-tray><section class="tray-content-block"><div style="position:absolute;top:10px;text-align:center;width:100%;"><h2 class="h2-tool">Heatmap</h2><span class="h3-tool">{{vm.datasource.source}} {{vm.datasource.name}}</span><div id="heatmap-chart" style="position:relative"></div><div id="tooltip" class="hidden"><p><span id="value"></span></p></div></div></section>'),e.put("app/components/history/history.html",'<os-tray caption="Patients" content="tray-content-block"><section class="tray-content"><div class="row"><div class="col-xs-12 form-item"><br><br><label>Clinical Collections</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.collection.name}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li ng-repeat="item in vm.collections" ng-click="vm.collection=item">{{item.name}}</li></ul></div></div><div class="col-xs-12 form-item"><label>Export</label> <button class="btn btn-default btn-no-focus" type="button" style="width:100%;font-weight: 300;" ng-click="vm.exportCsv()">CSV</button></div></div></section></os-tray><section class="history-content history-grid-container"><div class="container-fluid" style="text-align:center;"><h2 class="h2-tool">Patient Data</h2><span class="h3-tool">{{vm.datasource.source}} {{vm.datasource.name}}</span><br><br><br><div class="grid" id="history-grid" ui-grid="vm.options" ui-grid-selection="" ui-grid-resize-columns="" ui-grid-move-columns="" ui-grid-pinning="" ui-grid-grouping="" ui-grid-autoresize=""></div></div></section><os-color-panel ng-if="vm.showPanelColor" close="vm.showPanelColor=false"></os-color-panel>'),e.put("app/components/landing/landing.html",'<div class="landing"><header class="landing container"><div class="row marquee marquee-bg"><div class="col-sm-12"><div class="header-content" style="text-align:center;pointer-events: none;z-index: 999;"><h1 style="font-weight:200;text-transform:uppercase;letter-spacing:30px;font-size:100px;padding-top:25vh">Oncoscape</h1><p style="font-weight:400;text-transform:uppercase;letter-spacing:20px;font-size:25px;">Cancer Genomics</p></div></div></div><span style="position:absolute;display:inline-block;top:70vh;margin:0 auto;left:50%;margin-left:-200px;"><a class="btn btn-outline btn-xl page-scroll" ng-click="vm.getStarted()">Explore</a> <a class="btn btn-outline btn-xl page-scroll" href="http://resources.sttrcancer.org/oncoscape">Learn More</a></span></header><div class="container-fluid" style="background-color:#000; color:#FFF;padding-top:150px;padding-bottom:150px;"><div class="row"><div class="col-sm-7"><h1 style="font-size:50px;pointer-events:none;">Our Mission</h1><p style="font-size:30px;line-height:50px;">Empower researchers to discover novel patterns and relationships between clinical and molecular factors.</p><a class="btn btn-outline btn-xl page-scroll" href="http://cancergenome.nih.gov/publications/publicationguidelines">Publishing Guidelines</a></div><div class="col-sm-5" style="text-align:center"><img src="assets/images/thumb.png" class="img-responsive" alt="" style="display:inline-block;height:100%;"></div></div></div><div class="container-fluid" style="padding-top:150px;padding-bottom:300px;background:#EEE;;"><div class="row" style="font-size:18px;"><div class="col-sm-12"><h1 style="font-size:50px;">Affiliations</h1><br></div><div class="col-sm-3"><a href="http://www.fredhutch.org"><img src="/assets/images/logo-hutch.jpg"></a></div><div class="col-sm-3"><a href="http://www.washington.edu/"><img src="/assets/images/logo-uw.jpg"></a></div><div class="col-sm-3"><a href="https://www.seattlecca.org/"><img src="/assets/images/logo-scca.jpg"></a></div><div class="col-sm-3"><img src="/assets/images/logo-sarc.jpg"></div></div></div></div>'),e.put("app/components/loader/loader.html",'<div class="loader-modal"><div class="loader"><div class="loader__bar"></div><div class="loader__bar"></div><div class="loader__bar"></div><div class="loader__bar"></div><div class="loader__bar"></div><div class="loader__ball"></div></div></div>'),e.put("app/components/login/login.html",'<form class="login"><div class="login-body"><h3 class="login-header">Sign in</h3><div ng-repeat="item in vm.networks" class="login-option" ng-click="vm.login(item);"><span class="{{item.icon}} login-icon"></span> {{item.name}}</div></div></form>'),e.put("app/components/markers/markers.html",'<os-tray content="tray-content-block" change="vm.resize()"><section class="tray-content"><div class="row"><br><div class="col-xs-12 form-item"><label>Edge Visibility</label><div ng-repeat="item in vm.optEdgeColors" class="legend-bar" style="border-color:{{item.color}};position:relative;background-color:#FFF;padding:2px 10px;line-height:25px;">{{item.name}} {{item.count}} <label class="switch" style="float:right"><input type="checkbox" class="switch-input" ng-model="item.show" ng-change="vm.edgeToggle(item)"> <span class="switch-label" data-on="On" data-off="Off"></span> <span class="switch-handle"></span></label></div></div><div ng-if="vm.legendNodes.length>0" class="col-xs-12 form-item"><label>Patient {{vm.legendCaption}}</label><div ng-repeat="item in vm.legendNodes" class="legend-bar legend-bar-button" style="border-color:{{item.color}};">{{item.name}}<span id="{{item.id}}" class="legend-count"></span> <label style="float:right;padding-top:5px;" class="btn-group"><button ng-click="vm.deselectColor(item)" class="btn btn-xs btn-default" style="background-color:#47a8d8;color:#FFF;text-shadow: 0 1px rgba(0, 0, 0, 0.2);width:24px;margin-right:1px;"><i class="fa fa-circle-o"></i></button> <button ng-click="vm.selectColor(item)" class="btn btn-xs btn-default" style="background-color:#47a8d8;color:#FFF;text-shadow: 0 1px rgba(0, 0, 0, 0.2);width:24px;margin-left:1px;"><i class="fa fa-dot-circle-o"></i></button></label></div></div><div class="col-xs-12 form-item"><label>Patient Options</label><div class="btn-group" role="group" style="display: block"><button class="btn btn-default btn-no-focus" type="button" style="width:50%; font-weight: 300;" title="Zoom Reset" ng-click="vm.showPanelLayout = true">Layouts</button> <button class="btn btn-default btn-no-focus" type="button" style="width:50%; font-weight: 300;" title="Zoom Selection" ng-click="vm.showPanelColor = true">Colors</button></div></div><div class="col-xs-12 form-item"><label>Gene Set</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" style="padding-right:30px;">{{vm.optGeneSet.name}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1" style="width:100%"><li ng-repeat="item in vm.optGeneSets" ng-click="vm.optGeneSet=item">{{item.name}}</li></ul></div></div><div class="col-xs-6 form-item" style="padding-right:5px"><label>Command Mode</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" style="padding-right:30px;">{{vm.optCommandMode.name}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1" style="width:100%"><li ng-repeat="item in vm.optCommandModes" ng-click="vm.optCommandMode=item">{{item.name}}</li></ul></div></div><div class="col-xs-6 form-item" style="padding-left:5px"><label>Search</label> <input type="text" class="form-control" ng-model="vm.search" placeholder="Gene or Patient"></div><div class="col-xs-12 form-item" ng-if="vm.optCommandMode.name==\'Sequential\'"><label>Commands</label><br><a ng-click="vm.cmd(\'ShowSelectedEdges\')" class="markers-command hvr-sweep-to-right">Show Edges of Selected</a> <a ng-click="vm.cmd(\'HideSelectedEdges\')" class="markers-command hvr-sweep-to-right">Hide Edges of Selected</a> <a ng-click="vm.cmd(\'HideUnselectedEdges\')" class="markers-command hvr-sweep-to-right">Hide Edges of Unselected</a> <a ng-click="vm.cmd(\'HideAllEdges\')" class="markers-command hvr-sweep-to-right">Hide All Edges</a> <a ng-click="vm.cmd(\'SelectInverse\')" class="markers-command hvr-sweep-to-right">Invert Node Selection</a> <a ng-click="vm.cmd(\'SelectConnected\')" class="markers-command hvr-sweep-to-right">Select Connected Nodes</a> <a ng-click="vm.cmd(\'HideUnselectedNodes\')" class="markers-command hvr-sweep-to-right">Hide Unselected Nodes</a> <a ng-click="vm.cmd(\'ShowAllNodes\')" class="markers-command hvr-sweep-to-right">Show All Nodes</a></div><div class="col-xs-12 form-item"><label>Lock Selections</label><div class="btn-group" role="group" style="display: block"><button class="btn btn-default btn-no-focus" type="button" ng-click="vm.lock(\'patient\')" style="width:50%; font-weight: 300;" title="Patient Selection Lock"><i class="fa fa-unlock" ng-show="!vm.lockPatients"></i> <i class="fa fa-lock" ng-show="vm.lockPatients"></i> Patients</button> <button class="btn btn-default btn-no-focus" type="button" ng-click="vm.lock(\'gene\')" style="width:50%; font-weight: 300;" title="Gene Selection Lock"><i class="fa fa-unlock" ng-show="!vm.lockGenes"></i> <i class="fa fa-lock" ng-show="vm.lockGenes"></i> Genes</button></div></div><div class="col-xs-12 form-item"><label>Zoom</label><div class="btn-group" role="group" style="display: block"><button class="btn btn-default btn-no-focus" type="button" ng-click="vm.zoom.reset()" style="width:50%; font-weight: 300;" title="Zoom Reset">Reset</button> <button class="btn btn-default btn-no-focus" type="button" ng-click="vm.zoom.fit()" style="width:50%; font-weight: 300;" title="Zoom Selection">Selected</button></div></div></div></section></os-tray><section class="tray-content-block"><div id="markers-chart" class="markers-chart"></div><div style="position:absolute;top:10px;text-align:center;width:100%;"><h2 class="h2-tool">Markers + Patients</h2><span class="h3-tool">{{vm.datasource.source}} {{vm.datasource.name}}</span> <span class="h3-tool">(Layout: {{vm.optPatientLayout.name}})</span></div></section><div id="modalEdge" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-body"><h2 style="margin-top:0px;">Your request would add {{vm.edgeCounts.total}} edges to the graph.</h2><p>To improve performance + readability you may want to disable some of the edges.</p><div class="input-group" ng-repeat="item in vm.optEdgeColors | filter:{show:true}"><label class="switch {{item.class}}"><input type="checkbox" class="switch-input" ng-model="item.show"> <span class="switch-label" data-on="On" data-off="Off"></span> <span class="switch-handle"></span></label> <span style="padding-left:20px;">{{item.name}} ({{vm.edgeCounts[item.abv]}})</span></div></div><div style="position:absolute;right:10px;bottom:10px;"><button class="btn btn-default" ng-click="vm.hideModal()">Cancel</button> <button class="btn btn-primary" ng-click="vm.filterModelEdge()">Continue</button></div></div></div></div><os-color-panel ng-if="vm.showPanelColor" close="vm.showPanelColor=false"></os-color-panel><div class="panel panel-default mdi" ng-if="vm.showPanelLayout"><div class="panel-heading"><h3 class="panel-title">Patient Layout</h3><span class="pull-right clickable" data-effect="fadeOut" ng-click="vm.showPanelLayout=false"><i class="fa fa-times"></i></span></div><div class="panel-body"><div class="row"><div class="col-sm-12"><h3>Select a layout</h3></div><a class="col-sm-4 markers-command hvr-sweep-to-right" style="padding-left:15px; padding-right:15px;" ng-repeat="item in vm.optPatientLayouts" ng-click="vm.optPatientLayout=item;vm.showPanelLayout=false;">{{item.name}}</a></div></div></div>'),e.put("app/components/pathways/pathways.html",'<os-tray content="tray-content-block" change="vm.resize($event)"><section class="tray-content"><div class="row"><br><br><div class="col-xs-12 form-item"><label>Search</label> <input type="text" class="form-control" ng-model="vm.search"></div><div class="col-xs-12 form-label"><h2>Legend</h2><span class="legend-bar" style="border-color: green">Activation</span> <span class="legend-bar" style="border-color: red">Inhibition</span> <span class="legend-bar" style="border-color: #38347B">Modification</span> <span class="legend-bar" style="border-color: #056ce1">Genes</span></div></div></section></os-tray><section class="tray-content-block" style="padding-right:0px;"><div id="pathways-chart" class="pathways-chart"></div><div style="position:absolute;top:10px;text-align:center;width:100%;"><h2 class="h2-tool">Pathways</h2><span class="h3-tool">{{vm.datasource.source}} {{vm.datasource.name}}</span></div></section><div class="modal fade pathways" id="gbm-webpage" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="myModalLabel">{{vm.tip}}</h4></div><iframe class="modal-iframe" ng-src="{{vm.frame}}"></iframe></div></div></div>'),e.put("app/components/pca/pca.html",'<os-tray content="tray-content-block"><section class="tray-content"><div class="row"><br><br><div class="col-xs-12 form-item"><label>Gene Set</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.geneSet.name}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li ng-repeat="item in vm.geneSets" ng-click="vm.geneSet=item">{{item.name}}</li></ul></div></div><div class="col-xs-12 form-item"><label>Data Source</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.source.name}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li ng-repeat="item in vm.sources" ng-click="vm.source=item">{{item.name}}</li></ul></div></div><div class="col-xs-12 form-item"><label>PCA Type</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.pcaType.name}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li ng-repeat="item in vm.pcaTypes" ng-click="vm.pcaType=item">{{item.name}}</li></ul></div></div><div ng-if="vm.legendCaption.length>0" class="col-xs-12 form-item"><label>Patient {{vm.legendCaption}}</label><div ng-repeat="item in vm.legendNodes" class="legend-bar legend-bar-button" style="border-color:{{item.color}};">{{item.name}}<span id="{{item.id}}" class="legend-count"></span> <label style="float:right;padding-top:5px;" class="btn-group"><button ng-click="vm.deselectColor(item)" class="btn btn-xs btn-default" style="background-color:#47a8d8;color:#FFF;text-shadow: 0 1px rgba(0, 0, 0, 0.2);width:24px;margin-right:1px;"><i class="fa fa-circle-o"></i></button> <button ng-click="vm.selectColor(item)" class="btn btn-xs btn-default" style="background-color:#47a8d8;color:#FFF;text-shadow: 0 1px rgba(0, 0, 0, 0.2);width:24px;margin-left:1px;"><i class="fa fa-dot-circle-o"></i></button></label></div></div><div class="col-xs-12 form-item"><label>Patient</label> <button class="btn btn-default btn-no-focus" type="button" style="width:100%;font-weight: 300;" ng-click="vm.showPanelColor = true">Color Options</button></div><div class="col-xs-12 form-label"><h3>Variance Explained</h3>PC1: {{vm.pc1}}%<br>PC2: {{vm.pc2}}%</div></div></section></os-tray><section class="tray-content-block"><div style="position:absolute;top:10px;text-align:center;width:100%;"><h2 class="h2-tool">Principal Component Analysis</h2><span class="h3-tool">{{vm.datasource.source}} {{vm.datasource.name}}</span><div id="pca-chart" class="pca"></div></div></section><os-color-panel ng-if="vm.showPanelColor" close="vm.showPanelColor=false"></os-color-panel>'),e.put("app/components/plsr/plsr.html",'<os-tool-menu datasource="{{vm.datasource}}" change="vm.addCohortGene()"></os-tool-menu><os-tray content="tray-content-block" change="vm.resize($event)"><section class="tray-content"><div class="row"><div class="col-xs-12 form-label"><h2>Filters</h2></div><div class="col-xs-12 form-item"><label>Gene Set</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.geneSet}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li ng-repeat="item in vm.geneSets" ng-click="vm.geneSet=item">{{item}}</li></ul></div></div><div class="col-xs-12 form-item"><label>Age At Diagnosis</label><div range-slider="" min="vm.deathMinValue" model-min="vm.deathMinFilter" max="vm.deathMaxValue" model-max="vm.deathMaxFilter" prevent-equal-min-max="true" show-values="true" attach-handle-values="true" on-handle-up="vm.update()"></div></div><div class="col-xs-12 form-item"><label>Survival</label><div range-slider="" min="vm.survivalMinValue" model-min="vm.survivalMinFilter" max="vm.survivalMaxValue" model-max="vm.survivalMaxFilter" prevent-equal-min-max="" show-values="true" attach-handle-values="true" on-handle-up="vm.update()"></div></div><div class="col-xs-12 form-label"><h2>Legend</h2><span class="legend-bar" style="border-color: #1396de">Age At Diagnosis</span> <span class="legend-bar" style="border-color: #38347b">Survial</span> <span class="legend"><span class="legend-dot" style="background-color:#000"></span>Genes</span></div></div></section></os-tray><section class="tray-content-block"><div class="container-fluid"><h2 class="h2-tool">Partial Least Squares Regression</h2><h3 class="h3-datasource">{{vm.datasource}}</h3><div id="plsr-chart" class="plsr"></div></div></section><div class="modal fade plsr-webpage" id="plsr-webpage" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="myModalLabel">{{vm.tip}}</h4></div><iframe class="modal-iframe" ng-src="{{vm.frame}}"></iframe></div></div></div>'),e.put("app/components/scatter/scatter.html",'<script type="x-shader/x-vertex" id="vertexshader">attribute float size; attribute vec3 customColor; varying vec3 vColor; void main() { vColor = customColor; vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 ); gl_PointSize = size * ( 300.0 / -mvPosition.z ); gl_Position = projectionMatrix * mvPosition; }</script><script type="x-shader/x-fragment" id="fragmentshader">uniform vec3 color; uniform sampler2D texture; varying vec3 vColor; void main() { gl_FragColor = vec4( color * vColor, 1.0 ); gl_FragColor = gl_FragColor * texture2D( texture, gl_PointCoord ); if ( gl_FragColor.a < ALPHATEST ) discard; }</script><os-tray content="tray-content-block"><section class="tray-content"><div class="row"><br><br><div class="col-xs-12 form-item"><label>Gene Set</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.geneSet.name}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li ng-repeat="item in vm.geneSets" ng-click="vm.geneSet=item">{{item.name}}</li></ul></div></div><div class="col-xs-12 form-item"><label>Data Source</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.source.name}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li ng-repeat="item in vm.sources" ng-click="vm.source=item">{{item.name}}</li></ul></div></div><div class="col-xs-12 form-item"><label>PCA Type</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.pcaType.name}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li ng-repeat="item in vm.pcaTypes" ng-click="vm.pcaType=item">{{item.name}}</li></ul></div></div><div ng-if="vm.legendCaption.length>0" class="col-xs-12 form-item"><label>Patient {{vm.legendCaption}}</label><div ng-repeat="item in vm.legendNodes" class="legend-bar legend-bar-button" style="border-color:{{item.color}};">{{item.name}}<span id="{{item.id}}" class="legend-count"></span> <label style="float:right;padding-top:5px;" class="btn-group"><button ng-click="vm.deselectColor(item)" class="btn btn-xs btn-default" style="background-color:#47a8d8;color:#FFF;text-shadow: 0 1px rgba(0, 0, 0, 0.2);width:24px;margin-right:1px;"><i class="fa fa-circle-o"></i></button> <button ng-click="vm.selectColor(item)" class="btn btn-xs btn-default" style="background-color:#47a8d8;color:#FFF;text-shadow: 0 1px rgba(0, 0, 0, 0.2);width:24px;margin-left:1px;"><i class="fa fa-dot-circle-o"></i></button></label></div></div><div class="col-xs-12 form-item"><label>Patient</label> <button class="btn btn-default btn-no-focus" type="button" style="width:100%;font-weight: 300;" ng-click="vm.showPanelColor = true">Color Options</button></div><div class="col-xs-12 form-label"><h3>Variance</h3>PC1: {{vm.pc1}}%<br>PC2: {{vm.pc2}}%<br>PC3: {{vm.pc3}}%</div></div></section></os-tray><section class="tray-content-block"><div style="position:absolute;top:10px;text-align:center;width:100%;"><h2 class="h2-tool">Principal Component Analysis</h2><span class="h3-tool">{{vm.datasource.source}} {{vm.datasource.name}}</span><div id="scatter-chart"></div></div></section><os-color-panel ng-if="vm.showPanelColor" close="vm.showPanelColor=false"></os-color-panel>'),
e.put("app/components/sunburst/sunburst.html",'<os-tray content="tray-content-block" change="vm.resize($event)"><section class="tray-content"><div class="row"><br><br><div class="col-xs-12 form-item"><label>Patient</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.patient.patient_ID}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li ng-repeat="item in vm.patients">{{item.patient_ID}}</li></ul></div></div><div class="col-xs-12 form-item" ng-repeat="chart in vm.charts"><label>{{chart.name}}</label><div ng-repeat="group in chart.groups" class="legend-bar" style="border-color:#FFF;position:relative;background-color:#FFF;padding:2px 10px;line-height:25px;"><label class="switch" style="float:right"><input type="checkbox" class="switch-input" ng-model="group.show" ng-change="vm.draw()"> <span class="switch-label" data-on="On" data-off="Off"></span> <span class="switch-handle"></span></label> {{group.name}}<div ng-repeat="tag in group.tags" class="legend-bar" style="border-color:{{tag.color}}; position: relative; padding: 2px 10px; line-height: 25px; background-color: rgb(255, 255, 255);">{{tag.name}}</div></div></div></div></section></os-tray><section class="tray-content-block"><div style="position:absolute;top:10px;text-align:center;width:100%;"><h2 class="h2-tool">Sunburst</h2><span class="h3-tool">{{vm.datasource.source}} {{vm.datasource.name}}</span><div id="sunburst-chart"></div></div></section>'),e.put("app/components/survival/survival.html",'<os-tray content="tray-content-block" change="vm.resize($event)"><section class="tray-content"><div class="row"><div class="col-xs-12 form-item"><br><label>Cohorts</label><div class="legend-bar" style="border-color:{{vm.cohort.color}};position:relative;background-color:#FFF;padding:2px 10px;line-height:25px;">Current Selection</div><div ng-repeat="cohort in vm.cohorts track by $index" class="legend-bar" style="border-color:{{cohort.color}};position:relative;background-color:#FFF;padding:2px 10px;line-height:25px;">{{cohort.name}} <label class="switch {{item.class}}" style="float:right"><input type="checkbox" class="switch-input" ng-model="cohort.show" ng-change="vm.toggle()"> <span class="switch-label" data-on="On" data-off="Off"></span> <span class="switch-handle"></span></label></div></div></div></section></os-tray><section class="tray-content-block survival"><div style="position:absolute;top:10px;text-align:center;width:100%;"><h2 class="h2-tool">Survival Curves</h2><span class="h3-tool">{{vm.datasource.source}} {{vm.datasource.name}}</span><div id="survival-chart"></div></div></section>'),e.put("app/components/timelines/timelines.html",'<os-tray content="tray-content-block" change="vm.resize($event)"><section class="tray-content"><div class="row"><br><div class="col-xs-6 form-item" style="padding-right:5px"><label>Align By</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.align.name}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1" style="width:100%"><li ng-repeat="item in vm.events" ng-click="vm.align=item; vm.update();">{{item.name}}</li></ul></div></div><div class="col-xs-6 form-item" style="padding-left:5px"><label>Order By</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.sort.name}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1" style="width:100%"><li ng-repeat="item in vm.events" ng-click="vm.sort=item; vm.update();">{{item.name}}</li></ul></div></div><div class="col-xs-6 form-item" style="padding-right:5px"><label>Patient Status</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.filter.name}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1" style="width:100%"><li ng-repeat="item in vm.filters" ng-click="vm.filter=item;vm.update();">{{item.name}}</li></ul></div></div><div class="col-xs-6 form-item" style="padding-left:5px"><label>Timescale</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.timescale.name}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1" style="width:100%"><li ng-repeat="item in vm.timescales" ng-click="vm.timescale=item;vm.update();">{{item.name}}</li></ul></div></div><div class="col-xs-12 form-item"><label>Display Filter</label><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{vm.displayMode.name}} <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="dropdownMenu1" style="width:100%"><li ng-repeat="item in vm.displayModes" ng-click="vm.displayMode=item;vm.update();">{{item.name}}</li></ul></div></div><div class="col-xs-12 form-item"><div class="dropdown bs-dropdown"><button class="btn btn-default dropdown-toggle" type="button" ng-click="vm.resetZoom()" style="text-align:center;">Clear Selection + Reset Zoom</button></div></div><div class="col-xs-12 form-item"><label>Events</label><div ng-repeat="item in vm.events track by $index" class="legend-bar" style="border-color:{{item.color}};position:relative;background-color:#FFF;padding:2px 10px;line-height:25px;">{{item.name}} <label class="switch {{item.class}}" style="float:right"><input type="checkbox" class="switch-input" ng-model="item.selected" ng-change="vm.update();"> <span class="switch-label" data-on="On" data-off="Off"></span> <span class="switch-handle"></span></label></div></div><div class="col-xs-12 form-item"><div id="timelines-tip" style="min-height:200px;"><b>Rollover Event For Details</b></div></div></div></section></os-tray><section class="tray-content-block"><div style="position:absolute;top:10px;text-align:center;width:100%;"><h2 class="h2-tool">Timelines</h2><span class="h3-tool">{{vm.datasource.source}} {{vm.datasource.name}}</span><div class="timelines-content" style="margin-top:20px;"></div></div></section><os-color-panel ng-if="vm.showPanelColor" close="vm.showPanelColor=false"></os-color-panel>'),e.put("app/components/tools/tools.html",'<section class="datasource container-fluid"><div class="row"><div class="col-sm-12 col-md-8"><br><h1>Analysis Tools</h1></div></div><div class="row"><ul><li ng-repeat="tool in vm.tools" class="col-xs-12 col-sm-6 col-md-4" ng-click="vm.explore(tool.route)"><div class="datasource-btn"><img class="datasource-img" ng-src="/assets/images/{{tool.img}}" style="border-right:1px solid #DDD;"><p class="datasource-h1" style="padding-top:10px;">{{tool.name}}</p><p class="datasource-h2">{{tool.desc}}</p></div></li></ul></div></section>'),e.put("app/components/tray/tray.html",'<div><label class="tray-label tray-label-right"><i class="fa fa-chevron-left" aria-hidden="true"></i></label><div class="tray {{vm.trayClass}} tray-right" locked="true"><ng-transclude></ng-transclude><i class="fa fa-lock tray-sticky-icon {{vm.iconClass}}" ng-click="vm.toggle()"></i></div></div>')}]);
//# sourceMappingURL=../maps/scripts/app-e2fbd615ef.js.map
